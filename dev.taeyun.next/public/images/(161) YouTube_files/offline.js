(function(g){var window=this;'use strict';var AY$=function(Q){var U=new g.el("und",new g.dv("Default","und",!0));U.captionTracks=Q.captionTracks;return U},EMQ=function(Q){return new g.gx(function(U,q){var H=Q.length,C=[];
if(H)for(var V=function(R,B){H--;C[R]=B;H==0&&U(C)},f=function(R){q(R)},Y,S=0;S<Q.length;S++)Y=Q[S],g.RLf(Y,g.rd(V,S),f);
else U(C)})},dn=function(Q){this.Z=Q},G8=function(){dn.apply(this,arguments)},bMd=function(){G8.apply(this,arguments)},kLd=function(){G8.apply(this,arguments)},Ipd=function(){G8.apply(this,arguments)},cYA=function(){G8.apply(this,arguments)},p1A=function(){G8.apply(this,arguments)},NTx=function(){G8.apply(this,arguments)},$GN=function(){G8.apply(this,arguments)},t13=function(){dn.apply(this,arguments)},xGz=function(){G8.apply(this,arguments)},jRH=function(){G8.apply(this,arguments)},lp8=function(){G8.apply(this,
arguments)},ap$=function(){G8.apply(this,arguments)},ZMz=function(){G8.apply(this,arguments)},vMA=function(){G8.apply(this,arguments)},QXA=function(){G8.apply(this,arguments)},UfH=function(){G8.apply(this,arguments)},qOA=function(){G8.apply(this,arguments)},Hcx=function(){G8.apply(this,arguments)},CFH=function(){G8.apply(this,arguments)},VW$=function(){G8.apply(this,arguments)},fkJ=function(){dn.apply(this,arguments)},otx=function(){G8.apply(this,arguments)},icd=function(){G8.apply(this,arguments)},
Tzd=function(){G8.apply(this,arguments)},YO$=function(){G8.apply(this,arguments)},SO8=function(){G8.apply(this,arguments)},RLx=function(){G8.apply(this,arguments)},Bzz=function(){G8.apply(this,arguments)},zLH=function(){G8.apply(this,arguments)},L7z=function(){G8.apply(this,arguments)},mfA=function(){dn.apply(this,arguments)},PF7=function(){dn.apply(this,arguments)},wu$=function(){dn.apply(this,arguments)},sXJ=function(){G8.apply(this,arguments)},K7A=function(){G8.apply(this,arguments)},hLH=function(){G8.apply(this,
arguments)},W73=function(){G8.apply(this,arguments)},Xuz=function(){G8.apply(this,arguments)},yhz=function(){G8.apply(this,arguments)},nt8=function(){G8.apply(this,arguments)},MWJ=function(){G8.apply(this,arguments)},DfA=function(){G8.apply(this,arguments)},Jhd=function(){G8.apply(this,arguments)},gtz=function(){G8.apply(this,arguments)},Oct=function(){G8.apply(this,arguments)},F7A=function(){G8.apply(this,arguments)},eL7=function(){G8.apply(this,arguments)},df8=function(){G8.apply(this,arguments)},
G2N=function(){G8.apply(this,arguments)},uWd=function(){G8.apply(this,arguments)},rhQ=function(){G8.apply(this,arguments)},Ahz=function(){G8.apply(this,arguments)},Etz=function(){G8.apply(this,arguments)},bcA=function(){G8.apply(this,arguments)},k2J=function(){G8.apply(this,arguments)},Ik8=function(){G8.apply(this,arguments)},chz=function(){G8.apply(this,arguments)},puz=function(){G8.apply(this,arguments)},Nzd=function(){G8.apply(this,arguments)},$fz=function(){G8.apply(this,arguments)},tWJ=function(){G8.apply(this,
arguments)},xfA=function(){G8.apply(this,arguments)},jXd=function(){dn.apply(this,arguments)},lk8=function(){G8.apply(this,arguments)},akd=function(){G8.apply(this,arguments)},Zcd=function(){G8.apply(this,arguments)},vtd=function(){G8.apply(this,arguments)},QmQ=function(){G8.apply(this,arguments)},UK$=function(){G8.apply(this,arguments)},qgJ=function(){G8.apply(this,arguments)},HTH=function(){G8.apply(this,arguments)},CGt=function(){G8.apply(this,arguments)},V8A=function(){G8.apply(this,arguments)},
fMN=function(){G8.apply(this,arguments)},oNA=function(){G8.apply(this,arguments)},iT$=function(){G8.apply(this,arguments)},T5z=function(){G8.apply(this,arguments)},Ygz=function(){G8.apply(this,arguments)},Sg8=function(){G8.apply(this,arguments)},RON=function(){G8.apply(this,arguments)},B5A=function(){G8.apply(this,arguments)},zOJ=function(){G8.apply(this,arguments)},Lhx=function(){G8.apply(this,arguments)},mKQ=function(){G8.apply(this,arguments)},PG$=function(){G8.apply(this,arguments)},wsz=function(){G8.apply(this,
arguments)},sm$=function(){G8.apply(this,arguments)},Kh8=function(){G8.apply(this,arguments)},hOx=function(){G8.apply(this,arguments)},WhH=function(){G8.apply(this,arguments)},XsA=function(){G8.apply(this,arguments)},yPz=function(){G8.apply(this,arguments)},nN8=function(){G8.apply(this,arguments)},M8J=function(){G8.apply(this,arguments)},DKz=function(){G8.apply(this,arguments)},JPQ=function(){G8.apply(this,arguments)},gNd=function(){G8.apply(this,arguments)},OTt=function(Q){Q=Q.key||Q.id;
if(!Q)throw Error("Entity key is missing");return Q},FhA=function(){if(u2)return u2();
var Q={};u2=g.U6("PersistentEntityStoreDb",{qF:(Q.EntityStore={Lm:1},Q.EntityAssociationStore={Lm:2},Q),shared:!1,upgrade:function(U,q){q(1)&&g.G$(g.JO(U,"EntityStore",{keyPath:"key"}),"entityType","entityType");q(2)&&(U=g.JO(U,"EntityAssociationStore",{keyPath:["parentEntityKey","childEntityKey"]}),g.G$(U,"byParentEntityKey","parentEntityKey"),g.G$(U,"byChildEntityKey","childEntityKey"))},
version:3});return u2()},eOd=function(Q){return g.cK(FhA(),Q)},dKt=function(Q){return g.cK((0,g.Uhz)(),Q)},rn=function(Q){this.token=Q},AG=function(Q,U){U=U===void 0?{}:U;
g.Kf.call(this,g.qAx[Q],Object.assign({},{name:"PESEncoderError",type:Q},U));this.type=Q;this.level="WARNING";Object.setPrototypeOf(this,AG.prototype)},GVA=function(Q){return new AG("WRONG_DATA_TYPE",{Bd:Q})},uO8=function(Q){return Q instanceof Error?new AG("UNKNOWN_ENCODE_ERROR",{originalMessage:Q.message}):new AG("UNKNOWN_ENCODE_ERROR")},rP7=function(Q){return Q instanceof Error?new AG("UNKNOWN_DECODE_ERROR",{originalMessage:Q.message}):new AG("UNKNOWN_DECODE_ERROR")},AP8=function(Q,U){Q=Q instanceof
AG?Q:U(Q);
g.gP(Q);throw Q;},EN$=function(){},bTJ=function(Q,U,q){try{return Q.T(U,q)}catch(H){AP8(H,uO8)}},kV7=function(Q){Q=(new TextEncoder).encode(Q).subarray(0,16);
var U=new Uint8Array(16);U.set(Q);return U},EX=function(Q){this.Z=Q},cPt=function(Q){var U=IM8[Q];
if(U)return U;g.F1(new g.Kf("Entity model not found.",{entityType:Q}))},psd=function(Q,U){this.Z=Q;
this.C=U;this.T={}},$K8=function(Q,U){a:{Q=N5d(Q.C,U.version);
try{var q=Q.C(U.data,U.key);break a}catch(H){AP8(H,rP7)}q=void 0}return q},b2=function(Q,U,q){return Q.Z.objectStore("EntityStore").get(U).then(function(H){if(H){if(q&&H.entityType!==q)throw Error("Incorrect entity type");
return $K8(Q,H)}})},kG=function(Q,U,q){return q?(q=q.map(function(H){return b2(Q,H,U)}),g.hO.all(q)):Q.Z.objectStore("EntityStore").index("entityType").getAll(IDBKeyRange.only(U)).then(function(H){return H.map(function(C){return $K8(Q,C)})})},c8=function(Q,U,q){var H=OTt(U),C=N5d(Q.C,1),V=Object.assign({},U);
return Q.Z.objectStore("EntityStore").get(H).then(function(f){if(f){if(f.entityType!==q)throw Error("Incorrect entity type");V.entityMetadata||(f=$K8(Q,f),V.entityMetadata=f.entityMetadata)}}).then(function(){var f={key:H,
entityType:q,data:bTJ(C,V,H),version:1};return g.hO.all([g.F_(Q.Z.objectStore("EntityStore"),f),t87(Q,V,q)])}).then(function(){If(Q,H,q);
return H})},xKN=function(Q,U,q){U=U.map(function(H){return c8(Q,H,q)});
return g.hO.all(U)},ps=function(Q,U,q){if(q==null?0:q.Ef){var H=new Set;
return jm7(Q,U,H).then(function(){for(var V=[],f=g.F(H),Y=f.next();!Y.done;Y=f.next())V.push(ps(Q,Y.value));return g.hO.all(V).then(function(){})})}var C=g.cw(U).entityType;
return g.hO.all([Q.Z.objectStore("EntityStore").delete(U),lM3(Q,U)]).then(function(){If(Q,U,C)})},aM3=function(Q,U){return g.ED(Q.Z.objectStore("EntityStore").index("entityType"),{query:IDBKeyRange.only(U)},function(q){return g.hO.all([q.delete(),
lM3(Q,q.cursor.primaryKey)]).then(function(){If(Q,q.cursor.primaryKey,U);return g.r$(q)})})},ZT3=function(Q,U,q,H){var C=N5d(Q.C,1);
return b2(Q,U,H).then(function(V){if(V){V=g.os(V,q);var f={key:U,entityType:H,data:bTJ(C,V,U),version:1};return g.hO.all([g.F_(Q.Z.objectStore("EntityStore"),f),t87(Q,V,H)])}}).then(function(){If(Q,U,H);
return U})},If=function(Q,U,q){var H=Q.T[q];
H||(H=new Set,Q.T[q]=H);H.add(U)},vNx=function(Q,U,q){var H=OTt(U);
q=cPt(q);if(!q)return g.hO.resolve([]);q=new q(U);Q=Q.Z.objectStore("EntityAssociationStore");U=[];q=g.F(q.C());for(var C=q.next();!C.done;C=q.next())U.push(g.F_(Q,{parentEntityKey:H,childEntityKey:C.value}));return g.hO.all(U).then(function(V){return V.map(function(f){return f[1]})})},lM3=function(Q,U){return Q.Z.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(U))},t87=function(Q,U,q){var H=OTt(U);
return lM3(Q,H).then(function(){return vNx(Q,U,q)})},jm7=function(Q,U,q){if(q.has(U))return g.hO.resolve(void 0);
q.add(U);return Qct(Q,U).then(function(H){return Q.Z.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(U)).then(function(){return H})}).then(function(H){var C=g.hO.resolve(void 0);
H=g.F(H);for(var V=H.next(),f={};!V.done;f={vF:void 0},V=H.next())f.vF=V.value,C=C.then(function(Y){return function(){return jm7(Q,Y.vF,q)}}(f));
return C}).then(function(){})},Qct=function(Q,U){var q=Q.Z.objectStore("EntityAssociationStore");
return q.index("byParentEntityKey").getAll(IDBKeyRange.only(U)).then(function(H){var C=[];H=g.F(H);for(var V=H.next();!V.done;V=H.next())V=V.value,C.push(q.index("byChildEntityKey").getAll(V.childEntityKey));return g.hO.all(C)}).then(function(H){var C=[];
H=g.F(H);for(var V=H.next();!V.done;V=H.next())V=V.value,V.length===1&&C.push(V[0].childEntityKey);return C})},Nr=function(){},U5H=function(){this.Z={};
this.Z[0]=new Nr;if(!g.yx("aes_pes_encoder_killswitch")){var Q=this.Z;try{var U=g.j_();var q=kV7(U);var H=new EX(new g.Cu(q),new g.VC(q))}catch(C){throw Q=C instanceof Error?new AG("KEY_CREATION_FAILED",{originalMessage:C.message}):new AG("KEY_CREATION_FAILED"),g.gP(Q),Q;}Q[1]=H}},N5d=function(Q,U){U=U===void 0?0:U;
Q=Q.Z[U];if(!Q)throw U=new AG("INVALID_ENCODER_VERSION",{Bd:U}),g.gP(U),U;return Q},$G=function(Q,U){g.b.call(this);
this.token=Q;this.Z=U;this.observers=[];Q=new g.hz.BroadcastChannel("PERSISTENT_ENTITY_STORE_SYNC:"+g.j_());Q.onmessage=this.C.bind(this);this.channel=Q},tG=function(Q,U,q){var H,C,V,f;
return g.A(function(Y){if(Y.Z==1)return g.G(Y,eOd(Q.token),2);if(Y.Z!=3)return H=Y.C,g.G(Y,g.OD(H,["EntityStore","EntityAssociationStore"],U,function(S){C=new psd(S,Q.Z);return q(C)}),3);
V=Y.C;C&&(f=C.T,Object.keys(f).length>0&&(Q.channel.postMessage(f),qi$(Q,f)));return Y.return(V)})},xG=function(Q,U,q){return tG(Q,{mode:"readwrite",
zm:!0},function(H){return c8(H,U,q)})},HZ7=function(Q,U){return tG(Q,{mode:"readwrite",
zm:!0},function(q){return xKN(q,U,"offlineOrchestrationActionWrapperEntity")})},C_N=function(Q,U){return tG(Q,{mode:"readwrite",
zm:!0},function(q){return ps(q,U)})},VS7=function(Q){return tG(Q,{mode:"readwrite",
zm:!0},function(U){return aM3(U,"videoPlaybackPositionEntity")})},jc=function(Q,U,q){return tG(Q,{mode:"readonly",
zm:!0},function(H){return b2(H,U,q)})},l2=function(Q,U,q){return tG(Q,{mode:"readonly",
zm:!0},function(H){return kG(H,U,q)})},qi$=function(Q,U){Q=g.F(Q.observers);
for(var q=Q.next();!q.done;q=Q.next())q=q.value,q(U)},fzd=function(){var Q,U,q;
return g.A(function(H){if(H.Z==1)return g.fx(H,2),g.G(H,g.vK(),4);if(H.Z!=2){Q=H.C;if(!Q||!g.lV()||typeof g.hz.BroadcastChannel==="undefined")return H.return();U=new U5H;return H.return(new $G(Q,U))}q=g.Y8(H);q instanceof Error&&g.gP(q);return H.return()})},af=function(){ojJ||(ojJ=fzd());
return ojJ},iZ$=function(Q){var U;
Q=(U=Q.options)==null?void 0:U.persistenceOption;return Q==="ENTITY_PERSISTENCE_OPTION_PERSIST"||Q==="ENTITY_PERSISTENCE_OPTION_INMEMORY_AND_PERSIST"},TB$=function(Q){var U;
return g.A(function(q){return q.Z==1?g.G(q,af(),2):(U=q.C)?g.G(q,tG(U,"readwrite",function(H){for(var C={},V=g.F(Q),f=V.next(),Y={};!f.done;Y={Qm:void 0,y6:void 0},f=V.next())Y.Qm=f.value,Y.Qm.entityKey&&iZ$(Y.Qm)&&(Y.y6=g.WB(Y.Qm.payload),f=void 0,Y.Qm.type==="ENTITY_MUTATION_TYPE_REPLACE"&&(f=function(S){return function(){return c8(H,S.Qm.payload[S.y6],S.y6)}}(Y)),Y.Qm.type==="ENTITY_MUTATION_TYPE_DELETE"&&(f=function(S){return function(){return ps(H,S.Qm.entityKey)}}(Y)),Y.Qm.type==="ENTITY_MUTATION_TYPE_UPDATE"&&
(f=function(S){return function(){return ZT3(H,S.Qm.entityKey,S.Qm.payload[S.y6],S.y6)}}(Y)),f&&(C[Y.Qm.entityKey]=C[Y.Qm.entityKey]?C[Y.Qm.entityKey].then(f):f()));
return g.hO.all(Object.values(C))}),0):q.return()})},Yiz=function(Q){var U;
return g.A(function(q){if(q.Z==1){U=Q.mutations;if(!U||U.length<=0)return q.return();if(g.BG){var H={type:"ENTITY_LOADED"};U!==void 0&&(H.payload=U);g.BG.dispatch(H)}return g.G(q,TB$(U),2)}U.length=0;g.Cx(q)})},Si7=function(Q){return Q!==void 0},RRd=function(Q){var U=g.It();
U=Object.assign({},U);Q=Object.assign({},Q);for(var q in U)Q[q]?(U[q]!==4&&(U[q]=Q[q]),delete Q[q]):U[q]!==2&&(U[q]=4);Object.assign(U,Q);g.zZ0(U);JSON.stringify(U);return U},BBx=function(Q){var U,q;
return g.A(function(H){if(H.Z==1)return g.G(H,g.vK(),2);if(H.Z!=3)return(U=H.C)?g.G(H,g.Ng(U),3):H.return();q=H.C;return H.return(g.OD(q,["index","media","captions"],{mode:"readwrite",zm:!0},function(C){var V=IDBKeyRange.bound(Q+"|",Q+"~");C=[C.objectStore("index").delete(V),C.objectStore("media").delete(V),C.objectStore("captions").delete(V)];return g.hO.all(C).then(function(){})}))})},zR8=function(){var Q,U;
return g.A(function(q){if(q.Z==1)return g.G(q,g.vK(),2);if(q.Z!=3){Q=q.C;if(!Q)throw g.sD("rvdfd");return g.G(q,g.Ng(Q),3)}U=q.C;return q.return(g.OD(U,["index","media"],{mode:"readwrite",zm:!0},function(H){var C={};return g.u7(H.objectStore("index"),{},function(V){var f=V.cursor.key.match(/^([\w\-_]+)\|(a|v)$/),Y=g.hO.resolve(void 0);if(f){var S=f[1];f=f[2];C[S]=C[S]||{};var R;C[S][f]=g.sjN((R=V.getValue())==null?void 0:R.fmts)}else Y=V.delete().then(function(){});
return g.hO.all([g.r$(V),Y]).then(function(B){return g.F(B).next().value})}).then(function(){for(var V={},f=g.F(Object.keys(C)),Y=f.next();!Y.done;Y=f.next()){Y=Y.value;
var S=C[Y].v;V[Y]=C[Y].a&&S?1:2}var R=RRd(V);return g.qbb(H.objectStore("media"),{},function(B){var z=B.cursor.key.match(g.XDH);z&&V[z[1]]||H.objectStore("media").delete(B.cursor.key);return g.tGf(B)}).then(function(){return R})})}))})},LW8=function(Q,U){var q,H;
return g.A(function(C){if(C.Z==1)return g.G(C,g.vK(),2);if(C.Z!=3){q=C.C;if(!q)throw g.sD("wct");return g.G(C,g.Ng(q),3)}H=C.C;return g.G(C,g.OD(H,["captions"],{mode:"readwrite",zm:!0},function(V){var f=[];V=V.objectStore("captions");for(var Y=0;Y<U.length;Y++){var S=g.F_(V,U[Y],Q+"|"+U[Y].metadata.vss_id);f.push(S)}return g.hO.all(f)}),0)})},m5z=function(Q){var U,q,H;
return g.A(function(C){if(C.Z==1)return U=IDBKeyRange.bound(Q+"|",Q+"~"),g.G(C,g.vK(),2);if(C.Z!=3){q=C.C;if(!q)throw g.sD("gactfv");return g.G(C,g.Ng(q),3)}H=C.C;return C.return(H.getAll("captions",U))})},P_z=function(Q){return g.A(function(U){g.p8(Q,0);
return U.return(BBx(Q))})},wYH=function(Q){return{context:g.a7(),
videoIds:Q}},scz=function(Q){return{context:g.a7(),
playlistIds:Q}},KW3=function(Q){return{context:g.a7(),
offlinePlaylistSyncChecks:Q}},hRz=function(){this.Z=new Map},XY7=function(){WWd||(WWd=new hRz);
return WWd},yix=function(Q,U){return{eventType:{flowEventNamespace:"FLOW_EVENT_NAMESPACE_OFFLINE_ORCHESTRATION",
flowEventType:Q},metadata:U,statusCode:void 0,csn:void 0,can:void 0}},njN=function(Q,U,q){if(!q){var H=H===void 0?!1:H;
q=Q.Z.get("FLOW_TYPE_OFFLINE_ORCHESTRATION");if(!q||H)q=g.LA(16),Q.Z.set("FLOW_TYPE_OFFLINE_ORCHESTRATION",q)}Q={flowNonce:q,flowType:"FLOW_TYPE_OFFLINE_ORCHESTRATION",flowEventType:U.eventType};U.metadata&&(Q.flowMetadata=U.metadata);U.statusCode!==void 0&&(Q.flowEventStatus=U.statusCode);U.csn&&(Q.csn=U.csn);U.can&&(Q.can=U.can);g.LD("flowEvent",Q,void 0)},MSQ=function(Q){var U,q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab,rK,l$,e3,J,Qa,cH,Te;
return g.A(function(OJ){if(OJ.Z==1)return g.G(OJ,tG(Q,{mode:"readonly",zm:!0},function(n){return kG(n,"playbackData").then(function(U1){var Xo=U1.map(function(Qz){return Qz.transfer}).filter(function(Qz){return!!Qz}),Tj=U1.map(function(Qz){return Qz.offlineVideoPolicy}).filter(function(Qz){return!!Qz}),jK=U1.filter(function(Qz){return!!Qz.key}).map(function(Qz){return g.pK(g.cw(Qz.key).entityId,"downloadStatusEntity")});
Xo=kG(n,"transfer",Xo);Tj=kG(n,"offlineVideoPolicy",Tj);jK=kG(n,"downloadStatusEntity",jK);var YZ=Xo.then(function(Qz){Qz=Qz.reduce(function(HH,Jb){(Jb==null?0:Jb.offlineVideoStreams)&&HH.push.apply(HH,g.$y(Jb.offlineVideoStreams));return HH},[]).filter(function(HH){return!!HH});
return kG(n,"offlineVideoStreams",Qz)});
return g.hO.all([Xo,Tj,YZ,jK]).then(function(Qz){var HH=g.F(Qz);Qz=HH.next().value;var Jb=HH.next().value;var D=HH.next().value;HH=HH.next().value;return[U1,Qz,Jb,D,HH]})})}),2);
if(OJ.Z!=3)return U=OJ.C,g.G(OJ,tG(Q,{mode:"readonly",zm:!0},function(n){return kG(n,"mainDownloadsListEntity").then(function(U1){var Xo,Tj;return(Tj=(Xo=U1[0])==null?void 0:Xo.downloads)!=null?Tj:[]})}),3);
q=OJ.C;H=g.F(U);C=H.next().value;V=H.next().value;f=H.next().value;Y=H.next().value;S=H.next().value;R=C;B=V;z=f;m=Y;L=S;P={};W={};y={};e={};O={};d=[];u=g.F(B);for(c=u.next();!c.done;c=u.next())(k=c.value)&&(P[k.key]=k);v=g.F(z);for(qH=v.next();!qH.done;qH=v.next())(Ho=qH.value)&&(W[Ho.key]=Ho);ff=g.F(L);for(Bo=ff.next();!Bo.done;Bo=ff.next())(Cf=Bo.value)&&(y[Cf.key]=Cf);Wo=g.F(m);for(vo=Wo.next();!vo.done;vo=Wo.next())(i$=vo.value)&&(e[i$.key]=i$);ky=g.F(q);for(ab=ky.next();!ab.done;ab=ky.next())rK=
ab.value,l$=void 0,O[(l$=rK.videoItem)!=null?l$:""]=!0,rK.videoItem&&(J=e3=void 0,Qa=(J=(e3=g.cw(rK.videoItem))==null?void 0:e3.entityId)!=null?J:"",d.push({externalVideoId:Qa}));cH=R.filter(function(n){if(!n||!n.key||!n.offlineVideoPolicy)return!1;n=g.cw(n.key).entityId;n=g.pK(n,"downloadStatusEntity");var U1;return!(n&&((U1=y[n])==null?void 0:U1.downloadState)==="DOWNLOAD_STATE_USER_DELETED")});
Te=cH.map(function(n){var U1=P[n.transfer],Xo=[];if(U1==null?0:U1.offlineVideoStreams)for(var Tj=g.F(U1.offlineVideoStreams),jK=Tj.next();!jK.done;jK=Tj.next())(jK=e[jK.value])&&Xo.push(jK);Tj=W[n.offlineVideoPolicy];jK=O;var YZ=n==null?void 0:n.playerResponseTimestamp,Qz=g.cw(Tj.key).entityId;n=g.pK(Qz,"mainVideoEntity");if(Tj.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"){var HH="OFFLINE_VIDEO_STATE_DISABLED";Tj.expirationTimestamp&&Number(Tj.expirationTimestamp)<Date.now()/1E3&&(HH="OFFLINE_VIDEO_STATE_EXPIRED")}else if(Tj.action===
"OFFLINE_VIDEO_POLICY_ACTION_DOWNLOAD_FAILED")HH="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";else{switch(U1==null?void 0:U1.transferState){case "TRANSFER_STATE_TRANSFER_IN_QUEUE":HH="OFFLINE_VIDEO_STATE_PENDING";break;case "TRANSFER_STATE_TRANSFERRING":HH="OFFLINE_VIDEO_STATE_TRANSFERRING";break;case "TRANSFER_STATE_PAUSED_BY_USER":HH="OFFLINE_VIDEO_STATE_PAUSED_TRANSFER";break;case "TRANSFER_STATE_FAILED":HH="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";break;case "TRANSFER_STATE_COMPLETE":HH="OFFLINE_VIDEO_STATE_PLAYABLE";
break;case "TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH":HH="OFFLINE_VIDEO_STATE_STREAMS_OUT_OF_DATE";break;default:HH="OFFLINE_VIDEO_STATE_UNKNOWN"}if(HH==="OFFLINE_VIDEO_STATE_OFFLINE_FAILED")switch(U1==null?void 0:U1.failureReason){case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":HH="OFFLINE_VIDEO_STATE_OUT_OF_STORAGE_ERROR";break;case "TRANSFER_FAILURE_REASON_STREAM_MISSING":HH="OFFLINE_VIDEO_STATE_STREAMS_MISSING";break;case "TRANSFER_FAILURE_REASON_NETWORK":case "TRANSFER_FAILURE_REASON_NETWORK_LOST":HH=
"OFFLINE_VIDEO_STATE_NETWORK_ERROR"}}Qz={id:Qz,videoState:HH};if(U1==null?0:U1.cotn)Qz.cotn=U1.cotn;if(U1==null?0:U1.maximumDownloadQuality)Qz.selectedVideoQuality=U1==null?void 0:U1.maximumDownloadQuality;if(U1==null?0:U1.lastProgressTimeMs)Qz.lastProgressTimeMs=U1.lastProgressTimeMs;YZ&&(Qz.playerResponseSavedTimeMs=String(Number(YZ)*1E3));U1=String;YZ=0;Xo=g.F(Xo);for(HH=Xo.next();!HH.done;HH=Xo.next())if(HH=HH.value,HH.streamsProgress){HH=g.F(HH.streamsProgress);for(var Jb=HH.next();!Jb.done;Jb=
HH.next()){var D=void 0;YZ+=Number((D=Jb.value.numBytesDownloaded)!=null?D:0)}}Qz.downloadedBytes=U1(YZ);Qz.selectedOfflineMode=jK[n]?"OFFLINE_MODE_TYPE_AUTO_OFFLINE":"OFFLINE_NOW";Tj.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"&&(Qz.offlinePlaybackDisabledReason=Tj.offlinePlaybackDisabledReason);return Qz});
return OJ.return({offlineVideos:Te,additionalOfflineClientState:{mainAppAdditionalOfflineClientState:{smartDownloadVideos:d}}})})},D53=function(){this.locks=navigator.locks},JiH=function(){try{var Q=g.X7("ytglobal.locks_");
if(Q)return Q;var U;if(U=navigator){var q=navigator;U="locks"in q&&!!q.locks}if(U)return g.hz.localStorage&&g.hz.localStorage.getItem("noop"),Q=new D53,g.WH("ytglobal.locks_",Q),Q}catch(H){}},Z0=function(){},gjN=function(){},OZz=function(Q){if(Q.includes(":"))throw Error("Invalid user cache name: "+Q);
return Q+":"+g.j_("CacheStorage get")},FWH=function(){return g.A(function(Q){if(v8!==void 0)return Q.return(v8);
v8=new Promise(function(U){var q;return g.A(function(H){switch(H.Z){case 1:return g.fx(H,2),g.G(H,Q8.open("test-only"),4);case 4:return g.G(H,Q8.delete("test-only"),5);case 5:g.Tt(H,3);break;case 2:if(q=g.Y8(H),q instanceof Error&&q.name==="SecurityError")return U(!1),H.return();case 3:U("caches"in window),g.Cx(H)}})});
return Q.return(v8)})},d5J=function(){return g.A(function(Q){if(Q.Z==1)return g.G(Q,FWH(),2);
if(!Q.C)return Q.return(void 0);eRH||(eRH=new gjN);return Q.return(eRH)})},U$=function(Q,U,q){g.F1(new g.Kf("Woffle: "+Q,q?{cotn:q}:""));
U instanceof Error&&g.F1(U)},Gxx=function(Q){var U;
return g.A(function(q){if(q.Z==1)return g.G(q,MSQ(Q),2);U=q.C;g.LD("offlineStateSnapshot",U);g.Cx(q)})},qk=function(Q){g.b.call(this);
var U=this;this.api=Q;this.L_={evv:function(){return U.Z},
GjE:function(){return U.C}};
typeof g.hz.BroadcastChannel!=="undefined"&&(this.Z=new g.hz.BroadcastChannel("PLAYER_OFFLINE_ERROR_SYNC:"+g.j_()),this.Z.onmessage=this.T.bind(this),this.C=new g.hz.BroadcastChannel("PLAYER_OFFLINE_PAUSE_SYNC:"+g.j_()),this.C.onmessage=this.X.bind(this))},Hj=function(Q,U){Q.api.l2("onOfflineOperationFailure",U);
var q;(q=Q.Z)==null||q.postMessage(U)},uCA=function(Q,U,q){var H=this;
this.L=Q;this.u2=U;this.visibility=q;this.J=this.B=this.U=this.T=this.Z=!1;this.X=new g.ai(function(){H.yf()});
this.L_={uT:function(){return H.C},
yf:function(){H.yf()},
ObE:function(){return H.X}};
this.visibility.subscribe("visibilitystatechange",function(){H.gH()})},rit=function(Q){if(!Q.T&&!Q.Z){var U=JiH();
if(U){Q.T=!0;var q=g.j_("OfflineLockManager");U.request("woffle_orchestration_leader:"+q,{},function(){var H,C;return g.A(function(V){switch(V.Z){case 1:return g.fx(V,2),Q.C=new g.Rx,Q.Z=!0,Q.T=!1,g.G(V,Q.L(),4);case 4:return g.G(V,Q.C.promise,5);case 5:g.Tt(V,0);break;case 2:H=g.Y8(V),Q.yf(),H instanceof Error&&(C=H,C.args=[{name:"WoLockManagerError",ze:H.name}],g.gP(C)),g.Cx(V)}})})}}},Aid=function(Q){Q.Z&&(Q.J=!0,Cm(Q))},EjH=function(Q,U){Q.Z&&(Q.U=U,Cm(Q))},bZJ=function(Q,U){Q.Z&&(Q.B=U,Cm(Q))},
Cm=function(Q){Q.B&&Q.U&&Q.J&&Q.visibility.isBackground()?g.Z6(Q.X,6E4):Q.X.stop()},V8=function(Q){var U;
Q.offlineDeleteReason=(U=Q.offlineDeleteReason)!=null?U:"OFFLINE_DELETE_REASON_UNKNOWN";var q;Q.offlineModeType=(q=Q.offlineModeType)!=null?q:"OFFLINE_NOW";g.LD("offlineDeleteEvent",Q)},fm=function(Q,U){var q=U.videoId;
var H=U.QH;U=U.offlineModeType;Q.encryptedVideoId=q;Q.cotn=H==null?void 0:H.cotn;Q.offlineabilityFormatType=H==null?void 0:H.maximumDownloadQuality;var C;Q.isRefresh=(C=H==null?void 0:H.isRefresh)!=null?C:!1;var V;Q.softErrorCount=(V=H==null?void 0:H.transferRetryCount)!=null?V:0;Q.offlineModeType=U!=null?U:"OFFLINE_NOW";(Q.transferStatusType==="TRANSFER_STATUS_TYPE_UNKNOWN"&&Q.statusType==="UNKNOWN_STATUS_TYPE"||!Q.transferStatusType&&!Q.statusType)&&g.F1(Error("Woffle unknown transfer status"));
g.LD("offlineTransferStatusChanged",Q)},kx7=function(Q){fm({transferStatusType:"TRANSFER_STATUS_TYPE_ENQUEUED",
statusType:"ADDED_TO_QUEUE"},Q)},Izt=function(Q,U,q,H){H={transferStatusType:"TRANSFER_STATUS_TYPE_PROCESSING",
statusType:"OFFLINING_STARTED",transferFirstStarted:!!H};U&&q&&(U=Math.floor(U/1024).toFixed(),q=Math.floor(q/1024).toFixed(),H.alreadyDownloadedKbytes=U,H.totalFetchedKbytes=U,H.totalContentKbytes=q);fm(H,Q)},ci3=function(Q){fm({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_PLAYER_RESPONSE_REFRESH"},Q)},pYH=function(Q){fm({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_USER_PAUSE",
statusType:"SUSPENDED"},Q)},NB7=function(Q){switch(Q){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":return"OFFLINE_DATABASE_ERROR";
case "TRANSFER_FAILURE_REASON_PLAYABILITY":return"NOT_PLAYABLE";case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":return"TOO_MANY_RETRIES";case "TRANSFER_FAILURE_REASON_INTERNAL":return"OFFLINE_DOWNLOAD_CONTROLLER_ERROR";case "TRANSFER_FAILURE_REASON_STREAM_MISSING":return"STREAM_VERIFICATION_FAILED";case "TRANSFER_FAILURE_REASON_SERVER":case "TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING":return"OFFLINE_REQUEST_FAILURE";case "TRANSFER_FAILURE_REASON_NETWORK":return"OFFLINE_NETWORK_ERROR";default:return"UNKNOWN_FAILURE_REASON"}},
or=function(Q){var U,q,H;
return((H=(U=Q.actionMetadata)==null?void 0:(q=U.retryScheduleIntervalsInSeconds)==null?void 0:q.length)!=null?H:0)>0},Tw=function(Q){return Q.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD"&&!!Q.entityKey},Y7=function(Q){return Q.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&!!Q.entityKey},Sw=function(Q){return Q.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&!!Q.entityKey},$5d=function(Q){return Q.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE"&&!!Q.entityKey},
Rr=function(Q,U,q,H,C){C=C===void 0?!1:C;
var V,f,Y,S,R,B;return g.A(function(z){if(z.Z==1)return V=g.pK(Q,U),f=g.pK(Q,"downloadStatusEntity"),g.G(z,tG(q,{mode:"readonly",zm:!0},function(m){return g.hO.all([b2(m,V,U),b2(m,f,"downloadStatusEntity")])}),2);
Y=z.C;S=Y.length?Y[0]:void 0;if(!S)return z.gL(0);R=tS8;if(B=Y.length>1?Y[1]:void 0){if(B.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&!C)return z.return();B.downloadState=H}else B={key:f,downloadState:H};g.rP(S,R,B);return g.G(z,tG(q,{mode:"readwrite",zm:!0},function(m){return g.hO.all([c8(m,S,U),c8(m,B,"downloadStatusEntity")])}),0)})},Bj=function(Q,U){return Q.actionType===U.actionType&&Q.entityKey===U.entityKey},zw=function(Q,U){if(Q&&Q.transferState!=="TRANSFER_STATE_COMPLETE"&&Q.transferState!==
"TRANSFER_STATE_FAILED"){var q=g.cw(Q.key).entityId;
fm({transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_BY_USER",statusType:"CANCELLED"},{videoId:q,QH:Q,offlineModeType:U})}},Lm=function(Q){if(!Q||!Q.thumbnails)return[];
var U=[];Q=g.F(Q.thumbnails);for(var q=Q.next();!q.done;q=Q.next())q=q.value,q.url&&U.push(q.url);return U},x5d=function(Q,U,q){q=q===void 0?[]:q;
var H,C,V,f,Y,S,R,B,z,m,L,P,W;return g.A(function(y){if(y.Z==1)return q.length?g.G(y,l2(Q,U),2):y.return([]);H=y.C;C=new Set;V=g.F(H);for(f=V.next();!f.done;f=V.next())if(Y=f.value,S=Y.id||Y.key)R=g.cw(S).entityId,C.add(R);B=[];z=g.F(q);for(m=z.next();!m.done;m=z.next())L=m.value,P=L.offlineVideoData,W=void 0,((W=P)==null?0:W.videoId)&&!C.has(P.videoId)&&B.push(L);return y.return(B)})},jcz=function(Q,U,q){return new g.HG(Q,{cotn:U,
raw_player_response:q,download_media:!0,start:Infinity,disable_watch_next:!0})},lzt=function(){return{priority:1,
retryScheduleIntervalsInSeconds:[1,2,4]}},m$=function(Q,U,q,H,C,V,f,Y,S,R,B){this.entityType=Q;
this.actionId=U;this.action=q;this.parentActionId=H;this.rootActionId=C===void 0?U:C;this.childActionIds=V;this.prereqActionId=f;this.postreqActionIds=Y;this.hasChildActionFailed=R;this.retryScheduleIndex=0;this.Z=B||Date.now();this.retryScheduleIndex=S||0},Pj=function(Q){if(!Q.key)throw Error("Entity key is required.");
if(!Q.actionProto)throw Error("OfflineOrchestrationAction is required.");var U=g.cw(Q.key),q=g.cw(Q.actionProto.entityKey);return new m$(q.entityType,U.entityId,Q.actionProto,Q.parentActionId,Q.rootActionId,Q.childActionIds,Q.prereqActionId,Q.postreqActionIds,Q.retryScheduleIndex,Q.hasChildActionFailed,Number(Q.enqueueTimeSec)*1E3)},wX=function(Q){return{key:g.pK(Q.actionId,"offlineOrchestrationActionWrapperEntity"),
actionProto:Q.action,parentActionId:Q.parentActionId,rootActionId:Q.rootActionId,childActionIds:Q.childActionIds,prereqActionId:Q.prereqActionId,postreqActionIds:Q.postreqActionIds,retryScheduleIndex:Q.retryScheduleIndex,hasChildActionFailed:Q.hasChildActionFailed,enqueueTimeSec:(Q.Z/1E3).toFixed()}},azd=function(){var Q;
return g.A(function(U){return U.Z==1?g.G(U,d5J(),2):(Q=U.C)?U.return(Q.delete("yt-player-local-img")):U.return(!0)})},s$=function(Q){var U,q;
return g.A(function(H){if(H.Z==1)return g.G(H,d5J(),2);if(H.Z!=3){U=H.C;if(!U)throw Error("Cache API not supported");return Q.length?g.G(H,U.open("yt-player-local-img"),3):H.return()}q=H.C;return g.G(H,Promise.all(Q.map(function(C){return q.delete(C)})),0)})},Km=function(Q){var U,q;
return g.A(function(H){if(H.Z==1)return g.G(H,d5J(),2);if(H.Z!=3){U=H.C;if(!U)throw Error("Cache API not supported");return Q.length?g.G(H,U.open("yt-player-local-img"),3):H.return()}q=H.C;return g.G(H,q.addAll(Q),0)})},hT=function(Q,U,q,H,C){var V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab,rK,l$;
return g.A(function(e3){switch(e3.Z){case 1:return V=g.pK(Q,"mainVideoEntity"),f=g.pK(Q,"ytMainChannelEntity"),Y=g.pK(Q,"transfer"),S=g.pK(Q,"videoDownloadContextEntity"),g.G(e3,tG(U,{mode:"readonly",zm:!0},function(J){return g.hO.all([b2(J,V,"mainVideoEntity"),b2(J,f,"ytMainChannelEntity"),b2(J,Y,"transfer"),b2(J,S,"videoDownloadContextEntity"),kG(J,"ytMainChannelEntity"),kG(J,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:R=e3.C;B=g.F(R);z=B.next().value;m=B.next().value;L=B.next().value;P=B.next().value;W=B.next().value;y=B.next().value;e=z;O=m;d=L;u=P;c=W;k=y;if(!e&&!O){e3.gL(3);break}v=e?Lm(e.thumbnail):[];if(!O){qH=[];e3.gL(4);break}return g.G(e3,ZZd(O,c),5);case 5:qH=e3.C;case 4:return Ho=qH,g.G(e3,s$(v.concat(Ho)),3);case 3:ff=[];Bo=g.pK(Q,"downloadStatusEntity");Cf=g.F(k);for(Wo=Cf.next();!Wo.done;Wo=Cf.next())vo=Wo.value,i$=g.cw(vo.key).entityId,ky=Pj(vo),ab=g.cw(ky.action.entityKey).entityId,i$!==Q&&
ab!==Q||Bj(q,vo.actionProto)||ff.push(vo.key);return g.G(e3,tG(U,{mode:"readwrite",zm:!0},function(J){var Qa=ff.map(function(cH){return ps(J,cH)});
Qa.push(ps(J,V,{Ef:!0}));Qa.push(ps(J,Bo,{Ef:!0}));return g.hO.all(Qa)}),7);
case 7:l$=(rK=u)==null?void 0:rK.offlineModeType,C&&(V8(C),C.offlineModeType&&(l$=C.offlineModeType)),zw(d,l$),Hj(H,{entityKey:V,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.Cx(e3)}})},UjJ=function(Q,U,q,H){var C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab,rK,l$,e3,J,Qa,cH,Te,OJ,n,U1,Xo,Tj,jK,YZ,Qz,HH,Jb,D,X,M;
return g.A(function(r){switch(r.Z){case 1:return C=g.pK(Q,"mainPlaylistEntity"),V=g.pK(Q,"ytMainChannelEntity"),g.G(r,tG(U,{mode:"readonly",zm:!0},function(x){return g.hO.all([b2(x,C,"mainPlaylistEntity"),b2(x,V,"ytMainChannelEntity"),kG(x,"mainPlaylistEntity"),kG(x,"mainDownloadsListEntity"),kG(x,"ytMainChannelEntity"),kG(x,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:f=r.C;Y=g.F(f);S=Y.next().value;R=Y.next().value;B=Y.next().value;z=Y.next().value;m=Y.next().value;L=Y.next().value;P=S;W=R;y=B;e=z;O=m;d=L;if(!P&&!W){r.gL(3);break}u=P?vjJ(P):[];if(!W){c=[];r.gL(4);break}return g.G(r,ZZd(W,O),5);case 5:c=r.C;case 4:return k=c,g.G(r,s$(u.concat(k)),3);case 3:v=[];qH=new Map;if(!P){r.gL(7);break}return g.G(r,Q3N(P,y,e),8);case 8:v=r.C;Ho=g.F(v);for(ff=Ho.next();!ff.done;ff=Ho.next())Bo=ff.value,qH.set(Bo,{videoId:Bo,playlistId:Q,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});
return g.G(r,tG(U,{mode:"readonly",zm:!0},function(x){return g.hO.all([kG(x,"transfer"),kG(x,"videoDownloadContextEntity")])}),9);
case 9:Cf=r.C;Wo=g.F(Cf);vo=Wo.next().value;i$=Wo.next().value;ky=vo;ab=i$;rK=g.F(ky);for(l$=rK.next();!l$.done;l$=rK.next())e3=l$.value,J=g.cw(e3.key).entityId,(Qa=qH.get(J))&&e3&&(Qa.cotn=e3.cotn);cH=g.F(ab);for(Te=cH.next();!Te.done;Te=cH.next())OJ=Te.value,n=g.cw(OJ.key).entityId,(U1=qH.get(n))&&OJ&&(U1.offlineModeType=OJ.offlineModeType);case 7:Xo=[];Tj=g.F(d);for(jK=Tj.next();!jK.done;jK=Tj.next())YZ=jK.value,Qz=g.cw(YZ.key).entityId,HH=Pj(YZ),Qz!==Q&&HH.rootActionId!==Q||Bj(q,YZ.actionProto)||
Xo.push(YZ.key);Jb=g.pK(Q,"mainPlaylistEntity");return g.G(r,tG(U,{mode:"readwrite",zm:!0},function(x){var i4=Xo.map(function(a){return ps(x,a)});
i4.push(ps(x,Jb,{Ef:!0}));return g.hO.all(i4)}),10);
case 10:if(!P){r.gL(0);break}v.reverse();if(!v){r.gL(0);break}D=g.F(v);X=D.next();case 13:if(X.done){r.gL(0);break}M=X.value;return g.G(r,hT(M,U,q,H,qH.get(M)),14);case 14:X=D.next(),r.gL(13)}})},H_3=function(Q,U,q,H){var C,V,f,Y,S,R,B,z,m;
return g.A(function(L){if(L.Z==1)return C=g.pK("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),V=new Map,g.G(L,tG(Q,{mode:"readwrite",zm:!0},function(P){var W=kG(P,"transfer"),y=kG(P,"offlineOrchestrationActionWrapperEntity"),e=kG(P,"videoDownloadContextEntity"),O=b2(P,C,"mainDownloadsListEntity");return g.hO.all([W,y,e,O]).then(function(d){d=g.F(d);var u=d.next().value;var c=d.next().value;var k=d.next().value;var v=d.next().value;d=q3H.map(function(Ho){return aM3(P,Ho)});
c=g.F(c);for(var qH=c.next();!qH.done;qH=c.next())qH=qH.value,Bj(U,qH.actionProto)||d.push(ps(P,qH.key,{Ef:!0}));v&&(v.downloads=[],d.push(c8(P,v,"mainDownloadsListEntity")));if(k)for(k=g.F(k),v=k.next();!v.done;v=k.next())v=v.value,c=g.cw(v.key).entityId,c=g.pK(c,"transfer"),V.set(c,v.offlineModeType);return g.hO.all(d).then(function(){return u})})}),2);
f=L.C;Y=g.F(f);for(S=Y.next();!S.done;S=Y.next())R=S.value,zw(R,V.get(R.key)),B=g.cw(R.key).entityId,z={videoId:B,offlineDeleteReason:H,cotn:R.cotn,offlineModeType:V.get(R.key)},V8(z),m=g.pK(B,"mainVideoEntity"),Hj(q,{entityKey:m,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.G(L,azd(),0)})},vjJ=function(Q,U){var q=[];
if(Q.thumbnailStyleData){Q=g.F(Q.thumbnailStyleData);for(var H=Q.next();!H.done;H=Q.next()){var C=void 0,V=void 0,f=void 0;q=q.concat(Lm((C=H.value)==null?void 0:(V=C.value)==null?void 0:(f=V.collageThumbnail)==null?void 0:f.coverThumbnail))}}U=Lm(U);return q.concat(U)},Q3N=function(Q,U,q){var H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho;
return g.A(function(ff){H=[];C=new Set;if(q.length)for(V=g.F(q),f=V.next();!f.done;f=V.next())if(Y=f.value,S=void 0,(S=Y.downloads)==null?0:S.length)for(R=g.F(Y.downloads),B=R.next();!B.done;B=R.next())z=B.value,z.videoItem&&(m=g.cw(z.videoItem).entityId,C.add(m));if(Q.videos){L=g.F(Q.videos);for(P=L.next();!P.done;P=L.next())W=P.value,y=JSON.parse(g.cw(W).entityId),y.videoId&&!C.has(y.videoId)&&H.push(y.videoId);e=g.F(U);for(O=e.next();!O.done;O=e.next())if(d=O.value,d.key!==Q.key&&(u=d.videos))for(c=
g.F(u),k=c.next();!k.done;k=c.next())v=k.value,qH=JSON.parse(g.cw(v).entityId),qH.videoId&&(Ho=H.indexOf(qH.videoId),Ho!==-1&&H.splice(Ho,1))}return ff.return(H)})},ZZd=function(Q,U){var q,H,C,V,f,Y,S,R;
return g.A(function(B){q=Lm(Q.avatar);H=g.F(U);for(C=H.next();!C.done;C=H.next())if(V=C.value,V.id!==Q.id)for(f=g.F(Lm(V.avatar)),Y=f.next();!Y.done;Y=f.next())S=Y.value,R=q.indexOf(S),R!==-1&&q.splice(R,1);return B.return(q)})},C5d=function(Q){var U;
return g.A(function(q){U=g.K(Q.frameworkUpdates,Wj);return Q.frameworkUpdates&&U?g.G(q,Yiz(U),0):q.return()})},fWQ=function(Q){var U;
if((U=Q.onResponseReceivedActions)!=null&&U.length){var q;Q=(q=g.K(g.K(Q.onResponseReceivedActions[0],VRz),g.V3z))==null?void 0:q.actions;if(Q!=null&&Q.length)return Q}},ou8=function(Q){var U,q,H;
return g.A(function(C){if(C.Z==1)return Q?g.G(C,jc(Q,g.e4,"mainDownloadsListEntity"),2):C.return([]);U=C.C;return((q=U)==null?0:(H=q.downloads)==null?0:H.length)?C.return(U.downloads.map(function(V){var f;return(f=V.videoItem)!=null?f:""})):C.return([])})},TyJ=function(Q,U){var q;
return g.A(function(H){return H.Z==1?g.G(H,i_t(Q,U),2):(q=H.C)?g.G(H,tG(Q,{mode:"readwrite",zm:!0},function(C){var V=[c8(C,q.mainDownloadsLibraryEntity,"mainDownloadsLibraryEntity")];q.mainDownloadsListEntity&&V.push(c8(C,q.mainDownloadsListEntity,"mainDownloadsListEntity"));return g.hO.all(V)}),0):H.gL(0)})},i_t=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d;
return g.A(function(u){if(u.Z==1)return q=g.pK("main_downloads_library_id","mainDownloadsLibraryEntity"),H=g.pK("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.G(u,tG(Q,{mode:"readonly",zm:!0},function(c){return g.hO.all([b2(c,q,"mainDownloadsLibraryEntity"),b2(c,H,"mainDownloadsListEntity")])}),2);
C=u.C;V=g.F(C);f=V.next().value;Y=V.next().value;S=f;R=Y;S||(S={id:q});B=g.F(U);for(z=B.next();!z.done;z=B.next())if(m=z.value,m===g.e4){if(S.smartDownloadsList)return u.return();S.smartDownloadsList=m}else if(L=g.cw(m).entityType,P={},L==="mainPlaylistEntity"?P.playlistItem=m:L==="mainVideoEntity"&&(P.videoItem=m),!g.OA(P)){W=void 0;if((W=R)==null?0:W.downloads){y=!1;e=g.F(R.downloads);for(O=e.next();!O.done;O=e.next())if(d=O.value,d.playlistItem===m||d.videoItem===m){y=!0;break}y||R.downloads.push(P)}else R=
{id:H,downloads:[P]};S.downloadsList=H}return u.return({mainDownloadsLibraryEntity:S,mainDownloadsListEntity:R})})},Y3d=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y;
return g.A(function(e){if(e.Z==1)return q=g.pK("main_downloads_library_id","mainDownloadsLibraryEntity"),H=g.pK("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.G(e,tG(Q,{mode:"readonly",zm:!0},function(O){return g.hO.all([b2(O,q,"mainDownloadsLibraryEntity"),b2(O,H,"mainDownloadsListEntity"),b2(O,g.e4,"mainDownloadsListEntity")])}),2);
C=e.C;V=g.F(C);f=V.next().value;Y=V.next().value;S=V.next().value;R=f;B=Y;z=S;if(!R)return e.gL(0);if(U===g.e4&&((m=z)==null?0:m.downloads))z.downloads=[];else if((L=B)==null?0:L.downloads)for(P=g.cw(U).entityType,W=0;W<B.downloads.length;W++)if(y=B.downloads[W],P==="mainVideoEntity"&&y.videoItem===U){B.downloads.splice(W,1);break}else if(P==="mainPlaylistEntity"&&y.playlistItem===U){B.downloads.splice(W,1);break}return g.G(e,tG(Q,{mode:"readwrite",zm:!0},function(O){var d=[c8(O,R,"mainDownloadsLibraryEntity")];
B&&d.push(c8(O,B,"mainDownloadsListEntity"));z&&d.push(c8(O,z,"mainDownloadsListEntity"));return g.hO.all(d)}),0)})},X2=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m;
return g.A(function(L){if(L.Z==1)return q=g.pK(U,"transfer"),H=g.pK(U,"videoDownloadContextEntity"),g.G(L,tG(Q,{mode:"readonly",zm:!0},function(P){return g.hO.all([b2(P,q,"transfer"),b2(P,H,"videoDownloadContextEntity")])}),2);
C=L.C;V=g.F(C);f=V.next().value;Y=V.next().value;S=f;R=Y;m={videoId:U,cotn:(B=S)==null?void 0:B.cotn,offlineModeType:(z=R)==null?void 0:z.offlineModeType};return L.return(m)})},y8=function(Q,U,q,H,C){var V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH;
return g.A(function(Ho){switch(Ho.Z){case 1:return V=g.pK(Q,"musicTrack"),f=g.pK(Q,"transfer"),g.G(Ho,tG(U,{mode:"readonly",zm:!0},function(ff){return g.hO.all([b2(ff,V,"musicTrack"),b2(ff,f,"transfer"),kG(ff,"musicTrack"),kG(ff,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:Y=Ho.C;S=g.F(Y);R=S.next().value;B=S.next().value;z=S.next().value;m=S.next().value;L=R;P=B;W=z;y=m;if(!L){Ho.gL(3);break}return g.G(Ho,S3N(L,W),4);case 4:return e=Ho.C,g.G(Ho,s$(e),3);case 3:O=[];d=g.F(y);for(u=d.next();!u.done;u=d.next())c=u.value,k=g.cw(c.key).entityId,v=Pj(c),qH=g.cw(v.action.entityKey).entityId,k!==Q&&qH!==Q||Bj(q,c.actionProto)||O.push(c.key);return g.G(Ho,tG(U,{mode:"readwrite",zm:!0},function(ff){var Bo=O.map(function(Cf){return ps(ff,Cf)});
Bo.push(ps(ff,V,{Ef:!0}));return g.hO.all(Bo)}),6);
case 6:zw(P),C&&V8(C),Hj(H,{entityKey:V,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.Cx(Ho)}})},nm=function(Q,U,q,H,C){var V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab,rK,l$,e3,J,Qa,cH,Te;
return g.A(function(OJ){switch(OJ.Z){case 1:return V=g.pK(Q,U),f=g.pK("music_downloads_library_id","musicDownloadsLibraryEntity"),g.G(OJ,tG(q,{mode:"readonly",zm:!0},function(n){return g.hO.all([b2(n,V,U),b2(n,f,"musicDownloadsLibraryEntity"),kG(n,U),kG(n,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:Y=OJ.C;S=g.F(Y);R=S.next().value;B=S.next().value;z=S.next().value;m=S.next().value;L=R;P=B;W=z;y=m;if(!L){OJ.gL(3);break}return g.G(OJ,S3N(L,W),4);case 4:return e=OJ.C,g.G(OJ,s$(e),3);case 3:O=[];d=new Map;if(!L){OJ.gL(6);break}return g.G(OJ,Rxz(L,W,P),7);case 7:O=OJ.C;u=g.F(O);for(c=u.next();!c.done;c=u.next())k=c.value,v=g.cw(k).entityId,d.set(v,{videoId:v,playlistId:Q,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});return g.G(OJ,l2(q,"transfer"),8);case 8:for(qH=OJ.C,Ho=
g.F(qH),ff=Ho.next();!ff.done;ff=Ho.next())Bo=ff.value,Cf=g.cw(Bo.key).entityId,(Wo=d.get(Cf))&&Bo&&(Wo.cotn=Bo.cotn);case 6:vo=[];i$=g.F(y);for(ky=i$.next();!ky.done;ky=i$.next())ab=ky.value,rK=g.cw(ab.key).entityId,l$=Pj(ab),rK!==Q&&l$.rootActionId!==Q||Bj(H,ab.actionProto)||vo.push(ab.key);e3=g.pK(Q,U);return g.G(OJ,tG(q,{mode:"readwrite",zm:!0},function(n){var U1=vo.map(function(Xo){return ps(n,Xo)});
U1.push(ps(n,e3,{Ef:!0}));return g.hO.all(U1)}),9);
case 9:if(!L){OJ.gL(0);break}O.reverse();if(!O.length){OJ.gL(0);break}J=g.F(O);Qa=J.next();case 12:if(Qa.done){OJ.gL(0);break}cH=Qa.value;Te=g.cw(cH).entityId;if(!Te){OJ.gL(13);break}return g.G(OJ,y8(Te,q,H,C,d.get(Te)),13);case 13:Qa=J.next(),OJ.gL(12)}})},Mk=function(Q,U,q){var H,C,V,f,Y,S,R;
return g.A(function(B){if(B.Z==1)return g.G(B,tG(Q,{mode:"readwrite",zm:!0},function(z){var m=kG(z,"transfer"),L=kG(z,"offlineOrchestrationActionWrapperEntity");return g.hO.all([m,L]).then(function(P){P=g.F(P);var W=P.next().value;var y=P.next().value;P=Byz.map(function(u){return aM3(z,u)});
y=g.F(y);for(var e=y.next();!e.done;e=y.next()){e=e.value;var O=g.cw(e.actionProto.entityKey).entityType==="musicTrack",d=e.actionProto.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD";Bj(U,e.actionProto)||O&&(!O||d)||P.push(ps(z,e.key,{Ef:!0}))}return g.hO.all(P).then(function(){return W})})}),2);
H=B.C;C=g.F(H);for(V=C.next();!V.done;V=C.next())f=V.value,zw(f),Y=g.cw(f.key).entityId,S={videoId:Y,offlineDeleteReason:void 0,cotn:f.cotn},V8(S),R=g.pK(Y,"musicTrack"),Hj(q,{entityKey:R,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.G(B,azd(),0)})},zxA=function(Q){for(var U,q=g.F(Q.additionalMetadatas),H=q.next();!H.done;H=q.next())H=H.value,H.offlineMusicVideoData&&(U=H.offlineMusicVideoData);
var C,V,f,Y,S;return{id:g.pK(Q.videoId,"musicTrack"),videoId:Q.videoId,title:Q.title,thumbnailDetails:Q.thumbnail,lengthMs:String(Number(Q.lengthSeconds)*1E3),albumTitle:(C=U)==null?void 0:C.releaseTitle,musicVideoType:(V=U)==null?void 0:V.musicVideoType,contentRating:{explicitType:(f=U)==null?void 0:f.explicitType},artistNames:((Y=U)==null?void 0:Y.byline)||((S=U)==null?void 0:S.channelName),downloadMetadata:g.pK(Q.videoId,"musicTrackDownloadMetadataEntity")}},Rxz=function(Q,U,q){var H,C,V,f,Y,S,
R,B,z,m,L,P,W,y,e,O,d,u;
return g.A(function(c){H=[];C=new Set;if((V=q)==null?0:(f=V.downloadedTracks)==null?0:f.length)for(Y=g.F(q.downloadedTracks),S=Y.next();!S.done;S=Y.next())R=S.value,C.add(R);if(Q.tracks){B=g.F(Q.tracks);for(z=B.next();!z.done;z=B.next())m=z.value,C.has(m)||H.push(m);L=g.F(U);for(P=L.next();!P.done;P=L.next())if(W=P.value,W.id!==Q.id&&(y=W.tracks))for(e=g.F(y),O=e.next();!O.done;O=e.next())d=O.value,u=H.indexOf(d),u!==-1&&H.splice(u,1)}return c.return(H)})},S3N=function(Q,U){var q,H,C,V,f,Y,S,R;
return g.A(function(B){q=Lm(Q.thumbnailDetails);H=g.F(U);for(C=H.next();!C.done;C=H.next())if(V=C.value,V.id!==Q.id)for(f=g.F(Lm(V.thumbnailDetails)),Y=f.next();!Y.done;Y=f.next())S=Y.value,R=q.indexOf(S),R!==-1&&q.splice(R,1);return B.return(q)})},LR8=function(Q,U){var q,H,C,V,f,Y,S,R,B;
return g.A(function(z){if(z.Z==1)return q=g.pK("music_downloads_library_id","musicDownloadsLibraryEntity"),g.G(z,jc(Q,q,"musicDownloadsLibraryEntity"),2);(H=z.C)||(H={id:q});C=g.cw(U).entityType;C==="musicTrack"?(V=H.downloadedTracks)!=null&&V.includes(U)||(H.downloadedTracks=((f=H.downloadedTracks)!=null?f:[]).concat(U)):C==="musicPlaylist"?(Y=H.downloadedPlaylists)!=null&&Y.includes(U)||(H.downloadedPlaylists=((S=H.downloadedPlaylists)!=null?S:[]).concat(U)):C!=="musicAlbumRelease"||(R=H.downloadedAlbumReleases)!=
null&&R.includes(U)||(H.downloadedAlbumReleases=((B=H.downloadedAlbumReleases)!=null?B:[]).concat(U));return g.G(z,xG(Q,H,"musicDownloadsLibraryEntity"),0)})},mjx=function(Q,U){var q,H,C,V,f,Y,S;
return g.A(function(R){if(R.Z==1)return q=g.pK("music_downloads_library_id","musicDownloadsLibraryEntity"),g.G(R,jc(Q,q,"musicDownloadsLibraryEntity"),2);H=R.C;if(!H)return R.gL(0);C=g.cw(U).entityType;C==="musicTrack"?V=H.downloadedTracks:C==="musicPlaylist"&&(V=H.downloadedPlaylists);if((f=V)==null?0:f.length)for(Y=0;Y<V.length;Y++)if(S=V[Y],S===U){V.splice(Y,1);break}return g.G(R,xG(Q,H,"musicDownloadsLibraryEntity"),0)})},P5$=function(Q){var U=Q.videos;
Q=[];var q=[];if(U){U=g.F(U);for(var H=U.next();!H.done;H=U.next()){var C=H.value.offlineVideoData.videoId;H=g.pK(C,"musicTrack");C=g.pK(C,"musicTrackDownloadMetadataEntity");Q.push(H);q.push(C)}}return{Ou:Q,cn:q}},Do=function(Q,U,q){U={track:zxA(U)};
q&&(U.playlistId=q);if(Q=g.K(Q.actionMetadata,wN8))U.maximumDownloadQuality=Q.maximumDownloadQuality;return{musicTrackEntityActionMetadata:U}},KRd=function(Q){var U,q,H,C,V,f,Y,S;
return g.A(function(R){switch(R.Z){case 1:return U=g.jU(),q=wYH(Q),H=g.QS(s3x),g.fx(R,2),V={Z8:!0},g.G(R,g.rk(U,q,H,void 0,V),4);case 4:C=R.C;g.Tt(R,3);break;case 2:f=g.Y8(R);if(f instanceof g.$z)throw Y="GetOffline network manager error: "+f.message,U$(Y,f),Error(Y);U$("GetOffline fetch request error",f);throw Error("GetOffline fetch request error");case 3:S=JT(C);if(!C)throw U$("Network request failed"),Error("Network request failed");if(S!==void 0)gX(S);else if(!C.videos||!C.videos.length)throw U$("No data"),
Error("No data");return R.return(C.videos.map(function(B){return B.offlineVideoData}))}})},hxJ=function(Q){var U,q,H,C,V,f,Y,S;
return g.A(function(R){switch(R.Z){case 1:return U=g.jU(),q=scz(Q),H=g.QS(s3x),g.fx(R,2),V={Z8:!0},g.G(R,g.rk(U,q,H,void 0,V),4);case 4:C=R.C;g.Tt(R,3);break;case 2:f=g.Y8(R);if(f instanceof g.$z)throw Y="GetOffline network manager error for playlist: "+f.message,U$(Y,f),Error(Y);U$("GetOffline fetch request error for playlist",f);throw Error("GetOffline fetch request error for playlist");case 3:S=JT(C);if(!C)throw U$("Network request failed for playlist"),Error("Network request failed for playlist");
if(S!==void 0)gX(S,"playlist");else if(!C.playlists||!C.playlists.length)throw U$("No data for playlist"),Error("No data for playlist");return R.return(C.playlists.map(function(B){return B.offlinePlaylistData}))}})},XNz=function(Q,U,q,H){var C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab;
return g.A(function(rK){switch(rK.Z){case 1:return g.G(rK,af(),2);case 2:C=rK.C;if(!C)return rK.return([]);V=[];if((f=H)==null?0:f.length){V=H;rK.gL(3);break}return g.G(rK,l2(C,"mainPlaylistEntity"),4);case 4:V=rK.C;case 3:if(!V.length)return rK.return([]);Y=[];S=Date.now()/1E3;R=g.F(V);B=R.next();case 5:if(B.done)return Y.length?g.G(rK,WR$(Y),10):rK.return([]);z=B.value;if(!z.downloadState){m=void 0;rK.gL(8);break}return g.G(rK,jc(C,z.downloadState,"mainPlaylistDownloadStateEntity"),9);case 9:m=
rK.C;case 8:L=m;P=void 0;y=(W=(P=z)==null?void 0:P.entityMetadata)&&W.nextAutoRefreshIntervalSeconds?Number(W.nextAutoRefreshIntervalSeconds):NaN;e=Number.isNaN(y)?Q:y;d=O=void 0;u=((O=L)==null?0:O.lastSyncedTimestampMillis)?Number((d=L)==null?void 0:d.lastSyncedTimestampMillis)/1E3:0;k=c=void 0;v=((c=L)==null?0:c.addedTimestampMillis)?Number((k=L)==null?void 0:k.addedTimestampMillis)/1E3:0;if(q||!W||u+e<=S){qH=[];Ho=void 0;if((Ho=z.videos)==null?0:Ho.length)for(ff=g.F(z.videos),Bo=ff.next();!Bo.done;Bo=
ff.next())Cf=Bo.value,Wo=JSON.parse(g.cw(Cf).entityId),Wo.videoId&&qH.push(Wo.videoId);vo="0";W&&(i$=void 0,vo=String(Number((i$=W.offlineLastModifiedTimestampSeconds)!=null?i$:0).toFixed()));ky={playlistId:z.playlistId,videoIds:qH,offlineLastModifiedTimestamp:vo,autoSync:U,offlineDateAddedTimestamp:String(v.toFixed())};Y.push(ky)}B=R.next();rK.gL(5);break;case 10:return ab=rK.C,rK.return(ab)}})},yez=function(){var Q,U,q,H,C;
return g.A(function(V){if(V.Z==1)return g.G(V,af(),2);if(V.Z!=3)return(Q=V.C)?g.G(V,l2(Q,"refresh"),3):V.return(!1);U=V.C;if((q=U[0])==null||!q.refreshTime)return V.return(!1);H=Number(U[0].refreshTime);C=Date.now()/1E3;return V.return(isFinite(H)&&C>=H)})},MRx=function(Q,U){var q,H,C;
return g.A(function(V){switch(V.Z){case 1:return g.fx(V,2),g.G(V,nuN(Q,U),4);case 4:return H=V.C,g.G(V,C5d(H),5);case 5:q=fWQ(H);g.Tt(V,3);break;case 2:C=g.Y8(V),U$("getAndProcessSmartDownloadsResponse request or processing error",C);case 3:return V.return(q)}})},Dj8=function(Q,U,q,H){var C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab;
return g.A(function(rK){switch(rK.Z){case 1:return g.G(rK,af(),2);case 2:C=rK.C;if(!C)return rK.return([]);V=[];if((f=H)==null?0:f.length){V=H;rK.gL(3);break}return g.G(rK,l2(C,"musicPlaylist"),4);case 4:V=rK.C;case 3:if(!V.length)return rK.return([]);Y=[];S=Date.now()/1E3;R=g.F(V);B=R.next();case 5:if(B.done)return Y.length?g.G(rK,WR$(Y),10):rK.return([]);z=B.value;m=void 0;P=(L=(m=z)==null?void 0:m.entityMetadata)&&L.nextAutoRefreshIntervalSeconds?Number(L.nextAutoRefreshIntervalSeconds):NaN;W=
Number.isNaN(P)?Q:P;e=y=0;O="DOWNLOAD_SYNC_STATE_UNKNOWN";if(!z.downloadMetadata){rK.gL(8);break}return g.G(rK,jc(C,z.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),9);case 9:d=rK.C,c=u=void 0,y=Number((c=(u=d)==null?void 0:u.addedTimestampMillis)!=null?c:"0")/1E3,v=k=void 0,e=Number((v=(k=d)==null?void 0:k.lastModifiedTimestampMillis)!=null?v:"0")/1E3,Ho=qH=void 0,O=(Ho=(qH=d)==null?void 0:qH.syncState)!=null?Ho:"DOWNLOAD_SYNC_STATE_UNKNOWN";case 8:ff=void 0;if(q||O!=="DOWNLOAD_SYNC_STATE_UP_TO_DATE"||
!L||Number((ff=L.lastSyncedTimestampSeconds)!=null?ff:0)+W<=S){Bo=[];Cf=void 0;if((Cf=z.tracks)==null?0:Cf.length)for(Wo=g.F(z.tracks),vo=Wo.next();!vo.done;vo=Wo.next())i$=vo.value,Bo.push(g.cw(i$).entityId);ky={playlistId:z.playlistId,videoIds:Bo,offlineLastModifiedTimestamp:String(e.toFixed()),autoSync:U,offlineDateAddedTimestamp:String(y.toFixed())};Y.push(ky)}B=R.next();rK.gL(5);break;case 10:return ab=rK.C,rK.return(ab)}})},nuN=function(Q,U){var q,H,C,V,f,Y,S,R,B,z;
return g.A(function(m){switch(m.Z){case 1:return q=g.jU(),g.G(m,af(),2);case 2:H=m.C;if(!H){m.gL(3);break}return g.G(m,MSQ(H),4);case 4:C=m.C;case 3:var L=C;V={context:g.a7(),browseId:"FEdownloads",browseRequestSupportedMetadata:{downloadsBrowseParams:{offlineFeatureSettingState:{isSdEnabled:Q},offlineClientState:L,clientStateRequestData:{preferredFormatType:U}}}};f=g.QS(JeN);g.fx(m,5);S={Z8:!0};return g.G(m,g.rk(q,V,f,void 0,S),7);case 7:Y=m.C;g.Tt(m,6);break;case 5:R=g.Y8(m);if(R instanceof g.$z)throw B=
"DPS network manager error for smart downloads: "+R.message,U$(B,R),Error(B);U$("DPS fetch request error for smart downloads",R);throw Error("DPS fetch request error for smart downloads");case 6:z=JT(Y);if(Y)z!==void 0&&gX(z,"smart downloads");else throw U$("Network request failed for smart downloads"),Error("Network request failed for smart downloads");return m.return(Y)}})},O_d=function(Q,U){var q,H,C,V,f,Y,S,R;
return g.A(function(B){switch(B.Z){case 1:return q=g.jU(),H={context:g.a7(),videoPlaybackPositionEntities:Q,lastSyncTimestampUsec:U},C=g.QS(gud),g.fx(B,2),f={Z8:!0},g.G(B,g.rk(q,H,C,void 0,f),4);case 4:V=B.C;g.Tt(B,3);break;case 2:Y=g.Y8(B);if(Y instanceof g.$z)throw S="VPPS network manager error: "+Y.message,U$(S,Y),Error(S);U$("VPPS fetch request error",Y);throw Error("VPPS fetch request error");case 3:R=JT(V);if(V)R!==void 0&&gX(R,"position sync");else throw U$("Network request failed for position sync"),
Error("Network request failed for position sync");return B.return(V)}})},ex$=function(Q,U,q){var H,C,V,f,Y,S,R,B;
return g.A(function(z){switch(z.Z){case 1:H=g.jU();var m=q.refreshData,L=q.isEnqueuedForExpiredStreamUrlRefetch,P=q.bO,W=q.offlineSourceData,y=q.mediaCapabilities,e={entityKey:Q};m&&(e.refreshData=m);L&&(e.isExpiredStreamUrlRefetch=L);P&&(e.downloadParameters=P);W&&(e.offlineSourceData=W);m={context:g.Y6(U),signatureTimestamp:20415,videos:[e]};y&&(m.mediaCapabilities=y);C=m;V=g.QS(FRA);g.fx(z,2);Y={Z8:!0};return g.G(z,g.rk(H,C,V,void 0,Y),4);case 4:f=z.C;g.Tt(z,3);break;case 2:S=g.Y8(z);if(S instanceof
g.$z)throw R="GetPDE network manager error: "+S.message,U$(R,S),Error(R);U$("GetPDE fetch request error",S);throw Error("GetPDE fetch request error");case 3:B=JT(f);if(f)B!==void 0&&gX(B,"PDE");else throw U$("Network request failed for PDE"),Error("Network request failed for PDE");return z.return(f)}})},JT=function(Q){var U;
return(U=Q.errorMetadata)==null?void 0:U.status},gX=function(Q,U){U=U?" for "+U:"";
if(Q===0)throw Q="Empty response body"+U,U$(Q),Error(Q);Q="Response with error"+U;U$(Q);throw Error(Q);},WR$=function(Q){var U,q,H,C,V,f,Y,S;
return g.A(function(R){switch(R.Z){case 1:return U=g.jU(),q=KW3(Q),H=g.QS(djd),g.fx(R,2),V={Z8:!0},g.G(R,g.rk(U,q,H,void 0,V),4);case 4:C=R.C;g.Tt(R,3);break;case 2:f=g.Y8(R);if(f instanceof g.$z)throw Y="offlinePlaylistSyncCheck network manager error: "+f.message,U$(Y,f),Error(Y);U$("offlinePlaylistSyncCheck fetch request error",f);throw Error("offlinePlaylistSyncCheck fetch request error");case 3:S=JT(C);if(!C)throw U$("Network request failed for playlist sync"),Error("Network request failed for playlist sync");
if(S!==void 0)gX(S,"playlist sync");else if(!C.offlinePlaylistSyncCheckDatas||!C.offlinePlaylistSyncCheckDatas.length)throw U$("No data for playlist sync"),Error("No data for playlist sync");return R.return(C.offlinePlaylistSyncCheckDatas.map(function(B){return B.offlinePlaylistSyncCheckData}))}})},O$=function(Q){this.Z=Q},GWt=function(Q,U){var q,H,C,V,f,Y;
return g.A(function(S){switch(S.Z){case 1:q=new Map,H=g.F(U),C=H.next();case 2:if(C.done){S.gL(4);break}V=C.value;f=q;Y=f.set;return g.G(S,Q.C(V),5);case 5:Y.call(f,V,S.C);C=H.next();S.gL(2);break;case 4:return S.return(q)}})},F2=function(Q,U,q,H,C,V){U=g.pK(U,q);
H=Object.assign({},V,{priority:H,retryScheduleIntervalsInSeconds:C});return{actionType:Q,entityKey:U,actionMetadata:H}},ew=function(Q,U,q,H,C,V){this.status=Q;
this.Z=U;this.X=q;this.C=H;this.T=C;this.downloadState=V},uVd=function(Q,U,q){this.Z=Q;
this.K=U;this.T=q},Eux=function(Q,U){var q,H,C,V,f,Y,S,R,B;
return g.A(function(z){switch(z.Z){case 1:return q=U.entityKey,C=(H=g.K(U.actionMetadata,dX))==null?void 0:H.isEnqueuedForExpiredStreamUrlRefetch,g.fx(z,2),V=void 0,g.G(z,reA(Q,U),4);case 4:V=z.C;g.fx(z,5);var m=(m=g.K(U.actionMetadata,dX))?{maximumDownloadQuality:m.maximumDownloadQuality}:void 0;return g.G(z,ex$(q,Q.K,{isEnqueuedForExpiredStreamUrlRefetch:C,bO:m,offlineSourceData:V}),7);case 7:f=z.C;g.Tt(z,6,2);break;case 5:return g.Y8(z,2),Y=or(U)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":
"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",U$("PDE handleAdd error"),z.return(Gw(U,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",Y,"DOWNLOAD_STATE_FAILED"));case 6:return g.G(z,Aex(Q,f,U),8);case 8:return z.return(Gw(U,!0,f.orchestrationActions));case 2:return S=g.Y8(z),R="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",B="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",S instanceof g.z$&&S.type==="QUOTA_EXCEEDED"&&(R="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
B="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),U$("PDE handleAdd error"),z.return(Gw(U,!1,void 0,R,B,"DOWNLOAD_STATE_FAILED"))}})},IWN=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho;
return g.A(function(ff){switch(ff.Z){case 1:return q=U.entityKey,H=g.cw(q).entityId,g.G(ff,tG(Q.Z,{mode:"readonly",zm:!0},function(Bo){var Cf=b2(Bo,q,"playbackData"),Wo=b2(Bo,g.pK(H,"offlineVideoPolicy"),"offlineVideoPolicy");Bo=b2(Bo,g.pK(H,"transfer"),"transfer");return g.hO.all([Cf,Wo,Bo])}),2);
case 2:C=ff.C;V=g.F(C);f=V.next().value;Y=V.next().value;S=V.next().value;R=f;B=Y;z=S;if(!R||!B)return ff.return(Gw(U,!0));m=[];W=((P=R)==null?0:P.playerResponseJson)?JSON.parse(R.playerResponseJson):null;if(!(z&&W&&Q.K.j("html5_refresh_deprecated_downloads"))){ff.gL(3);break}L=b_d(Q,W,z);return g.G(ff,kWN(Q,z),4);case 4:m=ff.C;case 3:y={lastPlayerResponseTimestampSeconds:R.playerResponseTimestamp,offlineToken:B.offlineToken,formatIds:m};e={};if((O=z)==null?0:O.maximumDownloadQuality)e.maximumDownloadQuality=
z.maximumDownloadQuality;g.fx(ff,5);d=void 0;return g.G(ff,reA(Q,U),7);case 7:return d=ff.C,g.fx(ff,8),g.G(ff,ex$(q,Q.K,{refreshData:y,bO:e,offlineSourceData:d,mediaCapabilities:L}),10);case 10:u=ff.C;g.Tt(ff,9,5);break;case 8:return g.Y8(ff,5),c=or(U)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",U$("PDE handleRefresh error"),ff.return(Gw(U,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",c,"DOWNLOAD_STATE_FAILED"));
case 9:return g.G(ff,Aex(Q,u,U),11);case 11:return ff.return(Gw(U,!0,u.orchestrationActions));case 5:return k=g.Y8(ff),v="PDE handleRefresh error",k instanceof Error&&(v="PDE handleRefresh error: "+k.message),qH="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Ho="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",k instanceof g.z$&&k.type==="QUOTA_EXCEEDED"&&(qH="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Ho="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),U$(v),ff.return(Gw(U,
!1,void 0,qH,Ho,"DOWNLOAD_STATE_FAILED"))}})},reA=function(Q,U){var q,H,C,V;
return g.A(function(f){if(f.Z==1)return q=g.cw(U.entityKey).entityId,H=g.pK(q,"videoDownloadContextEntity"),g.G(f,jc(Q.Z,H,"videoDownloadContextEntity"),2);C=f.C;return(V=C)!=null&&V.offlineModeType?f.return({offlineModeType:C.offlineModeType}):f.return(void 0)})},Aex=function(Q,U,q){var H,C,V,f,Y;
return g.A(function(S){if(S.Z==1){if(!U.frameworkUpdates||!g.K(U.frameworkUpdates,Wj))return S.return();if(!(g.K(U.frameworkUpdates,Wj).mutations&&g.K(U.frameworkUpdates,Wj).mutations.length>0&&g.K(U.frameworkUpdates,Wj).mutations[0].type==="ENTITY_MUTATION_TYPE_DELETE"))return S.gL(2);H=g.cw(g.K(U.frameworkUpdates,Wj).mutations[0].entityKey).entityId;return g.G(S,X2(Q.Z,H),3)}if(S.Z!=2){C=S.C;V=g.K(q.actionMetadata,dX);if(Y=(f=V)==null?void 0:f.playlistId)C.playlistId=Y;C.offlineDeleteReason="OFFLINE_DELETE_REASON_UNKNOWN";
return g.f8(Q.K)?g.G(S,hT(H,Q.Z,q,Q.T,C),2):g.r9(Q.K)?g.G(S,y8(H,Q.Z,q,Q.T),2):S.gL(2)}return g.G(S,Yiz(g.K(U.frameworkUpdates,Wj)),0)})},Gw=function(Q,U,q,H,C,V){return new ew(U?"OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS":"OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",or(Q),q,H,C,V)},b_d=function(Q,U,q){U=jcz(Q.K,q.cotn,U);
q=g.s9(U);return g.Tv4(U,q,Q.K)},kWN=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m;
return g.A(function(L){if(L.Z==1)return q=[],g.G(L,tG(Q.Z,{mode:"readonly",zm:!0},function(P){var W=[],y=U.offlineVideoStreams;if(y){y=g.F(y);for(var e=y.next();!e.done;e=y.next())W.push(b2(P,e.value,"offlineVideoStreams"))}return g.hO.all(W)}),2);
if(H=L.C)for(C=g.F(H),V=C.next();!V.done;V=C.next())if(f=V.value,Y=void 0,(Y=f)==null?0:Y.streamsProgress)for(S=f.streamsProgress,R=0;R<S.length;R++)B=S[R],z=JSON.parse(B.formatStreamBytes),m={itag:z.itag,lmt:z.lastModified,xtags:z.xtags},q.push(m);return L.return(q)})},cet=function(Q,U){this.Z=Q;
this.K=U},pNx=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L;
return g.A(function(P){switch(P.Z){case 1:return q=or(U),g.G(P,l2(Q.Z,"videoPlaybackPositionEntity"),2);case 2:H=P.C;if(H.length===0)return P.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));g.fx(P,3);return g.G(P,rn.getInstance(),5);case 5:C=P.C;if(!C)throw Error("prefStorage is undefined");return g.G(P,C.get("psi"),6);case 6:return V=P.C,S=(Y=(f=V)==null?void 0:f.G1)!=null?Y:"0",g.G(P,O_d(H,S),7);case 7:return R=P.C,B={isPaused:R.watchHistoryPaused,G1:R.syncTimestampUsec},g.G(P,C.set("psi",
B),8);case 8:if(B.isPaused){P.gL(9);break}z=g.K(R.frameworkUpdates,Wj);if(!R.frameworkUpdates||!z){P.gL(9);break}return g.G(P,Yiz(z),9);case 9:g.Tt(P,4);break;case 3:return m=g.Y8(P),L="PPE handleRefresh error: "+(m instanceof Error?m.message:"unknown error"),U$(L),P.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return P.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q))}})},$jH=function(Q,U){var q,H,C,V,f,Y,S,R;
return g.A(function(B){switch(B.Z){case 1:return q=or(U),H=g.cw(U.entityKey).entityId,g.fx(B,2),g.G(B,rn.getInstance(),4);case 4:C=B.C;if(!C)throw Error("prefStorage is undefined");return g.G(B,C.get("psi"),5);case 5:V=B.C;f=g.K(U.actionMetadata,NyN);if(((Y=V)==null?void 0:Y.isPaused)!==!1||(S=f)==null||!S.lastPlaybackPositionSeconds){B.gL(6);break}R={key:g.pK(H,"videoPlaybackPositionEntity"),videoId:H,lastPlaybackPositionSeconds:f.lastPlaybackPositionSeconds};return g.G(B,xG(Q.Z,R,"videoPlaybackPositionEntity"),
6);case 6:g.Tt(B,3);break;case 2:return g.Y8(B),B.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return B.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q))}})},tRt=function(Q,U){var q,H,C;
return g.A(function(V){switch(V.Z){case 1:q=or(U);g.fx(V,2);H=g.cw(U.entityKey).entityId;if(H==="!*$_ALL_ENTITIES_!*$")return g.G(V,VS7(Q.Z),5);C=g.pK(H,"videoPlaybackPositionEntity");return g.G(V,C_N(Q.Z,C),5);case 5:g.Tt(V,3);break;case 2:return g.Y8(V),V.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return V.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q))}})},xjz=function(Q,U){this.api=Q;
this.Z=U;this.logger=new g.hE("woffle");this.C=!1;this.L_={DA:this.DA}},j3d=function(Q){return g.A(function(U){return U.return(P_z(Q))})},lWx=function(Q){var U;
return g.A(function(q){if(q.Z==1)return g.G(q,g.KOo(Q),2);U=q.C;return q.return(U.filter(function(H){return!!H.url}).map(function(H){return H.url}))})},ut=function(Q,U){var q=g.c2(U);
if(q===1||q===0)return Promise.resolve();(q=aWd(Q,U))&&q.stopVideo();Q.T=0;return j3d(U)},rX=function(Q,U,q,H){q=q===void 0?!1:q;
H=H===void 0?!0:H;U=typeof U==="string"?U:U.videoDetails.videoId;if(g.c2(U)===2){var C=aWd(Q,U);C&&C.stopVideo();g.p8(U,2);Q.T=2;q?Z_d(Q.Z):H&&vuQ(Q.Z)}},aWd=function(Q,U){var q;
return((q=Q.player)==null?void 0:q.getVideoData().videoId)===U?Q.player:null},QBd=function(Q,U){this.Z=Q;
this.K=U},qc3=function(Q,U){var q,H;
return g.A(function(C){switch(C.Z){case 1:return q=or(U),g.G(C,jc(Q.Z,U.entityKey,"transfer"),2);case 2:if(H=C.C)return C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));g.fx(C,3);return g.G(C,U_$(Q,U),5);case 5:g.Tt(C,4);break;case 3:return g.Y8(C),C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q))}})},H1d=function(Q,U){var q,H;
return g.A(function(C){switch(C.Z){case 1:return q=or(U),g.G(C,jc(Q.Z,U.entityKey,"transfer"),2);case 2:H=C.C;if(!H||H.transferState!=="TRANSFER_STATE_COMPLETE")return C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));g.fx(C,3);return g.G(C,U_$(Q,U,!0),5);case 5:g.Tt(C,4);break;case 3:return g.Y8(C),C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));
case 4:return C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q))}})},Cv$=function(Q,U){var q,H,C,V,f,Y,S,R,B,z;
return g.A(function(m){switch(m.Z){case 1:return q=or(U),H=g.cw(U.entityKey).entityId,g.G(m,tG(Q.Z,{mode:"readonly",zm:!0},function(L){var P=b2(L,U.entityKey,"transfer");L=b2(L,g.pK(H,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.hO.all([P,L])}),2);
case 2:C=m.C;V=g.F(C);f=V.next().value;Y=V.next().value;S=f;R=Y;if(!S||S.transferState!=="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH")return m.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));g.fx(m,3);S.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE";return g.G(m,xG(Q.Z,S,"transfer"),5);case 5:B=g.cw(S.key).entityId;ci3({videoId:B,QH:S,offlineModeType:(z=R)==null?void 0:z.offlineModeType});g.Tt(m,4);break;case 3:return g.Y8(m),m.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",
q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return m.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q))}})},U_$=function(Q,U,q){q=q===void 0?!1:q;
var H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e;return g.A(function(O){switch(O.Z){case 1:return H=g.K(U.actionMetadata,VkJ),C=g.cw(U.entityKey).entityId,V=g.pK(C,"downloadStatusEntity"),g.G(O,tG(Q.Z,{mode:"readonly",zm:!0},function(d){var u=b2(d,V,"downloadStatusEntity");d=b2(d,g.pK(C,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.hO.all([u,d])}),2);
case 2:return f=O.C,Y=g.F(f),S=Y.next().value,R=Y.next().value,B=S,z=R,m="TRANSFER_STATE_TRANSFER_IN_QUEUE",((L=B)==null?void 0:L.downloadState)==="DOWNLOAD_STATE_USER_DELETED"&&(m="TRANSFER_STATE_PAUSED_BY_USER"),y={key:U.entityKey,transferState:m,cotn:g.LA(16),enqueuedTimestampMs:Date.now().toString(),maximumDownloadQuality:(P=H)==null?void 0:P.maximumDownloadQuality,preferredAudioTrack:(W=H)==null?void 0:W.preferredAudioTrack,transferRetryCount:0,isRefresh:q,hasLoggedFirstStarted:!1},g.G(O,tG(Q.Z,
{mode:"readwrite",zm:!0},function(d){var u=[];q&&u.push(ps(d,g.pK(C,"offlineVideoStreams")));u.push(c8(d,y,"transfer"));return g.hO.all(u)}),3);
case 3:if(!q){O.gL(4);break}return g.G(O,j3d(C),4);case 4:kx7({videoId:C,QH:y,offlineModeType:(e=z)==null?void 0:e.offlineModeType}),g.Cx(O)}})},o5J=function(Q,U,q,H){if(!Q.action.entityKey)throw Error("entityKey is missing.");
var C=g.cw(Q.action.entityKey);C={entityType:C.wO,entityId:C.entityId,offlineOrchestrationActionType:Q.action.actionType,orchestrationAction:{orchestrationActionId:Q.actionId}};U&&(C.offlineOrchestrationActionResult=U.status,C.isRetryable=q?!1:U.Z,U.T&&(C.offlineOrchestrationFailureReason=fEA(U.T,C.isRetryable)));var V,f;if((V=Q.action.actionMetadata)==null?0:(f=V.offlineLoggingData)==null?0:f.offlineModeType)C.offlineModeType=Q.action.actionMetadata.offlineLoggingData.offlineModeType;H&&(C.additionalOrchestrationActions=
H.map(function(Y){return{orchestrationActionId:Y.actionId}}));
return C},fEA=function(Q,U){return Q!=="OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR"||U?Q==="OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"&&U?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":Q:"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"},i1z=function(Q,U){var q={offlineOrchestrationContext:o5J(Q)};
U=yix(U,q);njN(XY7(),U,Q.rootActionId)},Txx=function(Q,U,q,H){H=H===void 0?[]:H;
U={offlineOrchestrationContext:o5J(Q,U,q,H)};U=yix(3,U);njN(XY7(),U,Q.rootActionId)},YcN=function(){this.actions=[]},Scx=function(Q,U){U=g.F(U);
for(var q=U.next();!q.done;q=U.next())q=q.value,i1z(q,1),Q.actions.push(q);Q.actions.sort(Q.Z)},RoA=function(Q,U){if(U)for(var q=0;q<Q.actions.length;q++)if(U==="!*$_ALL_ENTITIES_!*$"&&Q.actions[q].actionId!==U||U!=="!*$_ALL_ENTITIES_!*$"&&Q.actions[q].rootActionId===U&&Q.actions[q].actionId!==U)Q.actions.splice(q,1),q--},Bx3=function(Q,U){Q=g.F(Q.actions);
for(var q=Q.next();!q.done;q=Q.next())if(q.value.actionId===U)return!0;return!1},AT=function(Q,U,q,H,C){g.b.call(this);
var V=this;this.C=Q;this.hG=U;this.ZE=q;this.B=H;this.K=C;this.Z=new YcN;this.U=new g.pI;this.T=new g.ai(function(){V.retry()});
this.L=NaN;this.J=!1;this.L_={oo2:function(){return V.Z},
MP:function(){return V.U},
abD:function(){return V.T},
retry:function(){return V.retry()}};
g.I(this,this.T);this.u2=this.C.observe(this.AG.bind(this))},m_z=function(Q,U,q,H,C){var V;
return g.A(function(f){if(f.Z==1)return V=new AT(Q,U,q,H,C),g.G(f,zo3(V),2);L9$(V);return f.return(V)})},L9$=function(Q){var U=Q.Z.actions[0];
return Q.X?((U==null?void 0:U.action.actionType)==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&Q.X[0].action.actionType!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(Q.J=!0),Promise.resolve()):PvQ(Q)},PvQ=function(Q){var U,q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e;
return g.A(function(O){switch(O.Z){case 1:if(Q.X)throw Error("Already processing an action");if(Q.GC())return O.return();U=Q.Z.actions.shift();EjH(Q.ZE,!U);if(U===void 0)return O.return();U.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&U.actionId==="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS"&&RoA(Q.Z,U.actionId);q="";U.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&U.rootActionId===U.actionId&&(q=U.actionId);H=[U];Q.X=H;if(C=Q.hG[U.entityType]){O.gL(2);break}Q.X=
void 0;return g.G(O,PvQ(Q),3);case 3:return O.return();case 2:V=g.F(H);for(f=V.next();!f.done;f=V.next())Y=f.value,i1z(Y,2);g.fx(O,4,5);return g.G(O,GWt(C,H.map(function(d){return d.action})),7);
case 7:S=O.C,R=g.F(H),B=R.next();case 8:if(B.done){O.gL(10);break}z=B.value;m=S.get(z.action);return g.G(O,wVH(Q,z,m),9);case 9:B=R.next();O.gL(8);break;case 10:RoA(Q.Z,q);case 5:g.S3(O);Q.X=void 0;g.Rd(O,6);break;case 4:return L=g.Y8(O),U$("Orchestration error",L),g.fx(O,12),g.G(O,sB$(Q,H),14);case 14:g.Tt(O,5);break;case 12:P=g.Y8(O);U$("Orchestration retry error",P);W=g.F(H);for(y=W.next();!y.done;y=W.next())e=y.value,e.retryScheduleIndex<3&&Scx(Q.Z,[e]);O.gL(5);break;case 6:return g.G(O,PvQ(Q),
0)}})},wVH=function(Q,U,q){var H,C,V,f,Y,S,R,B,z,m,L,P;
return g.A(function(W){switch(W.Z){case 1:H=U.retryScheduleIndex+2===3;if(q.status==="OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS"){W.gL(2);break}if(q.status!=="OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE"){W.gL(0);break}Txx(U,q,H);if(q.Z&&U.retryScheduleIndex+1<3)return g.G(W,sB$(Q,[U]),0);V=((C=q)==null?0:C.C)?q.C:"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN";f={entityKey:U.action.entityKey,failureReason:V};Y=void 0;g.f8(Q.K)?Y="mainVideoDownloadStateEntity":g.r9(Q.K)&&(Y="musicTrackDownloadMetadataEntity");
if(!Y||!q.downloadState){W.gL(7);break}S=g.cw(U.action.entityKey).entityId;return g.G(W,Rr(S,Y,Q.C,q.downloadState),7);case 7:Hj(Q.B,f);if(q.downloadState==="DOWNLOAD_STATE_FAILED"&&Q.K.j("html5_auto_retry_failed_pde_actions")){W.gL(0);break}U$("Orchestration result is not retryable, deleting action");return g.G(W,C_N(Q.C,wX(U).key),0);case 2:R=void 0;try{R=(B=q.X)==null?void 0:B.map(function(y){return Q.createAction(y,U)})}catch(y){return Txx(U,q,H),z={entityKey:U.action.entityKey,
failureReason:"OFFLINE_OPERATION_FAILURE_REASON_UNSUPPORTED_ENTITY_FAILED"},Hj(Q.B,z),U$("Orchestration subactions creation error",y),W.return()}Txx(U,q,H,R);if(!R){W.gL(12);break}m=R.map(function(y){return wX(y)});
L=0;case 13:if(!(L<R.length)||Q.J){W.gL(15);break}return g.G(W,tG(Q.C,{mode:"readwrite",zm:!0},function(y){var e=[];e.push(xKN(y,m.slice(L,L+10),"offlineOrchestrationActionWrapperEntity"));return g.hO.all(e)}),16);
case 16:L+=10;W.gL(13);break;case 15:if(Q.J)return Q.J=!1,W.return();case 12:return P=wX(U),g.G(W,C_N(Q.C,P.key),17);case 17:i1z(U,4),g.Cx(W)}})},XVN=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L;
return g.A(function(P){q=[];H=Infinity;C=4E3;V=g.F(U);for(f=V.next();!f.done;f=V.next())Y=f.value,S=Number(Y.enqueueTimeSec),R=K9d(S),B=Y.retryScheduleIndex,z=B!=null&&B>0,R>0&&z?(H=Math.min(H,S),C=Math.min(R,C)):q.push(Y);isFinite(H)&&(!Q.T.isActive()||H<Q.L)&&(Q.L=H,Q.T.start(C));Q.U.dj()||(m=q.length,q=q.filter(function(W){var y;W=((y=W.actionProto)==null?void 0:y.actionType)||"OFFLINE_ORCHESTRATION_ACTION_TYPE_UNKNOWN";return!hot.includes(W)}),L=q.length<m,!Q.T.isActive()&&L&&Q.T.start(1));
q.length>0&&W9H(Q,q);return g.G(P,L9$(Q),0)})},n5z=function(Q){var U,q,H,C,V,f,Y;
return g.A(function(S){if(S.Z==1)return g.G(S,yZ7(Q),2);U=S.C;q=[];H=g.F(U);for(C=H.next();!C.done;C=H.next())V=C.value,f=g.cw(V.key),Y=f.entityId,Bx3(Q.Z,Y)||q.push(V);return g.G(S,XVN(Q,q),0)})},K9d=function(Q){Q=Q*1E3-Date.now();
return Q>4E3?4E3:Q},sB$=function(Q,U){var q,H,C;
return g.A(function(V){q=g.F(U);for(H=q.next();!H.done;H=q.next()){C=H.value;var f=void 0,Y=void 0,S=((Y=C.action)==null?void 0:(f=Y.actionMetadata)==null?void 0:f.retryScheduleIntervalsInSeconds)||[1,2,4];f=1;C.retryScheduleIndex<S.length&&(f=S[C.retryScheduleIndex]);C.Z=f*1E3+Date.now();C.retryScheduleIndex++}return g.G(V,MkQ(Q,U),0)})},zo3=function(Q){var U;
return g.A(function(q){if(q.Z==1)return g.G(q,l2(Q.C,"offlineOrchestrationActionWrapperEntity"),2);U=q.C;return g.G(q,XVN(Q,U),0)})},W9H=function(Q,U){U.length!==0&&U.forEach(function(q){q=Pj(q);
q.retryScheduleIndex<3&&Scx(Q.Z,[q])})},yZ7=function(Q,U){var q;
return g.A(function(H){if(H.Z==1)return g.G(H,l2(Q.C,"offlineOrchestrationActionWrapperEntity",U),2);q=H.C;return H.return(q.filter(Si7))})},MkQ=function(Q,U){if(U.length===0)return Promise.resolve([]);
U=U.map(function(q){return wX(q)});
return HZ7(Q.C,U)},D_J=function(Q){this.o7=Q;
this.Z=void 0},JZd=function(Q,U){var q,H,C,V;
return g.A(function(f){q=U.videoId;H=!0;if(U.captionTracks.length)C=AY$(U),Q.Z=new g.BU(Q.o7,U,C);else if(U.UP)V=g.dW6(U),Q.Z=new g.LJ(Q.o7,U.UP,q,V,U.YP,U.eventId),H=U.YP;else return f.return();return f.return(new Promise(function(Y){var S;(S=Q.Z)==null||S.tS({bv:function(){return g.A(function(R){if(R.Z==1)return g.G(R,Q.bv(q,H),2);Y();g.Cx(R)})},
Oe:function(){}})}))})},g57=function(Q){var U;
return g.A(function(q){if(q.Z==1)return g.G(q,m5z(Q),2);U=q.C;return q.return(!!U&&U.length>0)})},E$=function(Q){g.b.call(this);
this.Z=Q;this.C=this.Z.observe(this.T.bind(this))},O1z=function(Q,U){var q,H,C,V,f,Y,S;
return g.A(function(R){switch(R.Z){case 1:if(U.length===0)return R.return([]);q=U.map(function(B){return g.pK(B,"transfer")});
return g.G(R,l2(Q.Z,"transfer",q),2);case 2:H=R.C;C=H.filter(Si7).map(function(B){return g.cw(B.key).entityId});
V=U.filter(function(B){return C.indexOf(B)===-1});
if(V.length===0)return R.return([]);f=g.F(V);Y=f.next();case 3:if(Y.done){R.gL(5);break}S=Y.value;return g.G(R,j3d(S),4);case 4:Y=f.next();R.gL(3);break;case 5:return R.return(V)}})},d_Q=function(Q,U,q,H,C,V){var f,Y,S;
return g.A(function(R){f="STREAM_TYPE_UNKNOWN";q.video&&q.audio?(f="STREAM_TYPE_AUDIO_AND_VIDEO",U$("unexpected stream type")):q.video&&!q.audio?f="STREAM_TYPE_VIDEO":!q.video&&q.audio&&(f="STREAM_TYPE_AUDIO");Y=g.pK(U,"offlineVideoStreams");S={numBytesDownloaded:C.toFixed(),numTotalBytes:V.toFixed(),streamType:f,streamState:"DOWNLOAD_STREAM_STATE_IN_PROGRESS",formatStreamBytes:JSON.stringify(H),itag:f==="STREAM_TYPE_AUDIO_AND_VIDEO"?Number(q.itag):void 0};return g.G(R,tG(Q,{mode:"readwrite",zm:!0},
function(B){var z=b2(B,Y,"offlineVideoStreams"),m=b2(B,g.pK(U,"transfer"),"transfer");return g.hO.all([z,m]).then(function(L){L=g.F(L);var P=L.next().value;L=L.next().value;if(!L)return ps(B,Y).then(function(){});
var W=F93(P);P=eoN(P,H,S,Y);var y=c8(B,P,"offlineVideoStreams");F93(P)>W&&(L.lastProgressTimeMs=Date.now().toString());W=[y];L.offlineVideoStreams||(L.offlineVideoStreams=[]);L.offlineVideoStreams.indexOf(Y)===-1&&(L.offlineVideoStreams.push(Y),W.push(c8(B,L,"transfer")));return g.hO.all(W)})}),0)})},G9J=function(Q,U){var q,H,C,V,f;
return g.A(function(Y){if(Y.Z==1)return q=g.pK(U,"offlineVideoStreams"),g.G(Y,jc(Q,q,"offlineVideoStreams"),2);H=Y.C;if(!H||!H.streamsProgress)return Y.return();C=g.F(H.streamsProgress);for(V=C.next();!V.done;V=C.next())f=V.value,f.streamState="DOWNLOAD_STREAM_STATE_COMPLETE",f.numTotalBytes!==f.numBytesDownloaded&&(f.numBytesDownloaded=f.numTotalBytes);return g.G(Y,xG(Q,H,"offlineVideoStreams"),0)})},eoN=function(Q,U,q,H){if(Q&&Q.streamsProgress){H=Q;
a:{U=U.itag+";"+U.xtags;for(var C=Q.streamsProgress,V=0;V<C.length;V++){var f=JSON.parse(C[V].formatStreamBytes);if(f.itag+";"+f.xtags===U){C[V]=q;q=C;break a}}C.push(q);q=C}H.streamsProgress=q}else Q={key:H,streamsProgress:[q]};return Q},F93=function(Q){if(Q==null?0:Q.streamsProgress){var U=0;
Q=Q.streamsProgress;for(var q=0;q<Q.length;q++){var H=Q[q];isNaN(Number(H.numBytesDownloaded))?U$("stream progress bytes number invalid"):U+=Number(H.numBytesDownloaded)}return U}return 0},uj$=function(Q,U,q,H){g.b.call(this);
var C=this;this.C=Q;this.api=U;this.UA=q;this.AG=H;this.U=new g.pI;this.X=new g.ai(function(){C.Z&&C.Z.transferState==="TRANSFER_STATE_TRANSFERRING"&&C.U.dj()&&((C.Z.transferRetryCount||0)<3?rX(C.B,C.J,!1,!1):ut(C.B,C.J.videoDetails.videoId),C.Xw("TRANSFER_FAILURE_REASON_TIMEOUT_NO_PROGRESS"))});
this.ZE=this.XZ=0;this.u2=this.L=!1;this.zC=g.lK(this.api.Y().experiments,"html5_transfer_processing_logs_interval");this.I7=new g.Sf(this);this.L_={wu2:function(){return C.X},
HbD:function(){return C.AG},
MP:function(){return C.U}};
this.hG=this.C.observe(this.My.bind(this));this.B=new xjz(U,this);this.DE=new D_J(U);this.Ha=new E$(this.C);this.JG=this.U.listen("publicytnetworkstatus-online",this.jL.bind(this));this.x5=this.U.listen("publicytnetworkstatus-offline",this.T_7.bind(this));this.u2=this.api.Y().j("html5_less_transfer_processing_logs");g.I(this,this.I7);this.I7.V(U,"offlinetransferpause",this.mhA);if(g.f8(this.api.Y()))this.T="mainVideoDownloadStateEntity";else if(g.r9(this.api.Y())||g.ij(this.api.Y()))this.T="musicTrackDownloadMetadataEntity"},
rZ7=function(Q){return g.A(function(U){if(U.Z==1)U=g.G(U,zR8(),2);
else{var q=Q.Ha;var H=g.It();H=Object.keys(H);q=O1z(q,H);U=g.G(U,q,0)}return U})},k7=function(Q,U){U=U===void 0?!1:U;
var q;return g.A(function(H){if(H.Z==1){if(Q.Z)throw Error("Already downloading a video");Q.ZE=0;Q.L=!1;return g.G(H,AZH(Q),2)}return H.Z!=4?(q=H.C,bZJ(Q.UA,!q),q&&Q.U.dj()?U?g.G(H,new Promise(function(C){g.sz(C,1E3)}),4):H.gL(4):(!q&&Q.Z&&bt(Q),H.gL(0))):g.G(H,E53(Q,q),0)})},b1t=function(Q){return g.A(function(U){if(U.Z==1)return Q.J?g.G(U,ut(Q.B,Q.J.videoDetails.videoId),3):U.gL(0);
bt(Q);g.Cx(U)})},k9z=function(Q,U){var q,H,C;
return g.A(function(V){switch(V.Z){case 1:return g.fx(V,2),(q=!!U.captionTracks.length||!!U.UP)?g.G(V,g57(U.videoId),4):V.return();case 4:return(H=V.C)?V.return():g.G(V,JZd(Q.DE,U),5);case 5:g.Tt(V,0);break;case 2:C=g.Y8(V),U$("Caption downloading error",C,U.cotn),g.Cx(V)}})},E53=function(Q,U){var q,H,C,V,f,Y;
return g.A(function(S){switch(S.Z){case 1:if(Q.L)return S.return();Q.L=!0;Q.Z=U;q=g.cw(Q.Z.key);H=q.entityId;C=void 0;if(Q.Z.transferState==="TRANSFER_STATE_TRANSFERRING")return g.G(S,Ir(Q,H),7);if(Q.Z.transferState!=="TRANSFER_STATE_TRANSFER_IN_QUEUE"||Q.Z.transferRetryCount||Q.Z.hasLoggedFirstStarted){S.gL(3);break}return g.G(S,Ir(Q,H),5);case 5:return C=S.C,Q.Z.hasLoggedFirstStarted=!0,g.G(S,IEQ(Q),6);case 6:Izt({videoId:H,QH:Q.Z,offlineModeType:C},void 0,void 0,!0);S.gL(3);break;case 7:C=S.C,
fm({transferStatusType:"TRANSFER_STATUS_TYPE_RESUME_PROCESSING",statusType:"OFFLINING_RETRIED"},{videoId:H,QH:Q.Z,offlineModeType:C});case 3:return g.G(S,cZA(Q),8);case 8:return V=null,g.fx(S,9),g.G(S,pVQ(Q,U),11);case 11:V=S.C;Q.J=V;g.Tt(S,10);break;case 9:return f=g.Y8(S),U$("error getting player response",f,U.cotn),g.G(S,Q.Xw("TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING"),12);case 12:return S.return();case 10:return Y=jcz(Q.api.Y(),U.cotn,V),g.G(S,k9z(Q,Y),13);case 13:return g.G(S,lWx(Y.videoId),
14);case 14:Y.Er=S.C;var R=Q.B,B=Y,z=U.maximumDownloadQuality;B.getPlayerResponse();g.p8(B.videoId,2);R.T=2;R.C=!1;var m;(m=R.player)==null||m.dispose();R.player=R.api.Ft(B);B={};R.player.xU((B.localmediachange=R.mz,B.signatureexpired=R.Jm,B.statechange=R.o$p,B),R);R.j("html5_generate_content_po_token")&&R.player.MV();z=R.DA(z);R.player.N_(g.G_(z,z,!0,"m"),!1);R.player.Tv(!1);Q.X.start(108E5);g.Cx(S)}})},AZH=function(Q){var U,q;
return g.A(function(H){if(H.Z==1)return g.G(H,l2(Q.C,"transfer"),2);U=H.C;q=U.filter(Nx$).sort($_Q);return q.length===0?H.return():H.return(q[0])})},cZA=function(Q){var U,q,H;
return g.A(function(C){if(C.Z==1){if(!Q.Z)return cj(Q,"onTransferStart"),C.return();Q.X.start(108E5);return g.G(C,pm(Q,"TRANSFER_STATE_TRANSFERRING"),2)}U=Q.Z;return(H=((q=U)==null?0:q.key)?g.cw(U.key).entityId:"")&&Q.T?g.G(C,Rr(H,Q.T,Q.C,"DOWNLOAD_STATE_DOWNLOAD_IN_PROGRESS"),0):C.gL(0)})},Z_d=function(Q){var U,q,H,C;
g.A(function(V){switch(V.Z){case 1:if(!Q.Z){cj(Q,"onTransferPausedByUser");V.gL(2);break}U=Q.Z;Q.X.stop();return g.G(V,pm(Q,"TRANSFER_STATE_PAUSED_BY_USER"),3);case 3:H=((q=U)==null?0:q.key)?g.cw(U.key).entityId:"";if(!H||!Q.T){V.gL(4);break}return g.G(V,Rr(H,Q.T,Q.C,"DOWNLOAD_STATE_PAUSED"),4);case 4:return g.G(V,Ir(Q,H),6);case 6:C=V.C,pYH({videoId:H,QH:U,offlineModeType:C});case 2:bt(Q),k7(Q),g.Cx(V)}})},vuQ=function(Q){var U,q,H;
g.A(function(C){if(C.Z==1){if(!Q.Z)return cj(Q,"onTransferPausedByNetwork"),C.return();Q.X.stop();return g.G(C,pm(Q,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),2)}if(C.Z!=3)return U=Q.Z,(H=((q=U)==null?0:q.key)?g.cw(U.key).entityId:"")&&Q.T?g.G(C,Rr(H,Q.T,Q.C,"DOWNLOAD_STATE_PAUSED"),3):C.gL(3);bt(Q);g.Cx(C)})},tkN=function(Q){var U,q,H,C,V;
g.A(function(f){switch(f.Z){case 1:if(!Q.Z)return cj(Q,"onTransferComplete"),f.return();U=Q.Z;Q.X.stop();if(!U||!Q.J){f.gL(2);break}q=jcz(Q.api.Y(),U.cotn,Q.J);return g.G(f,k9z(Q,q),2);case 2:return g.G(f,pm(Q,"TRANSFER_STATE_COMPLETE","DOWNLOAD_STREAM_STATE_COMPLETE"),4);case 4:C=((H=U)==null?0:H.key)?g.cw(U.key).entityId:"";if(!C||!Q.T){f.gL(5);break}return g.G(f,Rr(C,Q.T,Q.C,"DOWNLOAD_STATE_COMPLETE"),5);case 5:return g.G(f,G9J(Q.C,C),7);case 7:return g.G(f,Ir(Q,C),8);case 8:V=f.C,fm({transferStatusType:"TRANSFER_STATUS_TYPE_COMPLETED",
statusType:"SUCCESS"},{videoId:C,QH:U,offlineModeType:V}),bt(Q),k7(Q),g.Cx(f)}})},x_d=function(Q,U,q){var H,C;
g.A(function(V){switch(V.Z){case 1:if(!Q.Z)return cj(Q,"onTransferProgress: "+U),V.return();if(Q.Z.transferState==="TRANSFER_STATE_TRANSFERRING"){V.gL(2);break}return g.G(V,cZA(Q),2);case 2:H=Date.now();if(!(H-Q.XZ>1E3)){V.gL(4);break}Q.XZ=H;return g.G(V,d_Q(Q.C,q.videoId,q.C,q.Jj,q.bytesDownloaded,q.Z),5);case 5:if(Q.u2&&!(Q.u2&&H-Q.ZE>Q.zC)){V.gL(4);break}Q.ZE=H;return g.G(V,Ir(Q,U),7);case 7:C=V.C,Izt({videoId:U,QH:Q.Z,offlineModeType:C},q.bytesDownloaded,q.Z);case 4:Q.X.start(108E5),g.Cx(V)}})},
jBz=function(Q){var U=(Q.Z.transferRetryCount||0)<3;
U&&(Q=Q.Z,Q.transferRetryCount=(Q.transferRetryCount||0)+1);return U},lEt=function(Q,U){U=U===void 0?"TRANSFER_FAILURE_REASON_UNKNOWN":U;
var q,H,C,V;return g.A(function(f){if(f.Z==1)return Q.Z||cj(Q,"setTransferToFailed: "+U),q="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",U==="TRANSFER_FAILURE_REASON_NETWORK"?q="OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED":U==="TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"&&(q="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED"),g.G(f,pm(Q,"TRANSFER_STATE_FAILED","DOWNLOAD_STREAM_STATE_ERROR_STREAMS_MISSING",U),2);if(f.Z!=3)return Hj(Q.AG,{entityKey:(H=Q.Z)==null?void 0:H.key,failureReason:q}),
C=Q.Z?g.cw(Q.Z.key).entityId:"",g.G(f,Ir(Q,C),3);V=f.C;var Y={videoId:C,QH:Q.Z,offlineModeType:V},S=U,R={transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_WITH_FAILURE",statusType:"FAILED"};S&&(R.transferFailureReason=S,R.failureReason=NB7(S));fm(R,Y);g.Cx(f)})},pm=function(Q,U,q,H){var C;
return g.A(function(V){if(V.Z==1){if(!Q.Z)return cj(Q,"saveTransferState: "+U),V.return();Q.Z.transferState=U;Q.Z.failureReason=H;g.fx(V,2);return g.G(V,IEQ(Q,function(f){return q?kG(f,"offlineVideoStreams",Q.Z.offlineVideoStreams).then(function(Y){for(var S=g.F(Y),R=S.next();!R.done;R=S.next())if((R=R.value)&&R.streamsProgress){R=g.F(R.streamsProgress);for(var B=R.next();!B.done;B=R.next())B.value.streamState=q}return xKN(f,Y.filter(function(z){return!!z}),"offlineVideoStreams")}):g.hO.resolve(void 0)}),
4)}if(V.Z!=2)return g.Tt(V,0);
C=g.Y8(V);return C instanceof g.z$&&C.type==="QUOTA_EXCEEDED"?g.G(V,Q.Xw("TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"),0):V.gL(0)})},IEQ=function(Q,U){var q;
return g.A(function(H){if(!Q.Z)return H.return();q=Q.Z;return g.G(H,tG(Q.C,{mode:"readwrite",zm:!0},function(C){var V=[c8(C,q,"transfer")];U&&V.push(U(C));return g.hO.all(V)}),0)})},bt=function(Q){Q.Z=void 0;
Q.J=void 0;Q.X.stop()},pVQ=function(Q,U){var q,H,C,V,f;
return g.A(function(Y){if(Y.Z==1)return q=g.cw(U.key),H=q.entityId,C=g.pK(H,"playbackData"),g.G(Y,jc(Q.C,C,"playbackData"),2);V=Y.C;if((f=V)==null?0:f.playerResponseJson)return Y.return(JSON.parse(V.playerResponseJson));throw Error("No PlayerResponse found");})},cj=function(Q,U){Q.api.rL("woffle",{mcte:U});
U$("missing current transfer entity.")},Ir=function(Q,U){var q,H,C;
return g.A(function(V){if(V.Z==1)return g.G(V,jc(Q.C,g.pK(U,"videoDownloadContextEntity"),"videoDownloadContextEntity"),2);q=V.C;return V.return((C=(H=q)==null?void 0:H.offlineModeType)!=null?C:void 0)})},Nx$=function(Q){return aEJ[Q.transferState]!==void 0},$_Q=function(Q,U){var q=aEJ[Q.transferState],H=aEJ[U.transferState];
return q!==H?q-H:Number(Q.enqueuedTimestampMs)-Number(U.enqueuedTimestampMs)},Nk=function(Q,U){var q=this;
this.K=Q;this.api=U;this.U=new g.pI;this.J=new g.Rx;this.L_={uT:function(){return q.T.L_.uT()},
MP:function(){return q.U},
yay:function(){return q.T},
Lz:function(){return q.Lz()},
tZ:function(){return q.tZ()},
iL:function(){return q.iL()},
kW:function(){return q.kW()},
wz:function(){return q.wz()},
sO:function(H){return q.sO(H)}};
this.T=new uCA(function(){return Z1z(q)},function(){q.iL()},this.api.sH(),this.api.j.bind(this.api));
this.Z=new qk(this.api);rit(this.T)},Z1z=function(Q){return g.A(function(U){Q.api.l2("onOrchestrationBecameLeader");
return g.G(U,Q.tZ(),0)})},QxQ=function(Q){var U,q;
return g.A(function(H){if(H.Z==1)return g.G(H,af(),2);if(H.Z!=3){U=H.C;if(!U)return U$("PES is undefined"),H.return();Q.C=new uj$(U,Q.api,Q.T,Q.Z);q=Q.EL(U);return g.G(H,m_z(U,q,Q.T,Q.Z,Q.K),3)}Q.B=H.C;return g.G(H,v5A(Q),0)})},v5A=function(Q){var U;
return g.A(function(q){switch(q.Z){case 1:if(!Q.C)return U$("transferManager is undefined"),q.return();if(Q.C.Z){q.gL(2);break}return g.G(q,k7(Q.C),2);case 2:if(!Q.K.j("woffle_enable_main_downloads_library")){q.gL(4);break}return g.G(q,Q.gY(),4);case 4:if(!Q.K.j("html5_offline_playback_position_sync")){q.gL(6);break}return g.G(q,Q.GK(),7);case 7:return g.G(q,Q.sO(864E5),6);case 6:return g.G(q,Q.refreshAllStaleEntities(43200,!0),9);case 9:return g.G(q,Q.v6(),10);case 10:if(!Q.K.j("html5_retry_downloads_for_expiration")){q.gL(11);
break}return g.G(q,Q.wz(),11);case 11:return Q.L=g.Kb(function(){Q.refreshAllStaleEntities(43200,!0);Q.v6()},9E5),g.vx(g.UD(),function(){return Q.kW()}),g.G(q,af(),13);
case 13:return U=q.C,g.G(q,Gxx(U),14);case 14:Aid(Q.T),g.Cx(q)}})},UXH=function(){var Q,U,q,H,C,V;
return g.A(function(f){switch(f.Z){case 1:return g.G(f,af(),2);case 2:Q=f.C;if(!Q)return f.return([]);U=Date.now()/1E3;return g.G(f,l2(Q,"offlineVideoPolicy"),3);case 3:q=f.C,H=g.F(q),C=H.next();case 4:if(C.done){f.gL(6);break}V=C.value;if(!(V.expirationTimestamp&&Number(V.expirationTimestamp)<U)){f.gL(5);break}V.action="OFFLINE_VIDEO_POLICY_ACTION_DISABLE";V.offlinePlaybackDisabledReason="OFFLINE_PLAYBACK_DISABLED_REASON_CLIENT_OFFLINE_CONTENT_EXPIRED";return g.G(f,xG(Q,V,"offlineVideoPolicy"),5);
case 5:C=H.next();f.gL(4);break;case 6:return f.return(q.map(function(Y){return Y.key}))}})},$7=function(Q,U,q,H,C){var V,f,Y;
return g.A(function(S){if(S.Z==1)return g.G(S,af(),2);V=S.C;if(!V)return S.return([]);f=U.map(function(R){var B=g.pK(R,q);B={actionType:H,entityKey:B,actionMetadata:Object.assign({},lzt(),C)};H!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&(B.actionMetadata.priority=0);R=new m$(q,R,B);return wX(R)});
Y=HZ7(V,f);rit(Q.T);return S.return(Y)})},ql7=function(Q,U,q,H){var C,V,f,Y,S,R,B,z;
return g.A(function(m){switch(m.Z){case 1:C=[],V=g.F(U),f=V.next();case 2:if(f.done){m.gL(4);break}Y=f.value;if(Y.upToDate||q&&!Y.shouldAutoSyncMetadata||!Y.playlistId){m.gL(3);break}S={};switch(H){case "mainPlaylistEntity":R={nextAutoRefreshIntervalSeconds:Y.checkInSeconds,autoSync:q};S={mainPlaylistEntityActionMetadata:R};break;case "musicPlaylist":B={autoSync:q},S={musicPlaylistEntityActionMetadata:B}}return g.G(m,$7(Q,[Y.playlistId],H,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",S),6);case 6:(z=
m.C)&&C.push.apply(C,g.$y(z));case 3:f=V.next();m.gL(2);break;case 4:return m.return(C)}})},HiJ=function(Q,U){var q;
return g.A(function(H){return U.length?(q=lzt(),g.rP(q,dX,{isEnqueuedForExpiredStreamUrlRefetch:!0}),Q.api.rL("qrd",{v:U.length}),H.return($7(Q,U,"playbackData","OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",q))):H.return([])})},Cq7=function(Q,U,q){this.Z=Q;
this.K=U;this.T=q},oO$=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O;
return g.A(function(d){switch(d.Z){case 1:return q=or(U),H=g.cw(U.entityKey),C=H.entityId,V=[],g.fx(d,2),g.G(d,VG7(Q,C),4);case 4:V=d.C;if(!(Q.K.j("woffle_enable_main_downloads_library")&&((f=V)==null?0:f.length))){d.gL(5);break}return g.G(d,TyJ(Q.Z,[U.entityKey]),5);case 5:g.Tt(d,3);break;case 2:return Y=g.Y8(d),S="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",R="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Y instanceof g.z$&&Y.type==="QUOTA_EXCEEDED"?(S="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
R="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"):U$("Playlist add error"),d.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,S,R));case 3:B=[];if(!Q.K.j("html5_offline_prevent_redownload_downloaded_video")){d.gL(7);break}return g.G(d,x5d(Q.Z,"mainVideoEntity",V),8);case 8:V=d.C;case 7:if((z=V)==null?0:z.length)for(m=g.F(V),L=m.next();!L.done;L=m.next())if(P=L.value,W=P.offlineVideoData,y=void 0,(y=W)==null?0:y.videoId)e=void 0,O=Number(((e=U.actionMetadata)==null?void 0:e.priority)||
0)+1,B.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",W.videoId,"mainVideoEntity",O,tT,f9z(U,W,C)));return d.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,B))}})},T03=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab,rK,l$,e3,J,Qa,cH,Te,OJ,n,U1,Xo,Tj,jK,YZ,Qz,HH,Jb,D,X,M,r,x,i4,a,N,E,F9,eq,s1,gK,Vz,Df,cB,lX,ad,O1,$o,dK,yz,Ib,I2,nx;
return g.A(function(UA){switch(UA.Z){case 1:return q=or(U),H=U.entityKey,C=g.cw(H).entityId,V=[],f=!1,C==="!*$_ALL_ENTITIES_!*$"?(f=!0,g.G(UA,l2(Q.Z,"mainPlaylistEntity"),5)):g.G(UA,jc(Q.Z,H,"mainPlaylistEntity"),4);case 4:(Y=UA.C)&&V.push(Y);UA.gL(3);break;case 5:V=UA.C;case 3:if((S=V)==null||!S.length)return UA.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));R=g.K(U.actionMetadata,ii$);z=(B=R)==null?void 0:B.nextAutoRefreshIntervalSeconds;L=(m=R)==null?void 0:m.autoSync;P=[];y=W=
!0;e=!1;if(!f&&L===!1){UA.gL(6);break}g.fx(UA,7);return g.G(UA,XNz(0,!!L,!0,V),9);case 9:P=UA.C;g.Tt(UA,8);break;case 7:O=g.Y8(UA);if(!(O instanceof Error&&O.message==="No data")){O instanceof Error&&O.message==="Empty response body"&&U$(O.message);UA.gL(8);break}return C==="!*$_ALL_ENTITIES_!*$"?g.G(UA,H_3(Q.Z,U,Q.T,"OFFLINE_DELETE_REASON_UNAVAILABLE"),8):g.G(UA,UjJ(C,Q.Z,U,Q.T),8);case 8:if(!P.length||!f&&P[0].playlistId!==C)return UA.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q));case 6:if(f){d=[];u=g.F(P);for(c=u.next();!c.done;c=u.next())k=c.value,k.upToDate||L&&!k.shouldAutoSyncMetadata||!k.playlistId||(v={nextAutoRefreshIntervalSeconds:k.checkInSeconds,autoSync:L},d.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",k.playlistId,"mainPlaylistEntity",0,tT,{mainPlaylistEntityActionMetadata:v})));return UA.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,d))}P.length&&(qH=P[0],e=!!qH.upToDate,L&&(W=(Ho=qH.shouldAutoSyncMetadata)!=null?Ho:!0,y=(ff=qH.shouldAutoSyncVideos)!=
null?ff:!0,qH.checkInSeconds&&(z=qH.checkInSeconds)));if(e||!W)return UA.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));Bo=[];Cf=V[0];if(!Cf.downloadState){Wo=void 0;UA.gL(15);break}return g.G(UA,jc(Q.Z,Cf.downloadState,"mainPlaylistDownloadStateEntity"),16);case 16:Wo=UA.C;case 15:return vo=Wo,ky=((i$=vo)==null?0:i$.addedTimestampMillis)?String(vo.addedTimestampMillis):void 0,g.fx(UA,17),g.G(UA,VG7(Q,C,ky,z),19);case 19:Bo=UA.C;g.Tt(UA,18);break;case 17:ab=g.Y8(UA);if(!(ab instanceof
Error&&ab.message==="No data for playlist")){if(ab instanceof Error&&ab.message==="Empty response body for playlist")U$(ab.message);else return rK="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",l$="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",ab instanceof g.z$&&ab.type==="QUOTA_EXCEEDED"&&(rK="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",l$="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),UA.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,rK,l$));
UA.gL(18);break}return g.G(UA,UjJ(C,Q.Z,U,Q.T),18);case 18:if(!y)return UA.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));e3=[];J=new Map;if((Qa=Bo)==null?0:Qa.length)for(cH=g.F(Bo),Te=cH.next();!Te.done;Te=cH.next())OJ=Te.value,n=OJ.offlineVideoData,U1=void 0,((U1=n)==null?0:U1.videoId)&&J.set(n.videoId,n);Xo=new Map;Tj=[];if((jK=Cf)==null?0:(YZ=jK.videos)==null?0:YZ.length)for(Qz=g.F(Cf.videos),HH=Qz.next();!HH.done;HH=Qz.next())if(Jb=HH.value,D=JSON.parse(g.cw(Jb).entityId),X=
D.videoId)J.has(X)?(Xo.set(X,J.get(X)),J.delete(X)):Tj.push(X);r=Number(((M=U.actionMetadata)==null?void 0:M.priority)||0)+1;x=g.F(J.entries());for(i4=x.next();!i4.done;i4=x.next())a=i4.value,N=g.F(a),E=N.next().value,F9=N.next().value,eq=E,s1=F9,e3.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",eq,"mainVideoEntity",r,tT,f9z(U,s1,C)));gK=g.F(Xo.entries());for(Vz=gK.next();!Vz.done;Vz=gK.next())Df=Vz.value,cB=g.F(Df),lX=cB.next().value,ad=cB.next().value,O1=lX,$o=ad,e3.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
O1,"mainVideoEntity",r,tT,f9z(U,$o,C)));dK=g.F(Tj);for(yz=dK.next();!yz.done;yz=dK.next())Ib=yz.value,I2={playlistId:C},nx={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"},mainVideoEntityActionMetadata:I2},e3.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",Ib,"mainVideoEntity",0,tT,nx));return UA.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,e3))}})},YlJ=function(Q,U){var q,H,C,V;
return g.A(function(f){switch(f.Z){case 1:return q=or(U),g.fx(f,2),H=g.cw(U.entityKey).entityId,H==="!*$_ALL_ENTITIES_!*$"?g.G(f,H_3(Q.Z,U,Q.T,(C=U.actionMetadata)==null?void 0:(V=C.offlineLoggingData)==null?void 0:V.offlineDeleteReason),5):g.G(f,UjJ(H,Q.Z,U,Q.T),6);case 6:if(!Q.K.j("woffle_enable_main_downloads_library")){f.gL(5);break}return g.G(f,Y3d(Q.Z,U.entityKey),5);case 5:g.Tt(f,3);break;case 2:return g.Y8(f),f.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
"OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return f.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q))}})},VG7=function(Q,U,q,H){var C,V,f,Y,S,R,B;
return g.A(function(z){switch(z.Z){case 1:return g.G(z,hxJ([U]),2);case 2:return C=z.C,g.G(z,SlQ(Q,C[0],q,H),3);case 3:return V=z.C,f=V.mainPlaylistEntity,Y=V.JYC,R=vjJ(f,(S=Y)==null?void 0:S.avatar),g.fx(z,4),g.G(z,Km(R),6);case 6:g.Tt(z,5);break;case 4:B=g.Y8(z),B instanceof Error&&B.message==="Failed to fetch"&&U$(B.message);case 5:return z.return(C[0].videos)}})},SlQ=function(Q,U,q,H){var C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u;
return g.A(function(c){switch(c.Z){case 1:C=Date.now().toString();q||(q=C);V=U.videos;f=U.playlistId;Y=[];S=[];if(V)for(R=g.F(V),B=R.next();!B.done;B=R.next()){z=B.value;m=z.offlineVideoData;if(!m||!m.videoId)throw U$("Invalid offlineVideoData for playlist"),Error("Invalid offlineVideoData for playlist");L=m.videoId;P={videoId:L,playlistId:f};W={id:g.pK(JSON.stringify(P),"mainPlaylistVideoEntity"),video:g.pK(L,"mainVideoEntity")};Y.push(W);S.push(W.id)}e={key:g.pK(f,"mainPlaylistDownloadStateEntity"),
addedTimestampMillis:q,lastSyncedTimestampMillis:C};O={key:g.pK(f,"mainPlaylistEntity"),playlistId:f,videos:S,title:U.title,thumbnailStyleData:RhQ(U),visibility:B0z(U),downloadState:e.key};U.channel&&(d=U.channel.offlineChannelData,y=zhz(g.pK(f,"ytMainChannelEntity"),d),O.channelOwner=y.id);((u=O)==null?0:u.entityMetadata)?(O.entityMetadata.offlineLastModifiedTimestampSeconds=U.lastModifiedTimestamp,H&&(O.entityMetadata.nextAutoRefreshIntervalSeconds=String(H))):O&&(O.entityMetadata={nextAutoRefreshIntervalSeconds:H?
String(H):void 0,offlineLastModifiedTimestampSeconds:U.lastModifiedTimestamp});g.fx(c,2);return g.G(c,tG(Q.Z,{mode:"readwrite",zm:!0},function(k){var v=c8(k,O,"mainPlaylistEntity"),qH=c8(k,e,"mainPlaylistDownloadStateEntity");v=[v,qH];qH=g.F(Y);for(var Ho=qH.next();!Ho.done;Ho=qH.next())v.push(c8(k,Ho.value,"mainPlaylistVideoEntity"));y&&v.push(c8(k,y,"ytMainChannelEntity"));return g.hO.all(v)}),4);
case 4:g.Tt(c,3);break;case 2:throw g.Y8(c),U$("PES failure for playlist"),Error("PES failure for playlist");case 3:return c.return({mainPlaylistEntity:O,JYC:y,lnv:Y})}})},zhz=function(Q,U){return{id:Q,
channelId:U.channelId,title:U.title,avatar:U.thumbnail}},RhQ=function(Q){var U=[],q=Q.videos;
q&&q.length>0&&U.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_FIRST_VIDEO"),value:{collageThumbnail:{coverThumbnail:q[0].offlineVideoData.thumbnail}}});if((Q=Q.additionalMetadadatas)&&Q.length>0)for(Q=g.F(Q),q=Q.next();!q.done;q=Q.next()){var H=q.value.offlineBundleItemPlaylistData,C=void 0;q=(C=H)==null?void 0:C.style;C=void 0;H={collageThumbnail:{coverThumbnail:(C=H)==null?void 0:C.coverThumbnail}};switch(q){case "BUNDLE_ITEM_STYLE_UNSPECIFIED":U.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_UNKNOWN"),
value:H});break;case "BUNDLE_ITEM_STYLE_TWO_BY_TWO":U.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_TWO_BY_TWO"),value:H});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO_AVATAR":U.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO_AVATAR"),value:H});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO":U.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO"),value:H})}}return U},B0z=function(Q){switch(Q.privacy){case "PRIVATE":return"PLAYLIST_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_VISIBILITY_UNLISTED";default:return"PLAYLIST_VISIBILITY_UNKNOWN"}},f9z=function(Q,U,q){U={offlineVideoData:U,
playlistId:q};if(Q=g.K(Q.actionMetadata,ii$))U.maximumDownloadQuality=Q.maximumDownloadQuality;return{mainVideoEntityActionMetadata:U}},LXd=function(Q,U,q){this.Z=Q;
this.K=U;this.T=q},wL3=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P;
return g.A(function(W){switch(W.Z){case 1:return q=or(U),H=g.cw(U.entityKey),C=H.entityId,V=g.K(U.actionMetadata,x7),Y=!((f=V)==null?0:f.playlistId),g.fx(W,2),g.G(W,mXt(Q,C,void 0,(S=V)==null?void 0:S.offlineVideoData,Y),4);case 4:g.Tt(W,3);break;case 2:return R=g.Y8(W),B="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",z="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",R instanceof g.z$&&R.type==="QUOTA_EXCEEDED"&&(B="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",z="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
W.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,B,z));case 3:m=1;m=Number(((L=U.actionMetadata)==null?void 0:L.priority)||0)+1;var y=(y=g.K(U.actionMetadata,x7))?{playbackDataActionMetadata:{maximumDownloadQuality:y.maximumDownloadQuality}}:void 0;P=F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",C,"playbackData",m,Pq7,y);return W.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,[P]))}})},sxd=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O;
return g.A(function(d){switch(d.Z){case 1:return q=or(U),H=g.cw(U.entityKey),C=H.entityId,g.G(d,jc(Q.Z,U.entityKey,"mainVideoEntity"),2);case 2:V=d.C;if(!V){f=void 0;d.gL(3);break}return g.G(d,jc(Q.Z,V.downloadState,"mainVideoDownloadStateEntity"),4);case 4:f=d.C;case 3:Y=f;if(!V||!Y)return d.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));g.fx(d,5);return g.G(d,mXt(Q,C,Y.addedTimestampMillis,(R=g.K(U.actionMetadata,x7))==null?void 0:R.offlineVideoData),7);case 7:B=1;B=Number(((z=
U.actionMetadata)==null?void 0:z.priority)||0)+1;S=F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",C,"playbackData",B,Pq7);g.Tt(d,6);break;case 5:m=g.Y8(d);if(!(m instanceof Error&&m.message==="No data")){if(m instanceof Error&&m.message==="Empty response body")U$(m.message);else return L="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",P="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",m instanceof g.z$&&m.type==="QUOTA_EXCEEDED"&&(L="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
P="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),d.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,L,P));d.gL(6);break}return g.G(d,X2(Q.Z,C),9);case 9:W=d.C;y=g.K(U.actionMetadata,x7);if(O=(e=y)==null?void 0:e.playlistId)W.playlistId=O;W.offlineDeleteReason="OFFLINE_DELETE_REASON_UNAVAILABLE";return g.G(d,hT(C,Q.Z,U,Q.T,W),6);case 6:return d.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,S?[S]:void 0))}})},KXH=function(Q,U){var q,H,C,V,f,Y,S,R,B,z;
return g.A(function(m){switch(m.Z){case 1:return q=or(U),g.fx(m,2),H=g.cw(U.entityKey).entityId,H==="!*$_ALL_ENTITIES_!*$"?g.G(m,H_3(Q.Z,U,Q.T,(B=U.actionMetadata)==null?void 0:(z=B.offlineLoggingData)==null?void 0:z.offlineDeleteReason),5):g.G(m,X2(Q.Z,H),6);case 6:C=m.C;V=g.K(U.actionMetadata,x7);if(Y=(f=V)==null?void 0:f.playlistId)C.playlistId=Y;C.offlineDeleteReason=(S=U.actionMetadata)==null?void 0:(R=S.offlineLoggingData)==null?void 0:R.offlineDeleteReason;return g.G(m,hT(H,Q.Z,U,Q.T,C),7);
case 7:if(!Q.K.j("woffle_enable_main_downloads_library")){m.gL(5);break}return g.G(m,Y3d(Q.Z,U.entityKey),5);case 5:g.Tt(m,3);break;case 2:return g.Y8(m),m.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return m.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q))}})},mXt=function(Q,U,q,H,C){var V,f,Y,S,R,B;
return g.A(function(z){switch(z.Z){case 1:if(V=H){z.gL(2);break}return g.G(z,KRd([U]),3);case 3:f=z.C,V=f[0];case 2:return g.G(z,hht(Q,V,q,C),4);case 4:Y=z.C;S=Y.mainVideoEntity;R=Y.channelEntity;g.fx(z,5);var m=Lm(S.thumbnail),L=Lm(R.avatar);return g.G(z,Km(m.concat(L)),7);case 7:g.Tt(z,0);break;case 5:B=g.Y8(z),B instanceof Error&&B.message==="Failed to fetch"&&U$(B.message),g.Cx(z)}})},hht=function(Q,U,q,H){var C,V,f,Y,S,R,B,z,m,L,P,W,y;
return g.A(function(e){switch(e.Z){case 1:q||(q=Date.now().toString());V=(C=U.channel)==null?void 0:C.offlineChannelData;f={id:g.pK(U.videoId,"ytMainChannelEntity"),channelId:V.channelId,title:V.title,avatar:V.thumbnail};Y={key:g.pK(U.videoId,"mainVideoDownloadStateEntity"),playbackData:g.pK(U.videoId,"playbackData"),addedTimestampMillis:q,videoDownloadContextEntity:g.pK(U.videoId,"videoDownloadContextEntity")};S={key:g.pK(U.videoId,"videoPlaybackPositionEntity"),videoId:U.videoId,lastPlaybackPositionSeconds:"0"};
Q.K.j("html5_offline_playback_position_sync")&&(R={playbackPosition:S.key});B=g.pK(U.videoId,"mainVideoEntity");z={key:B,videoId:U.videoId,title:U.title,thumbnail:U.thumbnail,localizedStrings:{viewCount:U.shortViewCountText},userState:R,lengthSeconds:U.lengthSeconds?Number(U.lengthSeconds):void 0,publishedTimestampMillis:U.publishedTimestamp?(Number(U.publishedTimestamp)*1E3).toString():void 0,formattedDescription:U.description,owner:f.id,downloadState:Y.key};if(!Q.K.j("woffle_enable_main_downloads_library")||
!H){e.gL(2);break}return g.G(e,i_t(Q.Z,[B]),3);case 3:if(P=e.C)m=P.mainDownloadsLibraryEntity,L=P.mainDownloadsListEntity;case 2:return y=tS8,W={key:g.pK(U.videoId,"downloadStatusEntity"),downloadState:"DOWNLOAD_STATE_PENDING_DOWNLOAD"},g.rP(Y,y,W),g.G(e,tG(Q.Z,{mode:"readwrite",zm:!0},function(O){var d=c8(O,f,"ytMainChannelEntity"),u=c8(O,Y,"mainVideoDownloadStateEntity"),c=c8(O,z,"mainVideoEntity");d=[d,u,c];Q.K.j("html5_offline_playback_position_sync")&&(u=c8(O,S,"videoPlaybackPositionEntity"),
d.push(u));m&&(u=c8(O,m,"mainDownloadsLibraryEntity"),d.push(u));L&&(u=c8(O,L,"mainDownloadsListEntity"),d.push(u));W&&(O=c8(O,W,"downloadStatusEntity"),d.push(O));return g.hO.all(d)}),4);
case 4:return e.return({mainVideoEntity:z,channelEntity:f})}})},WX7=function(Q,U,q){this.Z=Q;
this.K=U;this.T=q},yBz=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf;
return g.A(function(Wo){switch(Wo.Z){case 1:return q=or(U),H=[],g.G(Wo,rn.getInstance(),2);case 2:C=Wo.C;if(!C){Wo.gL(3);break}return g.G(Wo,C.get("sdois"),4);case 4:return V=Wo.C,g.G(Wo,(Y=C)==null?void 0:Y.get("lmqf"),5);case 5:f=Wo.C;case 3:g.fx(Wo,6);if(V===void 0)throw Error("prefStorage or opt-in state is undefined");S=[];if(V){Wo.gL(8);break}return g.G(Wo,ou8(Q.Z),9);case 9:S=Wo.C,S.reverse();case 8:if(!S.length){Wo.gL(10);break}R=g.F(S);B=R.next();case 11:if(B.done){Wo.gL(10);break}z=B.value;
if(!z){Wo.gL(12);break}m=g.cw(z).entityId;return g.G(Wo,X2(Q.Z,m),14);case 14:return L=Wo.C,L.offlineDeleteReason="OFFLINE_DELETE_REASON_PARENT_LIST_DELETE",g.G(Wo,hT(m,Q.Z,{entityKey:z,actionType:U.actionType},Q.T,L),12);case 12:B=R.next();Wo.gL(11);break;case 10:return g.G(Wo,nuN(V,(P=f)!=null?P:"SD"),16);case 16:return W=Wo.C,g.G(Wo,C5d(W),17);case 17:y=fWQ(W);if(!Q.K.j("woffle_enable_main_downloads_library")){Wo.gL(18);break}if(V){Wo.gL(19);break}return g.G(Wo,Y3d(Q.Z,g.e4),19);case 19:return g.G(Wo,
TyJ(Q.Z,[g.e4]),18);case 18:if((e=y)==null?0:e.length)for(O=g.F(y),d=O.next();!d.done;d=O.next())if(c=u=d.value,k=c.actionType,v=c.entityKey,qH=c.actionMetadata,k&&v&&qH&&!g.K(qH,XLA)){k==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(qH.offlineLoggingData={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});if(Ho=g.K(u.actionMetadata,x7))Ho.playlistId="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS",u.actionMetadata=Object.assign({},u.actionMetadata,{mainVideoEntityActionMetadata:Ho});H.push(u)}g.Tt(Wo,
7);break;case 6:return ff=g.Y8(Wo),Bo="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Cf="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",ff instanceof g.z$&&ff.type==="QUOTA_EXCEEDED"&&(Bo="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Cf="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Wo.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,Bo,Cf));case 7:return Wo.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,H))}})},nOQ=function(){Nk.apply(this,
arguments);
this.u2="mainVideoEntity"},MGA=function(Q,U,q){U=U===void 0?43200:U;
q=q===void 0?!0:q;var H=H===void 0?!1:H;var C,V,f;return g.A(function(Y){switch(Y.Z){case 1:if(!Q.U.dj())return Y.return([]);C=[];g.fx(Y,2);return g.G(Y,XNz(U,q,H),4);case 4:C=Y.C;g.Tt(Y,3);break;case 2:V=g.Y8(Y),V instanceof Error&&V.message==="No data"||V instanceof Error&&V.message==="Empty response body"&&U$(V.message);case 3:return f=ql7(Q,C,q,"mainPlaylistEntity"),Y.return(f)}})},DX8=function(Q,U,q,H){H=H===void 0?!1:H;
var C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O;return g.A(function(d){switch(d.Z){case 1:return C=[],g.G(d,yez(),2);case 2:return(V=d.C)||H?g.G(d,MRx(U,q),3):d.return([]);case 3:f=d.C;if((Y=f)==null||!Y.length)return d.return([]);S={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"};R=g.F(f);B=R.next();case 4:if(B.done){d.gL(6);break}m=z=B.value;L=m.actionType;P=m.entityKey;W=m.actionMetadata;if(!(L&&P&&W)||g.K(W,XLA)){d.gL(5);break}L==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(W.offlineLoggingData=
S);y=g.cw(P);e=y.entityId;return g.G(d,$7(Q,[e],"mainVideoEntity",L,W),8);case 8:O=d.C,C=C.concat(O);case 5:B=R.next();d.gL(4);break;case 6:return d.return(C)}})},JBx=function(Q,U){this.Z=Q;
this.T=U},Oi$=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e;
return g.A(function(O){switch(O.Z){case 1:return q=or(U),H=g.cw(U.entityKey),C=H.entityId,V=[],g.fx(O,2),g.G(O,gOd(Q,C),4);case 4:V=O.C;if((f=V)==null||!f.length){O.gL(5);break}return g.G(O,LR8(Q.Z,U.entityKey),5);case 5:g.Tt(O,3);break;case 2:return Y=g.Y8(O),S="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",R="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Y instanceof g.z$&&Y.type==="QUOTA_EXCEEDED"&&(S="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",R="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
O.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,S,R));case 3:return B=[],g.G(O,x5d(Q.Z,"musicTrack",V),7);case 7:V=O.C;if(V.length)for(z=g.F(V),m=z.next();!m.done;m=z.next())if(L=m.value,P=L.offlineVideoData,W=void 0,(W=P)==null?0:W.videoId)y=void 0,e=Number(((y=U.actionMetadata)==null?void 0:y.priority)||0)+1,B.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",P.videoId,"musicTrack",e,jw,Do(U,P,C)));return O.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,B))}})},
FX8=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab,rK,l$,e3,J,Qa,cH,Te,OJ,n,U1,Xo,Tj,jK,YZ,Qz,HH,Jb,D,X,M,r,x,i4,a,N,E,F9;
return g.A(function(eq){switch(eq.Z){case 1:return q=or(U),H=U.entityKey,C=g.cw(H).entityId,V=[],f=!1,C==="!*$_ALL_ENTITIES_!*$"?(f=!0,g.G(eq,l2(Q.Z,"musicAlbumRelease"),5)):g.G(eq,jc(Q.Z,H,"musicAlbumRelease"),4);case 4:(Y=eq.C)&&V.push(Y);eq.gL(3);break;case 5:V=eq.C;case 3:if((S=V)==null||!S.length)return eq.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));if(f){R=[];B=g.F(V);for(z=B.next();!z.done;z=B.next())m=z.value,L=g.cw(m.id).entityId,R.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
L,"musicAlbumRelease",0,jw));return eq.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,R))}P=[];W=V[0];y=void 0;if(!W.downloadMetadata){eq.gL(6);break}return g.G(eq,jc(Q.Z,W.downloadMetadata,"musicAlbumReleaseDownloadMetadataEntity"),7);case 7:e=eq.C,y=Number((d=(O=e)==null?void 0:O.addedTimestampMillis)!=null?d:"0")/1E3;case 6:return g.fx(eq,8),g.G(eq,gOd(Q,C,(u=y)==null?void 0:u.toString()),10);case 10:P=eq.C;g.Tt(eq,9);break;case 8:c=g.Y8(eq);if(!(c instanceof Error&&c.message===
"No data")){if(c instanceof Error&&c.message==="Empty response body")U$(c.message);else return k="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",v="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",c instanceof g.z$&&c.type==="QUOTA_EXCEEDED"&&(k="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",v="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),eq.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,k,v));eq.gL(9);break}return g.G(eq,nm(C,"musicAlbumRelease",Q.Z,
U,Q.T),9);case 9:qH=[];Ho=new Map;if((ff=P)==null?0:ff.length)for(Bo=g.F(P),Cf=Bo.next();!Cf.done;Cf=Bo.next())Wo=Cf.value,vo=Wo.offlineVideoData,i$=void 0,((i$=vo)==null?0:i$.videoId)&&Ho.set(vo.videoId,vo);ky=new Map;ab=[];if((rK=W)==null?0:(l$=rK.tracks)==null?0:l$.length)for(e3=g.F(W.tracks),J=e3.next();!J.done;J=e3.next())if(Qa=J.value,cH=g.cw(Qa).entityId)Ho.has(cH)?(ky.set(cH,Ho.get(cH)),Ho.delete(cH)):ab.push(cH);OJ=Number(((Te=U.actionMetadata)==null?void 0:Te.priority)||0)+1;n=g.F(Ho.entries());
for(U1=n.next();!U1.done;U1=n.next())Xo=U1.value,Tj=g.F(Xo),jK=Tj.next().value,YZ=Tj.next().value,Qz=jK,HH=YZ,qH.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",Qz,"musicTrack",OJ,jw,Do(U,HH)));Jb=g.F(ky.entries());for(D=Jb.next();!D.done;D=Jb.next())X=D.value,M=g.F(X),r=M.next().value,x=M.next().value,i4=r,a=x,qH.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",i4,"musicTrack",OJ,jw,Do(U,a)));N=g.F(ab);for(E=N.next();!E.done;E=N.next())F9=E.value,qH.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
F9,"musicTrack",0,jw));return eq.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,qH))}})},ehA=function(Q,U){var q,H;
return g.A(function(C){switch(C.Z){case 1:return q=or(U),g.fx(C,2),H=g.cw(U.entityKey).entityId,H==="!*$_ALL_ENTITIES_!*$"?g.G(C,Mk(Q.Z,U,Q.T),5):g.G(C,nm(H,"musicAlbumRelease",Q.Z,U,Q.T),6);case 6:return g.G(C,mjx(Q.Z,U.entityKey),5);case 5:g.Tt(C,3);break;case 2:return g.Y8(C),C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q))}})},gOd=function(Q,U,q){var H,C,V;
return g.A(function(f){switch(f.Z){case 1:return g.G(f,hxJ([U]),2);case 2:return H=f.C,g.G(f,dXQ(Q,H[0],q),3);case 3:return C=f.C,V=Lm(C.thumbnailDetails),g.G(f,Km(V),4);case 4:return f.return(H[0].videos)}})},dXQ=function(Q,U,q){var H,C,V,f,Y,S,R,B,z,m,L,P,W,y;
return g.A(function(e){if(e.Z==1){H=U.additionalMetadadatas;C=void 0;if(H&&H.length>0)for(V=g.F(H),f=V.next();!f.done;f=V.next())if(Y=f.value,Y.offlineMusicPlaylistData){C=Y.offlineMusicPlaylistData;break}S=U.playlistId;R=P5$(U);B=R.Ou;z=R.cn;m=q?(Number(q)*1E3).toString():Date.now().toString();L=U.lastModifiedTimestamp?(Number(U.lastModifiedTimestamp)*1E3).toString():"0";P={id:g.pK(S,"musicAlbumReleaseDownloadMetadataEntity"),trackDownloadMetadatas:z,lastModifiedTimestampMillis:L,addedTimestampMillis:m,
syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"};W={id:g.pK(S,"musicAlbumRelease"),title:U.title,audioPlaylistId:S,trackCount:U.totalVideoCount,tracks:B,downloadMetadata:P.id};C&&(W.thumbnailDetails=(y=C.albumHqThumbnail)!=null?y:C.albumArtistThumbnail,W.artistDisplayName=C.albumArtistDisplayName,W.releaseDate=C.albumReleaseDate,W.contentRating={explicitType:C.albumReleaseExplicitType},W.releaseType=C.albumReleaseType);return g.G(e,tG(Q.Z,{mode:"readwrite",zm:!0},function(O){var d=c8(O,W,"musicAlbumRelease");
O=c8(O,P,"musicAlbumReleaseDownloadMetadataEntity");return g.hO.all([d,O])}),2)}return e.return(W)})},GId=function(Q,U){this.Z=Q;
this.T=U},rBd=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e;
return g.A(function(O){switch(O.Z){case 1:return q=or(U),H=g.cw(U.entityKey),C=H.entityId,V=[],g.fx(O,2),g.G(O,uk7(Q,C),4);case 4:V=O.C;if((f=V)==null||!f.length){O.gL(5);break}return g.G(O,LR8(Q.Z,U.entityKey),5);case 5:g.Tt(O,3);break;case 2:return Y=g.Y8(O),S="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",R="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Y instanceof g.z$&&Y.type==="QUOTA_EXCEEDED"&&(S="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",R="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
O.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,S,R));case 3:return B=[],g.G(O,x5d(Q.Z,"musicTrack",V),7);case 7:V=O.C;if(V.length)for(z=g.F(V),m=z.next();!m.done;m=z.next())if(L=m.value,P=L.offlineVideoData,W=void 0,(W=P)==null?0:W.videoId)y=void 0,e=Number(((y=U.actionMetadata)==null?void 0:y.priority)||0)+1,B.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",P.videoId,"musicTrack",e,lt,Do(U,P,C)));return O.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,B))}})},
ABt=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab,rK,l$,e3,J,Qa,cH,Te,OJ,n,U1,Xo,Tj,jK,YZ,Qz,HH,Jb,D,X,M,r,x,i4,a,N,E,F9,eq,s1,gK,Vz,Df,cB,lX,ad,O1,$o,dK,yz;
return g.A(function(Ib){switch(Ib.Z){case 1:return q=or(U),H=U.entityKey,C=g.cw(H).entityId,V=[],f=!1,C==="!*$_ALL_ENTITIES_!*$"?(f=!0,g.G(Ib,l2(Q.Z,"musicPlaylist"),5)):g.G(Ib,jc(Q.Z,H,"musicPlaylist"),4);case 4:(Y=Ib.C)&&V.push(Y);Ib.gL(3);break;case 5:V=Ib.C;case 3:if((S=V)==null||!S.length)return Ib.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));R=g.K(U.actionMetadata,wN8);z=(B=R)==null?void 0:B.autoSync;m=[];P=L=!0;W=!1;y=void 0;if(!f&&z===!1){Ib.gL(6);break}g.fx(Ib,7);return g.G(Ib,
Dj8(0,!!z,!0,V),9);case 9:m=Ib.C;g.Tt(Ib,8);break;case 7:e=g.Y8(Ib);if(!(e instanceof Error&&e.message==="No data")){e instanceof Error&&e.message==="Empty response body"&&U$(e.message);Ib.gL(8);break}return C==="!*$_ALL_ENTITIES_!*$"?g.G(Ib,Mk(Q.Z,U,Q.T),8):g.G(Ib,nm(C,"musicPlaylist",Q.Z,U,Q.T),8);case 8:if(!m.length||!f&&m[0].playlistId!==C)return Ib.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));case 6:if(f){O=[];d=g.F(m);for(u=d.next();!u.done;u=d.next())c=u.value,c.upToDate||
z&&!c.shouldAutoSyncMetadata||!c.playlistId||(k={autoSync:z},O.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",c.playlistId,"musicPlaylist",0,lt,{musicPlaylistEntityActionMetadata:k})));return Ib.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,O))}m.length&&(v=m[0],W=!!v.upToDate,z&&(L=(qH=v.shouldAutoSyncMetadata)!=null?qH:!0,P=(Ho=v.shouldAutoSyncVideos)!=null?Ho:!0,v.checkInSeconds&&(y=v.checkInSeconds)));if(W||!L)return Ib.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q));ff=[];Bo=V[0];Cf=void 0;if(!Bo.downloadMetadata){Ib.gL(15);break}return g.G(Ib,jc(Q.Z,Bo.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),16);case 16:Wo=Ib.C,Cf=Number((i$=(vo=Wo)==null?void 0:vo.addedTimestampMillis)!=null?i$:"0")/1E3;case 15:return g.fx(Ib,17),g.G(Ib,uk7(Q,C,(ky=Cf)==null?void 0:ky.toString(),y),19);case 19:ff=Ib.C;g.Tt(Ib,18);break;case 17:ab=g.Y8(Ib);if(!(ab instanceof Error&&ab.message==="No data")){if(ab instanceof Error&&ab.message==="Empty response body")U$(ab.message);
else return rK="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",l$="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",ab instanceof g.z$&&ab.type==="QUOTA_EXCEEDED"&&(rK="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",l$="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Ib.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,rK,l$));Ib.gL(18);break}return g.G(Ib,nm(C,"musicPlaylist",Q.Z,U,Q.T),18);case 18:if(!P)return Ib.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q));e3=[];J=new Map;if((Qa=ff)==null?0:Qa.length)for(cH=g.F(ff),Te=cH.next();!Te.done;Te=cH.next())OJ=Te.value,n=OJ.offlineVideoData,U1=void 0,((U1=n)==null?0:U1.videoId)&&J.set(n.videoId,n);Xo=new Map;Tj=[];if((jK=Bo)==null?0:(YZ=jK.tracks)==null?0:YZ.length)for(Qz=g.F(Bo.tracks),HH=Qz.next();!HH.done;HH=Qz.next())if(Jb=HH.value,D=g.cw(Jb).entityId)J.has(D)?(Xo.set(D,J.get(D)),J.delete(D)):Tj.push(D);M=Number(((X=U.actionMetadata)==null?void 0:X.priority)||0)+1;r=g.F(J.entries());for(x=r.next();!x.done;x=
r.next())i4=x.value,a=g.F(i4),N=a.next().value,E=a.next().value,F9=N,eq=E,e3.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",F9,"musicTrack",M,lt,Do(U,eq)));s1=g.F(Xo.entries());for(gK=s1.next();!gK.done;gK=s1.next())Vz=gK.value,Df=g.F(Vz),cB=Df.next().value,lX=Df.next().value,ad=cB,O1=lX,e3.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",ad,"musicTrack",M,lt,Do(U,O1)));$o=g.F(Tj);for(dK=$o.next();!dK.done;dK=$o.next())yz=dK.value,e3.push(F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",yz,"musicTrack",
0,lt));return Ib.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,e3))}})},EO7=function(Q,U){var q,H;
return g.A(function(C){switch(C.Z){case 1:return q=or(U),g.fx(C,2),H=g.cw(U.entityKey).entityId,H==="!*$_ALL_ENTITIES_!*$"?g.G(C,Mk(Q.Z,U,Q.T),5):g.G(C,nm(H,"musicPlaylist",Q.Z,U,Q.T),6);case 6:return g.G(C,mjx(Q.Z,U.entityKey),5);case 5:g.Tt(C,3);break;case 2:return g.Y8(C),C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q))}})},uk7=function(Q,U,q,H){var C,V,f;
return g.A(function(Y){switch(Y.Z){case 1:return g.G(Y,hxJ([U]),2);case 2:return C=Y.C,g.G(Y,bi3(Q,C[0],q,H),3);case 3:return V=Y.C,f=Lm(V.thumbnailDetails),g.G(Y,Km(f),4);case 4:return Y.return(C[0].videos)}})},bi3=function(Q,U,q,H){var C,V,f,Y,S,R,B,z,m;
return g.A(function(L){return L.Z==1?(C=U.playlistId,V=P5$(U),f=V.Ou,Y=V.cn,S=q?(Number(q)*1E3).toString():Date.now().toString(),R=U.lastModifiedTimestamp?(Number(U.lastModifiedTimestamp)*1E3).toString():"0",B={id:g.pK(C,"musicPlaylistDownloadMetadataEntity"),trackDownloadMetadatas:Y,lastModifiedTimestampMillis:R,addedTimestampMillis:S,syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"},z={id:g.pK(C,"musicPlaylist"),title:U.title,playlistId:C,thumbnailDetails:U.thumbnail,visibility:kIx(U),trackCount:U.totalVideoCount,
tracks:f,downloadMetadata:B.id},H&&(((m=z)==null?0:m.entityMetadata)?z.entityMetadata.nextAutoRefreshIntervalSeconds=String(H):z&&(z.entityMetadata={nextAutoRefreshIntervalSeconds:String(H)})),g.G(L,tG(Q.Z,{mode:"readwrite",zm:!0},function(P){var W=c8(P,z,"musicPlaylist");P=c8(P,B,"musicPlaylistDownloadMetadataEntity");return g.hO.all([W,P])}),2)):L.return(z)})},kIx=function(Q){switch(Q.privacy){case "PRIVATE":return"PLAYLIST_ENTITY_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_ENTITY_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_ENTITY_VISIBILITY_UNLISTED";default:return"PLAYLIST_ENTITY_VISIBILITY_UNKNOWN"}},I98=function(Q,U){this.Z=Q;
this.T=U},$XN=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P;
return g.A(function(W){switch(W.Z){case 1:return q=or(U),H=g.cw(U.entityKey),C=H.entityId,V=g.K(U.actionMetadata,cBA),g.fx(W,2),g.G(W,pLz(Q,C,void 0,(f=V)==null?void 0:f.track,(Y=V)==null?void 0:Y.albumRelease),4);case 4:if((S=V)==null?0:S.playlistId){W.gL(5);break}return g.G(W,LR8(Q.Z,U.entityKey),5);case 5:g.Tt(W,3);break;case 2:return R=g.Y8(W),B="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",z="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",R instanceof g.z$&&R.type==="QUOTA_EXCEEDED"&&
(B="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",z="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),W.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,B,z));case 3:L=Number(((m=U.actionMetadata)==null?void 0:m.priority)||0)+1;var y=(y=g.K(U.actionMetadata,cBA))?{playbackDataActionMetadata:{maximumDownloadQuality:y.maximumDownloadQuality}}:void 0;P=F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",C,"playbackData",L,N0A,y);return W.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q,[P]))}})},tGx=function(Q,U){var q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y;
return g.A(function(e){switch(e.Z){case 1:return q=or(U),H=g.cw(U.entityKey),C=H.entityId,g.G(e,jc(Q.Z,U.entityKey,"musicTrack"),2);case 2:V=e.C;if(!V){f=void 0;e.gL(3);break}return g.G(e,jc(Q.Z,V.downloadMetadata,"musicTrackDownloadMetadataEntity"),4);case 4:f=e.C;case 3:Y=f;if(!V||!Y)return e.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q));R=g.K(U.actionMetadata,cBA);g.fx(e,5);return g.G(e,pLz(Q,C,Y.addedTimestampMillis,(B=R)==null?void 0:B.track,(z=R)==null?void 0:z.albumRelease),
7);case 7:L=Number(((m=U.actionMetadata)==null?void 0:m.priority)||0)+1;S=F2("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",C,"playbackData",L,N0A);g.Tt(e,6);break;case 5:P=g.Y8(e);if(!(P instanceof Error&&P.message==="No data")){if(P instanceof Error&&P.message==="Empty response body")U$(P.message);else return W="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",y="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",P instanceof g.z$&&P.type==="QUOTA_EXCEEDED"&&(W="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
y="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),e.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,W,y));e.gL(6);break}return g.G(e,y8(C,Q.Z,U,Q.T),6);case 6:return e.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",q,S?[S]:void 0))}})},xXd=function(Q,U){var q,H;
return g.A(function(C){switch(C.Z){case 1:return q=or(U),g.fx(C,2),H=g.cw(U.entityKey).entityId,H==="!*$_ALL_ENTITIES_!*$"?g.G(C,Mk(Q.Z,U,Q.T),5):g.G(C,y8(H,Q.Z,U,Q.T),6);case 6:return g.G(C,mjx(Q.Z,U.entityKey),5);case 5:g.Tt(C,3);break;case 2:return g.Y8(C),C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",q,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return C.return(new ew("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
q))}})},pLz=function(Q,U,q,H,C){var V,f,Y,S,R,B;
return g.A(function(z){switch(z.Z){case 1:if(V=H){z.gL(2);break}return g.G(z,KRd([U]),3);case 3:f=z.C,Y=f[0],V=zxA(Y);case 2:return g.G(z,jxA(Q,V,U,C,q),4);case 4:S=z.C;R=S.musicTrackEntity;B=S.jw;var m=Lm(R.thumbnailDetails),L=[];B&&(L=Lm(B.thumbnailDetails));return g.G(z,Km(m.concat(L)),0)}})},jxA=function(Q,U,q,H,C){var V;
return g.A(function(f){return f.Z==1?(C||(C=Date.now().toString()),V={id:g.pK(q,"musicTrackDownloadMetadataEntity"),playbackData:g.pK(q,"playbackData"),addedTimestampMillis:C,videoDownloadContextEntity:g.pK(q,"videoDownloadContextEntity")},H&&(U.albumRelease=H.id),g.G(f,tG(Q.Z,{mode:"readwrite",zm:!0},function(Y){var S=[],R=c8(Y,V,"musicTrackDownloadMetadataEntity");S.push(R);R=c8(Y,U,"musicTrack");S.push(R);H&&(Y=c8(Y,H,"musicAlbumRelease"),S.push(Y));return g.hO.all(S)}),2)):f.Z!=3?g.G(f,Rr(q,"musicTrackDownloadMetadataEntity",
Q.Z,"DOWNLOAD_STATE_PENDING_DOWNLOAD"),3):f.return({musicTrackEntity:U,
jw:H})})},ar=function(){Nk.apply(this,arguments);
this.u2="musicTrack"},l9A=function(Q,U,q){U=U===void 0?43200:U;
q=q===void 0?!0:q;var H=H===void 0?!1:H;var C,V;return g.A(function(f){switch(f.Z){case 1:if(!Q.U.dj())return f.return([]);C=[];g.fx(f,2);return g.G(f,Dj8(U,q,H),4);case 4:C=f.C;g.Tt(f,3);break;case 2:g.Y8(f);case 3:return V=ql7(Q,C,q,"musicPlaylist"),f.return(V)}})},a9d=function(){g.Yr.apply(this,arguments);
var Q=this;this.events=new g.Sf(this);this.K=this.player.Y();this.L_={Szc:function(){return Q.Z},
Uz:function(){return Q.Uz()},
JT:function(U){return Q.JT(U)}}},Zi$=function(Q){var U;
Q=g.K((U=Q.getWatchNextResponse())==null?void 0:U.currentVideoEndpoint,g.Ya);if(Q==null?0:Q.playlistId)var q=Q.playlistId;return q},vO8=function(Q,U){var q,H,C,V;
return g.A(function(f){if(f.Z==1){q=U.clientPlaybackNonce;H={cpn:q,offlineSourceVisualElement:g.Py(U.ZE||"").getAsJson(),selectedOfflineMode:"OFFLINE_NOW",isPartialPlayback:!1};U.C&&(H.videoFmt=Number(U.C.itag));U.X&&(H.audioFmt=Number(U.X.itag));if((C=Zi$(U))&&U.videoId){var Y=U.videoId;Y=C!=="PPSV"?Promise.resolve(!1):Q.Z.wZ(Y);f=g.G(f,Y,3)}else f=f.gL(2);return f}f.Z!=2&&(V=f.C)&&(H.selectedOfflineMode="OFFLINE_MODE_TYPE_AUTO_OFFLINE");Q.C=q;g.LD("offlinePlaybackStarted",H);g.Cx(f)})};
g.dh.prototype.Ft=g.u4(41,function(Q){return this.app.Ft(Q)});
g.R8.prototype.Ft=g.u4(40,function(Q){return g.xi6(this,9,Q)});
g.h(G8,dn);g.co.Object.defineProperties(G8.prototype,{entityMetadata:{configurable:!0,enumerable:!0,get:function(){return this.Z.entityMetadata},
set:function(Q){this.Z.entityMetadata=Q}}});
g.h(bMd,G8);bMd.prototype.C=function(){return[]};
g.h(kLd,G8);kLd.prototype.C=function(){return[]};
g.h(Ipd,G8);Ipd.prototype.C=function(){return[]};
g.h(cYA,G8);cYA.prototype.C=function(){return[]};
g.h(p1A,G8);p1A.prototype.C=function(){return[]};
g.h(NTx,G8);NTx.prototype.C=function(){var Q=[];this.Z.alternateChannel&&Q.push(this.Z.alternateChannel);this.Z.alternateChannelList&&Q.push.apply(Q,g.$y(this.Z.alternateChannelList));this.Z.oneofChannelEntity&&Q.push(this.Z.oneofChannelEntity);return[].concat(g.$y(new Set(Q)))};
g.h($GN,G8);$GN.prototype.C=function(){var Q=[];this.Z.entryCollection&&Q.push(this.Z.entryCollection);return[].concat(g.$y(new Set(Q)))};
g.h(t13,dn);t13.prototype.C=function(){var Q=[];this.Z.video&&Q.push(this.Z.video);return[].concat(g.$y(new Set(Q)))};
g.h(xGz,G8);xGz.prototype.C=function(){var Q=[];this.Z.parentPlaylist&&Q.push(this.Z.parentPlaylist);if(this.Z.entries)for(var U=g.F(this.Z.entries),q=U.next();!q.done;q=U.next())Q.push.apply(Q,g.$y((new t13(q.value)).C()));return[].concat(g.$y(new Set(Q)))};
g.h(jRH,G8);jRH.prototype.C=function(){var Q=[];this.Z.descriptionEntity&&Q.push(this.Z.descriptionEntity);this.Z.creators&&Q.push.apply(Q,g.$y(this.Z.creators));this.Z.theBiggestFan&&Q.push(this.Z.theBiggestFan);return[].concat(g.$y(new Set(Q)))};
g.h(lp8,G8);lp8.prototype.C=function(){return[]};
g.h(ap$,G8);ap$.prototype.C=function(){return[]};
g.h(ZMz,G8);ZMz.prototype.C=function(){return[]};
g.h(vMA,G8);vMA.prototype.C=function(){return[]};
g.h(QXA,G8);QXA.prototype.C=function(){return[]};
g.h(UfH,G8);UfH.prototype.C=function(){return[]};
g.h(qOA,G8);qOA.prototype.C=function(){return[]};
g.h(Hcx,G8);Hcx.prototype.C=function(){return[]};
g.h(CFH,G8);CFH.prototype.C=function(){return[]};
g.h(VW$,G8);VW$.prototype.C=function(){var Q=[];this.Z.downloadsList&&Q.push(this.Z.downloadsList);this.Z.smartDownloadsList&&Q.push(this.Z.smartDownloadsList);this.Z.recommendedDownloadsList&&Q.push(this.Z.recommendedDownloadsList);this.Z.refresh&&Q.push(this.Z.refresh);return[].concat(g.$y(new Set(Q)))};
g.h(fkJ,dn);fkJ.prototype.C=function(){var Q=[];this.Z.video&&Q.push(this.Z.video);this.Z.playlist&&Q.push(this.Z.playlist);this.Z.videoItem&&Q.push(this.Z.videoItem);this.Z.playlistItem&&Q.push(this.Z.playlistItem);return[].concat(g.$y(new Set(Q)))};
g.h(otx,G8);otx.prototype.C=function(){var Q=[];this.Z.refresh&&Q.push(this.Z.refresh);if(this.Z.downloads)for(var U=g.F(this.Z.downloads),q=U.next();!q.done;q=U.next())Q.push.apply(Q,g.$y((new fkJ(q.value)).C()));return[].concat(g.$y(new Set(Q)))};
g.h(icd,G8);icd.prototype.C=function(){var Q=[];this.Z.localImageEntities&&Q.push.apply(Q,g.$y(this.Z.localImageEntities));return[].concat(g.$y(new Set(Q)))};
g.h(Tzd,G8);Tzd.prototype.C=function(){var Q=[];this.Z.playbackData&&Q.push(this.Z.playbackData);this.Z.localImageEntities&&Q.push.apply(Q,g.$y(this.Z.localImageEntities));this.Z.videoDownloadContextEntity&&Q.push(this.Z.videoDownloadContextEntity);return[].concat(g.$y(new Set(Q)))};
g.h(YO$,G8);YO$.prototype.C=function(){return[]};
g.h(SO8,G8);SO8.prototype.C=function(){var Q=[];this.Z.fakeChildren&&Q.push.apply(Q,g.$y(this.Z.fakeChildren));return[].concat(g.$y(new Set(Q)))};
g.h(RLx,G8);RLx.prototype.C=function(){var Q=[];this.Z.video&&Q.push(this.Z.video);this.Z.playbackData&&Q.push(this.Z.playbackData);this.Z.offlineVideoPolicy&&Q.push(this.Z.offlineVideoPolicy);return[].concat(g.$y(new Set(Q)))};
g.h(Bzz,G8);Bzz.prototype.C=function(){return[]};
g.h(zLH,G8);zLH.prototype.C=function(){var Q=[];this.Z.channelOwner&&Q.push(this.Z.channelOwner);this.Z.videos&&Q.push.apply(Q,g.$y(this.Z.videos));this.Z.collaboratorChannels&&Q.push.apply(Q,g.$y(this.Z.collaboratorChannels));this.Z.downloadState&&Q.push(this.Z.downloadState);this.Z.refresh&&Q.push(this.Z.refresh);return[].concat(g.$y(new Set(Q)))};
g.h(L7z,G8);L7z.prototype.C=function(){var Q=[];this.Z.video&&Q.push(this.Z.video);this.Z.channelContributor&&Q.push(this.Z.channelContributor);return[].concat(g.$y(new Set(Q)))};
g.h(mfA,dn);mfA.prototype.C=function(){var Q=[];this.Z.localImageEntities&&Q.push.apply(Q,g.$y(this.Z.localImageEntities));this.Z.videoDownloadContextEntity&&Q.push(this.Z.videoDownloadContextEntity);return[].concat(g.$y(new Set(Q)))};
g.h(PF7,dn);PF7.prototype.C=function(){var Q=[];this.Z.recommendedVideoMetadata&&Q.push.apply(Q,g.$y((new mfA(this.Z.recommendedVideoMetadata)).C()));return[].concat(g.$y(new Set(Q)))};
g.h(wu$,dn);wu$.prototype.C=function(){var Q=[];this.Z.playbackPosition&&Q.push(this.Z.playbackPosition);return[].concat(g.$y(new Set(Q)))};
g.h(sXJ,G8);sXJ.prototype.C=function(){var Q=[];this.Z.owner&&Q.push(this.Z.owner);this.Z.downloadState&&Q.push(this.Z.downloadState);this.Z.userState&&Q.push.apply(Q,g.$y((new wu$(this.Z.userState)).C()));this.Z.additionalMetadata&&Q.push.apply(Q,g.$y((new PF7(this.Z.additionalMetadata)).C()));return[].concat(g.$y(new Set(Q)))};
g.h(K7A,G8);K7A.prototype.C=function(){var Q=[];this.Z.userChannelDetails&&Q.push(this.Z.userChannelDetails);return[].concat(g.$y(new Set(Q)))};
g.h(hLH,G8);hLH.prototype.C=function(){var Q=[];this.Z.channelOwner&&Q.push(this.Z.channelOwner);this.Z.playbackPosition&&Q.push(this.Z.playbackPosition);this.Z.localImageEntities&&Q.push.apply(Q,g.$y(this.Z.localImageEntities));this.Z.downloadStatus&&Q.push(this.Z.downloadStatus);return[].concat(g.$y(new Set(Q)))};
g.h(W73,G8);W73.prototype.C=function(){return[]};
g.h(Xuz,G8);Xuz.prototype.C=function(){return[]};
g.h(yhz,G8);yhz.prototype.C=function(){return[]};
g.h(nt8,G8);nt8.prototype.C=function(){return[]};
g.h(MWJ,G8);MWJ.prototype.C=function(){return[]};
g.h(DfA,G8);DfA.prototype.C=function(){return[]};
g.h(Jhd,G8);Jhd.prototype.C=function(){return[]};
g.h(gtz,G8);gtz.prototype.C=function(){return[]};
g.h(Oct,G8);Oct.prototype.C=function(){return[]};
g.h(F7A,G8);F7A.prototype.C=function(){return[]};
g.h(eL7,G8);eL7.prototype.C=function(){return[]};
g.h(df8,G8);df8.prototype.C=function(){return[]};
g.h(G2N,G8);G2N.prototype.C=function(){return[]};
g.h(uWd,G8);uWd.prototype.C=function(){var Q=[];this.Z.compositeSourceKeys&&Q.push.apply(Q,g.$y(this.Z.compositeSourceKeys));return[].concat(g.$y(new Set(Q)))};
g.h(rhQ,G8);rhQ.prototype.C=function(){var Q=[];this.Z.trackDownloadMetadatas&&Q.push.apply(Q,g.$y(this.Z.trackDownloadMetadatas));return[].concat(g.$y(new Set(Q)))};
g.h(Ahz,G8);
Ahz.prototype.C=function(){var Q=[];this.Z.downloadedTracks&&Q.push.apply(Q,g.$y(this.Z.downloadedTracks));this.Z.smartDownloadedTracks&&Q.push.apply(Q,g.$y(this.Z.smartDownloadedTracks));this.Z.downloadedEpisodes&&Q.push.apply(Q,g.$y(this.Z.downloadedEpisodes));this.Z.downloadedAlbumReleases&&Q.push.apply(Q,g.$y(this.Z.downloadedAlbumReleases));this.Z.smartDownloadedAlbumReleases&&Q.push.apply(Q,g.$y(this.Z.smartDownloadedAlbumReleases));this.Z.downloadedPlaylists&&Q.push.apply(Q,g.$y(this.Z.downloadedPlaylists));this.Z.smartDownloadedPlaylists&&
Q.push.apply(Q,g.$y(this.Z.smartDownloadedPlaylists));this.Z.metadataOnlyTracks&&Q.push.apply(Q,g.$y(this.Z.metadataOnlyTracks));return[].concat(g.$y(new Set(Q)))};
g.h(Etz,G8);Etz.prototype.C=function(){var Q=[];this.Z.trackDownloadMetadatas&&Q.push.apply(Q,g.$y(this.Z.trackDownloadMetadatas));return[].concat(g.$y(new Set(Q)))};
g.h(bcA,G8);bcA.prototype.C=function(){var Q=[];this.Z.playbackData&&Q.push(this.Z.playbackData);this.Z.localImageEntities&&Q.push.apply(Q,g.$y(this.Z.localImageEntities));this.Z.videoDownloadContextEntity&&Q.push(this.Z.videoDownloadContextEntity);return[].concat(g.$y(new Set(Q)))};
g.h(k2J,G8);k2J.prototype.C=function(){var Q=[];this.Z.musicLibraryStatusEntity&&Q.push(this.Z.musicLibraryStatusEntity);this.Z.primaryArtists&&Q.push.apply(Q,g.$y(this.Z.primaryArtists));this.Z.details&&Q.push(this.Z.details);this.Z.userDetails&&Q.push(this.Z.userDetails);this.Z.tracks&&Q.push.apply(Q,g.$y(this.Z.tracks));this.Z.share&&Q.push(this.Z.share);this.Z.downloadMetadata&&Q.push(this.Z.downloadMetadata);this.Z.refresh&&Q.push(this.Z.refresh);return[].concat(g.$y(new Set(Q)))};
g.h(Ik8,G8);Ik8.prototype.C=function(){var Q=[];this.Z.albumRelease&&Q.push(this.Z.albumRelease);this.Z.tracks&&Q.push.apply(Q,g.$y(this.Z.tracks));return[].concat(g.$y(new Set(Q)))};
g.h(chz,G8);chz.prototype.C=function(){var Q=[];this.Z.albumRelease&&Q.push(this.Z.albumRelease);return[].concat(g.$y(new Set(Q)))};
g.h(puz,G8);puz.prototype.C=function(){var Q=[];this.Z.details&&Q.push(this.Z.details);this.Z.userDetails&&Q.push(this.Z.userDetails);return[].concat(g.$y(new Set(Q)))};
g.h(Nzd,G8);Nzd.prototype.C=function(){var Q=[];this.Z.parentArtist&&Q.push(this.Z.parentArtist);return[].concat(g.$y(new Set(Q)))};
g.h($fz,G8);$fz.prototype.C=function(){var Q=[];this.Z.parentArtist&&Q.push(this.Z.parentArtist);return[].concat(g.$y(new Set(Q)))};
g.h(tWJ,G8);tWJ.prototype.C=function(){return[]};
g.h(xfA,G8);xfA.prototype.C=function(){return[]};
g.h(jXd,dn);jXd.prototype.C=function(){var Q=[];this.Z.creatorEntity&&Q.push(this.Z.creatorEntity);return[].concat(g.$y(new Set(Q)))};
g.h(lk8,G8);
lk8.prototype.C=function(){var Q=[];this.Z.tracks&&Q.push.apply(Q,g.$y(this.Z.tracks));this.Z.refresh&&Q.push(this.Z.refresh);this.Z.musicLibraryStatusEntity&&Q.push(this.Z.musicLibraryStatusEntity);this.Z.details&&Q.push(this.Z.details);this.Z.downloadMetadata&&Q.push(this.Z.downloadMetadata);this.Z.sideloadMetadata&&Q.push(this.Z.sideloadMetadata);this.Z.userDetails&&Q.push(this.Z.userDetails);this.Z.entryCollection&&Q.push(this.Z.entryCollection);this.Z.share&&Q.push(this.Z.share);this.Z.podcastShowAdditionalMetadata&&
Q.push.apply(Q,g.$y((new jXd(this.Z.podcastShowAdditionalMetadata)).C()));return[].concat(g.$y(new Set(Q)))};
g.h(akd,G8);akd.prototype.C=function(){return[]};
g.h(Zcd,G8);
Zcd.prototype.C=function(){var Q=[];this.Z.musicLibraryStatusEntity&&Q.push(this.Z.musicLibraryStatusEntity);this.Z.artists&&Q.push.apply(Q,g.$y(this.Z.artists));this.Z.audioModeVersion&&Q.push(this.Z.audioModeVersion);this.Z.videoModeVersion&&Q.push(this.Z.videoModeVersion);this.Z.userDetails&&Q.push(this.Z.userDetails);this.Z.details&&Q.push(this.Z.details);this.Z.albumRelease&&Q.push(this.Z.albumRelease);this.Z.share&&Q.push(this.Z.share);this.Z.libraryEdit&&Q.push(this.Z.libraryEdit);this.Z.downloadMetadata&&
Q.push(this.Z.downloadMetadata);this.Z.playbackPosition&&Q.push(this.Z.playbackPosition);this.Z.lyrics&&Q.push(this.Z.lyrics);return[].concat(g.$y(new Set(Q)))};
g.h(vtd,G8);vtd.prototype.C=function(){var Q=[];this.Z.parentTrack&&Q.push(this.Z.parentTrack);return[].concat(g.$y(new Set(Q)))};
g.h(QmQ,G8);QmQ.prototype.C=function(){var Q=[];this.Z.parentTrack&&Q.push(this.Z.parentTrack);return[].concat(g.$y(new Set(Q)))};
g.h(UK$,G8);UK$.prototype.C=function(){return[]};
g.h(qgJ,G8);qgJ.prototype.C=function(){return[]};
g.h(HTH,G8);HTH.prototype.C=function(){return[]};
g.h(CGt,G8);CGt.prototype.C=function(){return[]};
g.h(V8A,G8);V8A.prototype.C=function(){var Q=[];this.Z.transfer&&Q.push(this.Z.transfer);this.Z.adsPlaybackData&&Q.push.apply(Q,g.$y(this.Z.adsPlaybackData));this.Z.drmLicense&&Q.push(this.Z.drmLicense);this.Z.offlineVideoPolicy&&Q.push(this.Z.offlineVideoPolicy);this.Z.videoDownloadContextEntity&&Q.push(this.Z.videoDownloadContextEntity);return[].concat(g.$y(new Set(Q)))};
g.h(fMN,G8);fMN.prototype.C=function(){return[]};
g.h(oNA,G8);oNA.prototype.C=function(){var Q=[];this.Z.offlineVideoStreams&&Q.push.apply(Q,g.$y(this.Z.offlineVideoStreams));this.Z.captionTrack&&Q.push.apply(Q,g.$y(this.Z.captionTrack));return[].concat(g.$y(new Set(Q)))};
g.h(iT$,G8);iT$.prototype.C=function(){return[]};
g.h(T5z,G8);T5z.prototype.C=function(){return[]};
g.h(Ygz,G8);Ygz.prototype.C=function(){return[]};
g.h(Sg8,G8);Sg8.prototype.C=function(){return[]};
g.h(RON,G8);RON.prototype.C=function(){return[]};
g.h(B5A,G8);B5A.prototype.C=function(){return[]};
g.h(zOJ,G8);zOJ.prototype.C=function(){return[]};
g.h(Lhx,G8);Lhx.prototype.C=function(){return[]};
g.h(mKQ,G8);mKQ.prototype.C=function(){return[]};
g.h(PG$,G8);PG$.prototype.C=function(){return[]};
g.h(wsz,G8);wsz.prototype.C=function(){return[]};
g.h(sm$,G8);sm$.prototype.C=function(){return[]};
g.h(Kh8,G8);Kh8.prototype.C=function(){return[]};
g.h(hOx,G8);hOx.prototype.C=function(){return[]};
g.h(WhH,G8);WhH.prototype.C=function(){return[]};
g.h(XsA,G8);XsA.prototype.C=function(){return[]};
g.h(yPz,G8);yPz.prototype.C=function(){return[]};
g.h(nN8,G8);nN8.prototype.C=function(){return[]};
g.h(M8J,G8);M8J.prototype.C=function(){return[]};
g.h(DKz,G8);DKz.prototype.C=function(){return[]};
g.h(JPQ,G8);JPQ.prototype.C=function(){return[]};
g.h(gNd,G8);gNd.prototype.C=function(){return[]};
var JeN=["browse","music/browse","streaming_browse","unplugged/browse"],djd=["offline/playlist_sync_check"],s3x=["offline"],gud=["offline/offline_video_playback_position_sync"],FRA=["offline/get_playback_data_entity"],u2;rn.getInstance=function(){return g.A(function(Q){return Q.return(new Promise(function(U){g.vK().then(function(q){q?(rn.instance||(rn.instance=new rn(q)),U(rn.instance)):U(void 0)})}))})};
rn.prototype.get=function(Q){var U=this,q,H,C;return g.A(function(V){if(V.Z==1)return g.G(V,dKt(U.token),2);if(V.Z!=3)return q=V.C,g.G(V,q.get("prefs",Q),3);H=V.C;if(!H)return V.return();C=(0,g.nQ)();return H.expirationTimestampMs<=C?V.return():V.return(H.value)})};
rn.prototype.set=function(Q,U,q){q=q===void 0?31536E3:q;var H=this,C,V,f;return g.A(function(Y){if(Y.Z==1)return C=(0,g.nQ)(),V={key:Q,value:U,expirationTimestampMs:C+q*1E3},g.G(Y,dKt(H.token),2);f=Y.C;return g.G(Y,g.eC(f,"prefs",V),0)})};
rn.prototype.remove=function(Q){var U=this,q;return g.A(function(H){if(H.Z==1)return g.G(H,dKt(U.token),2);q=H.C;return g.G(H,q.delete("prefs",Q),0)})};
g.h(AG,g.Kf);g.h(EX,EN$);EX.prototype.T=function(Q,U){U=kV7(U);Q=(new TextEncoder).encode(JSON.stringify(Q));return this.Z.encrypt(Q,U)};
EX.prototype.C=function(Q,U){if(!(Q instanceof Uint8Array))throw GVA(1);var q=new TextDecoder;U=kV7(U);Q=this.Z.decrypt(Q,U);return JSON.parse(q.decode(Q))};
var IM8={accountLinkStatusEntity:ZMz,booleanEntity:cYA,buttonEntity:WhH,captionTrack:UK$,channelHandle:bMd,chipEntity:zOJ,commerceAcquisitionClientPayloadEntity:yPz,commerceCartListEntity:nN8,compositeSourceEntity:G2N,multiviewStagingEntity:uWd,contextNoteFeedEntityPayload:kLd,contextNoteUserRatingEntityPayload:Ipd,continuationTokenEntity:Bzz,downloadQualityPickerEntity:qOA,downloadsPageRefreshTokenEntity:CFH,downloadsPageViewConfigurationEntity:W73,downloadStatusEntity:Hcx,dismissState:Lhx,sfvAudioItemCurrentlyPlayingEntity:Sg8,
emojiFountainDataEntity:Kh8,emojiCustomizationSetEntity:sm$,fakeChannel:NTx,fakePlaylist:$GN,fakePlaylistEntryCollection:xGz,fakeVideo:jRH,fakeVideoDescription:lp8,featuredProductsEntity:F7A,flowStateEntity:ap$,iconBadgeEntity:M8J,interstitialInteractionStateEntity:QXA,likeButtonAnimationEntity:Xuz,liveChatPollStateEntity:UfH,dataFreshnessEntity:wsz,liveViewerLeaderboardChatEntryPointStateEntity:T5z,liveViewerLeaderboardPointsEntity:Ygz,liveReactionsDataEntity:hOx,logoEntity:vMA,macroMarkerEntity:yhz,
mainDownloadsLibraryEntity:VW$,mainDownloadsListEntity:otx,mainPlaylistDownloadStateEntity:icd,mainPlaylistEntity:zLH,mainPlaylistVideoEntity:L7z,mainVideoDownloadStateEntity:Tzd,mainVideoEntity:sXJ,markersEngagementPanelSyncEntity:nt8,markersVisibilityOverrideEntity:MWJ,musicAlbumReleaseDetail:Ik8,musicAlbumReleaseDownloadMetadataEntity:rhQ,musicAlbumRelease:k2J,musicAlbumReleaseUserDetail:chz,musicArtistDetail:Nzd,musicArtist:puz,musicArtistUserDetail:$fz,musicDownloadsLibraryEntity:Ahz,musicLibraryEdit:tWJ,
musicLibraryStatusEntity:xfA,musicPlaylist:lk8,musicPlaylistDownloadMetadataEntity:Etz,musicShare:akd,musicTrackDetail:vtd,musicTrackDownloadMetadataEntity:bcA,musicTrack:Zcd,musicTrackUserDetail:QmQ,offlineOrchestrationActionWrapperEntity:qgJ,offlineVideoPolicy:HTH,offlineVideoStreams:CGt,offlineabilityEntity:YO$,orchestrationWebSamplingEntity:SO8,pageHeaderEntity:mKQ,pdpStateEntity:DKz,pinnedProductEntity:eL7,playbackData:V8A,playerStateEntity:DfA,quantityIncrementerEntity:JPQ,refresh:fMN,saveToPlaylistListEntity:RON,
selectedChipIndexEntityPayload:Jhd,settingEntity:B5A,stringEntity:p1A,suggestedFeedbackChipStateEntity:gtz,transfer:oNA,trendingOfferEntity:df8,videoDownloadContextEntity:iT$,videoOverviewAsyncDataEntity:gNd,videoPlaybackPositionEntity:XsA,votingEntity:PG$,ytMainChannelEntity:K7A,youchatPendingResponseEntity:Oct,ytMainDownloadedVideoEntity:RLx,ytMainVideoEntity:hLH};g.h(Nr,EN$);Nr.prototype.T=function(Q){return Q};
Nr.prototype.C=function(Q){if(Q instanceof Uint8Array)throw GVA(0);return Q};
g.h($G,g.b);$G.prototype.observe=function(Q){var U=this;this.observers.push(Q);return function(){var q=U.observers.indexOf(Q);q>=0&&U.observers.splice(q,1)}};
$G.prototype.C=function(Q){qi$(this,Q.data)};
$G.prototype.Cv=function(){this.channel.close()};
var ojJ,VRz=new g.e9("elementsCommand");var Wj=new g.e9("entityBatchUpdate");var tS8=new g.e9("downloadStatusEntity");var ii$=new g.e9("mainPlaylistEntityActionMetadata");var x7=new g.e9("mainVideoEntityActionMetadata");var wN8=new g.e9("musicPlaylistEntityActionMetadata");var cBA=new g.e9("musicTrackEntityActionMetadata");var XLA=new g.e9("localImageEntityActionMetadata");var dX=new g.e9("playbackDataActionMetadata");var VkJ=new g.e9("transferEntityActionMetadata");var NyN=new g.e9("videoPlaybackPositionEntityActionMetadata");var WWd;new g.Rx;new g.Rx;D53.prototype.request=function(Q,U,q){U=U===void 0?{}:U;return this.locks.request(Q,U,function(H){return q(H)})};var Q8=g.hz.caches,v8,eRH;Z0.prototype.open=function(Q){return Q8.open(OZz(Q))};
Z0.prototype.has=function(Q){return Q8.has(OZz(Q))};
Z0.prototype.delete=function(Q){return Q8.delete(OZz(Q))};
Z0.prototype.match=function(Q,U){var q=this,H,C,V,f,Y,S;return g.A(function(R){switch(R.Z){case 1:return g.G(R,q.keys(),2);case 2:H=R.C,C=g.F(H),V=C.next();case 3:if(V.done){R.gL(5);break}f=V.value;return g.G(R,q.open(f),6);case 6:return Y=R.C,g.G(R,Y.match(Q,U),7);case 7:if(S=R.C)return R.return(S);V=C.next();R.gL(3);break;case 5:return R.return()}})};
g.h(gjN,Z0);gjN.prototype.keys=function(){var Q,U,q,H,C,V,f,Y,S;return g.A(function(R){if(R.Z==1)return Q=[],U=g.j_("CacheStorage keys"),g.G(R,Q8.keys(),2);q=R.C;H=g.F(q);for(C=H.next();!C.done;C=H.next()){V=C.value;var B=V.indexOf(":");f=B===-1?{ze:V}:{ze:V.substring(0,B),datasyncId:V.substring(B+1)};Y=f.ze;S=f.datasyncId;S===U&&Q.push(Y)}return R.return(Q)})};g.h(qk,g.b);qk.prototype.T=function(Q){this.api.l2("onOfflineOperationFailure",Q.data)};
qk.prototype.X=function(Q){this.api.publish("offlinetransferpause",Q.data)};
qk.prototype.Cv=function(){var Q;(Q=this.Z)==null||Q.close();var U;(U=this.C)==null||U.close()};uCA.prototype.gH=function(){this.Z&&Cm(this)};
uCA.prototype.yf=function(){this.C&&this.C.resolve();this.T=this.Z=!1;this.u2()};var hot=["OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"];var q3H="captionTrack downloadStatusEntity ytMainChannelEntity mainPlaylistEntity mainPlaylistDownloadStateEntity mainPlaylistVideoEntity mainVideoEntity mainVideoDownloadStateEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity videoPlaybackPositionEntity".split(" ");var Byz="downloadStatusEntity musicAlbumRelease musicDownloadsLibraryEntity musicPlaylist musicTrack musicTrackDownloadMetadataEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity".split(" ");g.h(uVd,O$);uVd.prototype.C=function(Q){return Tw(Q)?Eux(this,Q):Y7(Q)?IWN(this,Q):Promise.reject(Error("Unsupported action type: "+Q.actionType))};g.h(cet,O$);cet.prototype.C=function(Q){return Y7(Q)?pNx(this,Q):$5d(Q)?$jH(this,Q):Sw(Q)?tRt(this,Q):Promise.reject(Error("Unsupported action type: "+Q.actionType))};g.w=xjz.prototype;g.w.o$p=function(Q){var U=this,q,H,C,V;return g.A(function(f){if(!g.t(Q.state,128))return f.gL(0);q=Q.state.vT;var Y=(H=q)==null?void 0:H.errorCode,S=(C=q)==null?void 0:C.rl;V=Y==="net.connect"&&S===1?"TRANSFER_FAILURE_REASON_NETWORK_LOST":(Y==null?0:Y.startsWith("net."))?"TRANSFER_FAILURE_REASON_NETWORK":"TRANSFER_FAILURE_REASON_INTERNAL";return g.G(f,U.Xw(U.player.getVideoData().videoId,V),0)})};
g.w.Xw=function(Q,U){var q=this;return g.A(function(H){if(H.Z==1){if(q.C)return H.return();q.C=!0;return U==="TRANSFER_FAILURE_REASON_NETWORK_LOST"?(rX(q,Q,!1,!0),H.gL(0)):g.G(H,ut(q,Q),3)}g.p8(Q,4);return g.G(H,q.Z.Xw(U),0)})};
g.w.mz=function(Q){Q.status===2?(Q.status!==this.T&&(cZA(this.Z),g.p8(Q.videoId,2)),Q.L8&&x_d(this.Z,Q.videoId,Q.L8)):Q.status===4?(ut(this,Q.videoId),this.Xw(Q.videoId,Q.gy?"TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":"TRANSFER_FAILURE_REASON_INTERNAL")):Q.status===1&&tkN(this.Z);this.T=Q.status;this.api.l2("localmediachange",{videoId:Q.videoId,status:Q.status})};
g.w.Jm=function(){var Q=this,U;return g.A(function(q){if(q.Z==1){if(Q.C)return q.return();Q.C=!0;U=Q.player.getVideoData().videoId;return g.G(q,ut(Q,U),2)}return g.G(q,Q.Z.Jm(),0)})};
g.w.DA=function(Q){switch(Q){case "HD_1080":return"hd1080";case "HD":return"hd720";case "SD":return"large";case "LD":return"tiny";default:return"hd720"}};
g.w.j=function(Q){return this.api.Y().j(Q)};g.h(QBd,O$);QBd.prototype.C=function(Q){return Tw(Q)?qc3(this,Q):Y7(Q)?H1d(this,Q):$5d(Q)?Cv$(this,Q):Promise.reject(Error("Unsupported action type: "+Q.actionType))};YcN.prototype.Z=function(Q,U){var q=Q.action.actionMetadata.priority-U.action.actionMetadata.priority;q===0&&(Q.Z<U.Z?q=-1:Q.Z>U.Z&&(q=1));return q};g.h(AT,g.b);AT.prototype.Cv=function(){this.u2&&this.u2();g.b.prototype.Cv.call(this)};
AT.prototype.createAction=function(Q,U){var q=g.cw(Q.entityKey).entityType,H=g.LA(16);return new m$(q,H,Q,U.actionId,U.rootActionId)};
AT.prototype.AG=function(Q){var U=this,q,H,C,V,f,Y,S,R,B;return g.A(function(z){if(z.Z==1){if(U.GC())return z.return();H=(q=Q.offlineOrchestrationActionWrapperEntity)!=null?q:new Set;C=[];V=g.F(H);for(f=V.next();!f.done;f=V.next())Y=f.value,S=g.cw(Y),R=S.entityId,Bx3(U.Z,R)||C.push(Y);return g.G(z,yZ7(U,C),2)}B=z.C;return g.G(z,XVN(U,B),0)})};
AT.prototype.retry=function(){var Q=this;return g.A(function(U){return g.G(U,n5z(Q),0)})};D_J.prototype.bv=function(Q,U){U=U===void 0?!0:U;var q=this,H,C,V,f,Y,S,R,B;return g.A(function(z){switch(z.Z){case 1:if(!q.Z)return z.return();H=[];C=g.pn(q.Z.Z,U);V=[];for(f={kq:0};f.kq<C.length;f={kq:f.kq},f.kq++)Y=C[f.kq],S=q.Z.Ii(Y,"json3"),R=g.dR(S,{withCredentials:!0,format:"RAW"},3,500).then(function(m){return function(L){L={metadata:g.Mg(C[m.kq]),trackData:L.xhr.responseText};V.push(L)}}(f)).ev(function(m){U$("Caption fetch error",m)}),H.push(R);
return g.G(z,EMQ(H),2);case 2:return g.fx(z,3),g.G(z,LW8(Q,V),5);case 5:g.Tt(z,0);break;case 3:B=g.Y8(z),U$("Caption DB transaction error",B),g.Cx(z)}})};g.h(E$,g.b);E$.prototype.Cv=function(){this.C&&this.C();g.b.prototype.Cv.call(this)};
E$.prototype.T=function(Q){var U=this,q,H,C,V,f,Y,S,R;return g.A(function(B){H=(q=Q.transfer)!=null?q:new Set;C=[];V=g.F(H);for(f=V.next();!f.done;f=V.next())Y=f.value,S=g.cw(Y),R=S.entityId,C.push(R);return C.length===0?B.return():g.G(B,O1z(U,C),0)})};g.h(uj$,g.b);g.w=uj$.prototype;g.w.Cv=function(){this.hG&&this.hG();this.Ha.dispose();this.X.dispose();this.JG&&g.oB(this.U.n3,this.JG);this.x5&&g.oB(this.U.n3,this.x5);g.b.prototype.Cv.call(this)};
g.w.mhA=function(Q){var U=this,q,H,C;return g.A(function(V){switch(V.Z){case 1:q=g.pK(Q,"transfer");if(U.Z&&q===U.Z.key){rX(U.B,U.J,!0);U.X.stop();V.gL(0);break}return g.G(V,tG(U.C,{mode:"readwrite",zm:!0},function(f){return b2(f,q,"transfer").then(function(Y){if(Y&&Y.transferState!=="TRANSFER_STATE_COMPLETE"&&Y.transferState!=="TRANSFER_STATE_FAILED")return Y.transferState="TRANSFER_STATE_PAUSED_BY_USER",c8(f,Y,"transfer").then(function(){return Y})})}),3);
case 3:H=V.C;if(!H){V.gL(0);break}if(!Q||!U.T){V.gL(5);break}return g.G(V,Rr(Q,U.T,U.C,"DOWNLOAD_STATE_PAUSED"),5);case 5:return g.G(V,Ir(U,Q),7);case 7:C=V.C,pYH({videoId:Q,QH:H,offlineModeType:C}),g.Cx(V)}})};
g.w.T_7=function(){var Q=this;if(this.Z&&this.J){rX(this.B,this.J,!1);var U=this.Z,q=(U==null?0:U.key)?g.cw(U.key).entityId:"";q&&this.T&&(new Promise(function(H,C){Rr(q,Q.T,Q.C,"DOWNLOAD_STATE_PAUSED").catch(function(V){C(V)})})).catch(function(H){U$("Download state setting error",H)})}this.X.stop()};
g.w.jL=function(){this.Z?E53(this,this.Z):k7(this)};
g.w.My=function(Q){var U=this;return g.A(function(q){switch(q.Z){case 1:if(!U.Z){q.gL(2);break}if(U.Z.transferState==="TRANSFER_STATE_COMPLETE"||U.Z.transferState==="TRANSFER_STATE_FAILED"||!Q.transfer||!Q.transfer.has(U.Z.key)){q.gL(3);break}return g.G(q,jc(U.C,U.Z.key,"transfer"),4);case 4:U.Z=q.C;if(U.Z){q.gL(3);break}return g.G(q,b1t(U),3);case 3:if(U.Z)return q.return();case 2:return g.G(q,k7(U),0)}})};
g.w.Xw=function(Q,U){var q=this,H,C,V,f,Y;return g.A(function(S){switch(S.Z){case 1:if(!q.Z){cj(q,"onTransferFailure: "+Q);S.gL(2);break}H=q.Z;V=((C=H)==null?0:C.key)?g.cw(H.key).entityId:"";a:switch(Q){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_PLAYABILITY":case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":var R=!1;break a;default:R=!0}return R&&jBz(q)?g.G(S,pm(q,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),8):g.G(S,
lEt(q,Q),5);case 5:if(!V||!q.T){S.gL(2);break}return g.G(S,Rr(V,q.T,q.C,"DOWNLOAD_STATE_FAILED"),2);case 8:return g.G(S,Ir(q,V),9);case 9:f=S.C;fm({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_RETRY"},{videoId:V,QH:H,offlineModeType:f});if(!V||!q.T){S.gL(2);break}return g.G(S,Rr(V,q.T,q.C,"DOWNLOAD_STATE_RETRYABLE_FAILURE"),2);case 2:bt(q),Y=k7(q,!0),U&&U(Y),g.Cx(S)}})};
g.w.Jm=function(Q){var U=this,q,H,C,V,f,Y,S,R,B,z,m,L;return g.A(function(P){switch(P.Z){case 1:if(!U.Z){cj(U,"onMaybeTransferStreamsExpired");P.gL(2);break}return jBz(U)?g.G(P,pm(U,"TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"),9):g.G(P,lEt(U,"TRANSFER_FAILURE_REASON_STREAM_MISSING"),5);case 5:if(!U.T){P.gL(2);break}q=U.Z;C=((H=q)==null?0:H.key)?g.cw(q.key).entityId:"";if(!C){P.gL(2);break}return g.G(P,Rr(C,U.T,U.C,"DOWNLOAD_STATE_FAILED"),2);case 9:return U.Z||cj(U,"onMaybeTransferStreamsExpiredRetryAttempting"),
V=U.Z,Y=((f=V)==null?0:f.key)?g.cw(V.key).entityId:"",g.G(P,Ir(U,Y),10);case 10:return S=P.C,fm({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_PLAYER_RESPONSE_EXPIRATION"},{videoId:Y,QH:V,offlineModeType:S}),R=lzt(),g.rP(R,dX,{isEnqueuedForExpiredStreamUrlRefetch:!0}),B=g.pK(Y,"playbackData"),z={actionType:"OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",entityKey:B,actionMetadata:R},m=wX(new m$("playbackData",Y,z)),g.G(P,xG(U.C,m,"offlineOrchestrationActionWrapperEntity"),2);case 2:bt(U),L=k7(U,!0),
Q&&Q(L),g.Cx(P)}})};
var Qi8={},aEJ=(Qi8.TRANSFER_STATE_TRANSFERRING=1,Qi8.TRANSFER_STATE_TRANSFER_IN_QUEUE=2,Qi8);g.w=Nk.prototype;g.w.Lz=function(){return this.J.promise};
g.w.tZ=function(){if(this.C&&this.B)return this.J.promise;QxQ(this).then(this.J.resolve).catch(this.J.reject);return this.J.promise};
g.w.EL=function(Q){var U={};return U.playbackData=new uVd(Q,this.K,this.Z),U.transfer=new QBd(Q,this.K),U.videoPlaybackPositionEntity=new cet(Q,this.K),U};
g.w.kW=function(){var Q=this;return g.A(function(U){return Q.C?g.G(U,rZ7(Q.C),0):U.gL(0)})};
g.w.iL=function(){var Q=this,U,q;return g.A(function(H){if(H.Z==1)return Q.C||Q.B?g.G(H,Q.Lz(),2):H.return();Q.L!==void 0&&(g.WA(Q.L),Q.L=void 0);Q.X!==void 0&&(g.WA(Q.X),Q.X=void 0);(U=Q.C)==null||U.dispose();Q.C=void 0;(q=Q.B)==null||q.dispose();Q.B=void 0;Q.api.l2("onOrchestrationLostLeader");Q.J=new g.Rx;g.Cx(H)})};
g.w.isOrchestrationLeader=function(){return this.T.Z};
g.w.wZ=function(){return g.A(function(Q){return Q.return(!1)})};
g.w.RP=function(Q){var U=this.Z;U.api.publish("offlinetransferpause",Q);var q;(q=U.C)==null||q.postMessage(Q)};
g.w.jL=function(Q){var U,q;return g.A(function(H){if(H.Z==1)return g.G(H,af(),2);U=H.C;if(!U)return H.return();q=g.pK(Q,"transfer");return g.G(H,tG(U,{mode:"readwrite",zm:!0},function(C){var V=b2(C,q,"transfer"),f=b2(C,g.pK(Q,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.hO.all([V,f]).then(function(Y){Y=g.F(Y);var S=Y.next().value;var R=Y.next().value;return S&&S.transferState==="TRANSFER_STATE_PAUSED_BY_USER"?(S.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE",c8(C,S,"transfer").then(function(){fm({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_USER_RESUME",
statusType:"USER_RESUMED"},{videoId:Q,QH:S,offlineModeType:R==null?void 0:R.offlineModeType});return g.hO.resolve(null)})):g.hO.resolve(null)})}),0)})};
g.w.oZ=function(Q){Q=Q===void 0?43200:Q;var U=this,q,H,C,V,f,Y,S,R;return g.A(function(B){if(B.Z==1)return U.U.dj()?g.G(B,af(),2):B.return(UXH());if(B.Z!=3){q=B.C;if(!q)return B.return([]);H=Date.now()/1E3;return g.G(B,l2(q,"offlineVideoPolicy"),3)}C=B.C;V=[];f=g.F(C);for(Y=f.next();!Y.done;Y=f.next())S=Y.value,Number(S.lastUpdatedTimestampSeconds)+Q<=H&&(R=g.cw(S.key).entityId,V.push(R));return V.length?B.return($7(U,V,U.u2,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH")):B.return([])})};
g.w.deleteAll=function(){return $7(this,["!*$_ALL_ENTITIES_!*$"],this.u2,"OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",{offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}})};
g.w.refreshAllStaleEntities=function(Q){var U=this;return g.A(function(q){return q.Z==1?g.G(q,U.oZ(Q),2):q.return(q.C)})};
g.w.setUpPositionSyncInterval=function(Q){var U=this;this.X!==void 0&&(g.WA(this.X),this.X=void 0);var q=Q!=null?Q:864E5;this.X=g.Kb(function(){U.sO(q)},q)};
g.w.sO=function(Q){var U=this,q,H,C,V,f,Y;return g.A(function(S){switch(S.Z){case 1:return g.fx(S,2),g.G(S,rn.getInstance(),4);case 4:q=S.C;if(!q)throw Error("prefStorage is undefined");return g.G(S,q.get("psi"),5);case 5:H=S.C;V=((C=H)==null?0:C.G1)?Number(H.G1)/1E3:0;f=Date.now();if(!(V+Q<=f)){S.gL(6);break}return g.G(S,$7(U,["!*$_ALL_ENTITIES_!*$"],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"),6);case 6:g.Tt(S,0);break;case 2:Y=g.Y8(S),U$("Offline manager error",Y),
g.Cx(S)}})};
g.w.wz=function(){var Q=this,U,q,H,C,V,f,Y;return g.A(function(S){if(S.Z==1)return g.G(S,af(),2);if(S.Z!=3)return(U=S.C)?g.G(S,l2(U,"transfer"),3):S.return([]);q=S.C;H=[];C=g.F(q);for(V=C.next();!V.done;V=C.next())f=V.value,f.transferState==="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"&&f.key&&(Y=g.cw(f.key).entityId,H.push(Y));return S.return(HiJ(Q,H))})};
g.w.v6=function(){return g.A(function(Q){return Q.return([])})};
g.w.gY=function(){return g.A(function(Q){g.Cx(Q)})};
g.w.GK=function(){return g.A(function(Q){g.Cx(Q)})};g.h(Cq7,O$);Cq7.prototype.C=function(Q){return Tw(Q)?oO$(this,Q):Y7(Q)?T03(this,Q):Sw(Q)?YlJ(this,Q):Promise.reject(Error("Unsupported action type: "+Q.actionType))};
var tT=[10];g.h(LXd,O$);LXd.prototype.C=function(Q){return Tw(Q)?wL3(this,Q):Y7(Q)?sxd(this,Q):Sw(Q)?KXH(this,Q):Promise.reject(Error("Unsupported action type: "+Q.actionType))};
var Pq7=[10];g.h(WX7,O$);WX7.prototype.C=function(Q){return Y7(Q)?yBz(this,Q):Promise.reject(Error("Unsupported action type: "+Q.actionType))};g.h(nOQ,Nk);g.w=nOQ.prototype;g.w.EL=function(Q){var U=Nk.prototype.EL.call(this,Q);U.mainVideoEntity=new LXd(Q,this.K,this.Z);U.mainPlaylistEntity=new Cq7(Q,this.K,this.Z);U.mainDownloadsListEntity=new WX7(Q,this.K,this.Z);return U};
g.w.refreshAllStaleEntities=function(Q,U){var q=this,H,C,V,f,Y,S,R,B,z,m,L;return g.A(function(P){switch(P.Z){case 1:H=[];if(!q.K.j("web_player_offline_playlist_auto_refresh")){P.gL(2);break}return g.G(P,MGA(q,Q,U),3);case 3:H=P.C;case 2:return g.G(P,rn.getInstance(),4);case 4:return C=P.C,g.G(P,(V=C)==null?void 0:V.get("sdois"),5);case 5:return f=P.C,g.G(P,(Y=C)==null?void 0:Y.get("lmqf"),6);case 6:S=P.C;if(!f){P.gL(7);break}B=H;z=B.concat;return g.G(P,DX8(q,f,(R=S)!=null?R:"SD",Q===0),8);case 8:H=
z.call(B,P.C);case 7:return m=H,L=m.concat,g.G(P,Nk.prototype.refreshAllStaleEntities.call(q,Q,U),9);case 9:return H=L.call(m,P.C),P.return(H)}})};
g.w.wZ=function(Q){var U,q,H,C,V,f,Y,S;return g.A(function(R){if(R.Z==1)return g.G(R,af(),2);if(R.Z!=3)return(U=R.C)?g.G(R,jc(U,g.e4,"mainDownloadsListEntity"),3):R.return(!1);q=R.C;if((H=q)==null?0:(C=H.downloads)==null?0:C.length)for(V=g.pK(Q,"mainVideoEntity"),f=g.F(q.downloads),Y=f.next();!Y.done;Y=f.next())if(S=Y.value,S.videoItem===V)return R.return(!0);return R.return(!1)})};
g.w.v6=function(){var Q=this,U,q,H,C,V,f,Y,S;return g.A(function(R){if(R.Z==1)return g.G(R,af(),2);if(R.Z!=3)return(U=R.C)?g.G(R,l2(U,"downloadStatusEntity"),3):R.return([]);q=R.C;H=[];C=g.F(q);for(V=C.next();!V.done;V=C.next())f=V.value,f.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&f.key&&(Y=g.cw(f.key).entityId,H.push(Y));return H.length?(S={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}},R.return($7(Q,H,"mainVideoEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
S))):R.return([])})};
g.w.GK=function(){var Q;return g.A(function(U){return U.Z==1?g.G(U,af(),2):(Q=U.C)?g.G(U,tG(Q,{mode:"readwrite",zm:!0},function(q){return kG(q,"mainVideoEntity").then(function(H){var C=[];H=g.F(H);for(var V=H.next();!V.done;V=H.next()){V=V.value;var f=void 0;(f=V.userState)!=null&&f.playbackPosition||(f=g.cw(V.key).entityId,f={key:g.pK(f,"videoPlaybackPositionEntity"),videoId:f,lastPlaybackPositionSeconds:"0"},C.push(c8(q,f,"videoPlaybackPositionEntity")),V.userState={playbackPosition:f.key},C.push(c8(q,
V,"mainVideoEntity")))}return g.hO.all(C)})}),0):U.return()})};
g.w.gY=function(){var Q,U,q,H,C,V,f,Y,S,R,B,z,m,L,P,W,y,e,O,d,u,c,k,v,qH,Ho,ff,Bo,Cf,Wo,vo,i$,ky,ab,rK,l$,e3,J;return g.A(function(Qa){if(Qa.Z==1)return g.G(Qa,af(),2);if(Qa.Z!=3){Q=Qa.C;if(!Q)return Qa.return();U=g.pK("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity");return g.G(Qa,tG(Q,{mode:"readonly",zm:!0},function(cH){return g.hO.all([b2(cH,U,"mainDownloadsListEntity"),b2(cH,g.e4,"mainDownloadsListEntity"),kG(cH,"mainVideoEntity"),kG(cH,"mainPlaylistEntity")])}),3)}q=Qa.C;
H=g.F(q);C=H.next().value;V=H.next().value;f=H.next().value;Y=H.next().value;S=C;R=V;B=f;z=Y;m=new Set;if((L=S)==null?0:(P=L.downloads)==null?0:P.length)for(W=g.F(S.downloads),y=W.next();!y.done;y=W.next())e=y.value,O=void 0,(d=(O=e.videoItem)!=null?O:e.playlistItem)&&m.add(d);if((u=R)==null?0:(c=u.downloads)==null?0:c.length)for(k=g.F(R.downloads),v=k.next();!v.done;v=k.next())qH=v.value,qH.videoItem&&m.add(qH.videoItem);Ho=new Set;ff=[];Bo=g.F(z);for(Cf=Bo.next();!Cf.done;Cf=Bo.next()){Wo=Cf.value;
if(Wo.videos)for(vo=g.F(Wo.videos),i$=vo.next();!i$.done;i$=vo.next())ky=i$.value,(ab=JSON.parse(g.cw(ky).entityId).videoId)&&Ho.add(ab);Wo.key&&!m.has(Wo.key)&&ff.push(Wo.key)}rK=g.F(B);for(l$=rK.next();!l$.done;l$=rK.next())e3=l$.value,e3.key&&!m.has(e3.key)&&(J=g.cw(e3.key).entityId,Ho.has(J)||ff.push(e3.key));return ff.length?g.G(Qa,TyJ(Q,ff),0):Qa.gL(0)})};g.h(JBx,O$);JBx.prototype.C=function(Q){return Tw(Q)?Oi$(this,Q):Y7(Q)?FX8(this,Q):Sw(Q)?ehA(this,Q):Promise.reject(Error("Unsupported action type: "+Q.actionType))};
var jw=[10];g.h(GId,O$);GId.prototype.C=function(Q){return Tw(Q)?rBd(this,Q):Y7(Q)?ABt(this,Q):Sw(Q)?EO7(this,Q):Promise.reject(Error("Unsupported action type: "+Q.actionType))};
var lt=[10];g.h(I98,O$);I98.prototype.C=function(Q){return Tw(Q)?$XN(this,Q):Y7(Q)?tGx(this,Q):Sw(Q)?xXd(this,Q):Promise.reject(Error("Unsupported action type: "+Q.actionType))};
var N0A=[10];g.h(ar,Nk);ar.prototype.EL=function(Q){var U=Nk.prototype.EL.call(this,Q);U.musicTrack=new I98(Q,this.Z);U.musicPlaylist=new GId(Q,this.Z);U.musicAlbumRelease=new JBx(Q,this.Z);return U};
ar.prototype.refreshAllStaleEntities=function(Q,U){var q=this,H,C,V;return g.A(function(f){if(f.Z==1)return g.G(f,l9A(q,Q,U),2);if(f.Z!=3)return C=H=f.C,V=C.concat,g.G(f,Nk.prototype.refreshAllStaleEntities.call(q,Q,U),3);H=V.call(C,f.C);return f.return(H)})};g.h(a9d,g.Yr);g.w=a9d.prototype;g.w.create=function(){var Q=this;g.I(this,this.events);if(g.f8(this.K))this.Z=new nOQ(this.K,this.player);else if(g.r9(this.K)||g.ij(this.K))this.Z=new ar(this.K,this.player);this.events.V(this.player,"onPlaybackStartExternal",function(){Q.Uz()});
this.events.V(this.player,"videodatachange",function(){Q.Uz()});
this.K.j("html5_offline_playback_position_sync")&&this.events.V(this.player,"presentingplayerstatechange",this.JT)};
g.w.h7=function(){return!1};
g.w.Rw=function(Q,U,q,H){var C=this;return g.A(function(V){return C.Z?V.return($7(C.Z,Q,U,q,H)):V.return(Promise.reject())})};
g.w.deleteAll=function(){return this.Z.deleteAll()};
g.w.oZ=function(Q){return this.Z.oZ(Q)};
g.w.refreshAllStaleEntities=function(Q){return this.Z.refreshAllStaleEntities(Q)};
g.w.setUpPositionSyncInterval=function(Q){this.Z.setUpPositionSyncInterval(Q)};
g.w.RP=function(Q){this.Z.RP(Q)};
g.w.jL=function(Q){return this.Z.jL(Q)};
g.w.Uz=function(){var Q=this,U;return g.A(function(q){U=Q.player.getVideoData();return g.Cl(U)?Zi$(U)&&Q.C!==U.clientPlaybackNonce?g.G(q,vO8(Q,U),0):q.gL(0):q.return()})};
g.w.JT=function(Q){var U=this,q,H,C,V,f,Y,S;return g.A(function(R){if(R.Z==1)return q=U.player.getVideoData(),H=q.xH,g.BZ(Q,2)||g.BZ(Q,512)?g.G(R,af(),2):R.return();if(R.Z!=3){C=R.C;if(!C)return U$("PES is undefined"),R.return();V=q.videoId;return g.G(R,jc(C,g.pK(V,"mainVideoEntity"),"mainVideoEntity"),3)}f=R.C;if(!f)return R.return();Y=Math.floor(H).toString();S={videoPlaybackPositionEntityActionMetadata:{lastPlaybackPositionSeconds:Y}};return g.G(R,U.Rw([V],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE",
S),0)})};
g.w.isOrchestrationLeader=function(){return this.Z.isOrchestrationLeader()};
g.w.updateDownloadState=function(Q,U){var q,H,C,V;return g.A(function(f){if(f.Z==1)return g.G(f,af(),2);q=f.C;if(!q)return U$("PES is undefined"),f.return();H=g.cw(Q);C=H.entityType;V=H.entityId;return g.G(f,Rr(V,C,q,U,!0),0)})};g.TD("offline",a9d);})(_yt_player);
